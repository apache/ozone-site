<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-core-concepts/architecture/recon" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Recon | Apache Ozone</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="robots" content="noindex, nofollow"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://ozone-site-v2.staged.apache.org/img/social-card.png"><meta data-rh="true" name="twitter:image" content="https://ozone-site-v2.staged.apache.org/img/social-card.png"><meta data-rh="true" property="og:url" content="https://ozone-site-v2.staged.apache.org/docs/core-concepts/architecture/recon"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Recon | Apache Ozone"><meta data-rh="true" name="description" content="Recon serves as a management and monitoring console for Ozone. It gives a bird&#x27;s-eye view of Ozone and helps users troubleshoot any issues by presenting the current state of the cluster through REST based APIs and rich web UI."><meta data-rh="true" property="og:description" content="Recon serves as a management and monitoring console for Ozone. It gives a bird&#x27;s-eye view of Ozone and helps users troubleshoot any issues by presenting the current state of the cluster through REST based APIs and rich web UI."><link data-rh="true" rel="canonical" href="https://ozone-site-v2.staged.apache.org/docs/core-concepts/architecture/recon"><link data-rh="true" rel="alternate" href="https://ozone-site-v2.staged.apache.org/docs/core-concepts/architecture/recon" hreflang="en"><link data-rh="true" rel="alternate" href="https://ozone-site-v2.staged.apache.org/docs/core-concepts/architecture/recon" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://PLACEHOLDER-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Apache Ozone RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Apache Ozone Atom Feed">




<link rel="search" type="application/opensearchdescription+xml" title="Apache Ozone" href="/opensearch.xml">
<link rel="manifest" href="/pwa/manifest.json">

<link rel="icon" href="favicon.ico" sizes="32x32">
<link rel="icon" href="favicon.svg" type="image/svg+xml">
<link rel="apple-touch-icon" href="apple-touch-icon.png">
<script src="/script/matomo.js"></script><link rel="stylesheet" href="/assets/css/styles.27c88cdc.css">
<script src="/assets/js/runtime~main.93f890d1.js" defer="defer"></script>
<script src="/assets/js/main.04e77e7d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_wi3M" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/ozone-logo.svg" alt="Ozone Logo" class="themedComponent_Ka_G themedComponent--light_hIiB"><img src="/img/ozone-logo.svg" alt="Ozone Logo" class="themedComponent_Ka_G themedComponent--dark_GbLg"></div><b class="navbar__title text--truncate">Apache Ozone</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">Docs</a><a class="navbar__item navbar__link" href="/download">Download</a><a class="navbar__item navbar__link" href="/roadmap">Roadmap</a><a class="navbar__item navbar__link" href="/faq">FAQ</a><a class="navbar__item navbar__link" href="/blog">Blog</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Community</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/community/communication-channels">Communication Channels</a></li><li><a class="dropdown__link" href="/community/who-uses-ozone">Who Uses Ozone?</a></li><li><a class="dropdown__link" href="/community/report-an-issue">Report An Issue</a></li><li><a class="dropdown__link" href="/community/ask-a-question">Ask a Question</a></li><li><a class="dropdown__link" href="/community/how-to-contribute">How to Contribute</a></li><li><a class="dropdown__link" href="/community/events-and-media">Events and Media</a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_NU7Q"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/docs/core-concepts/architecture/recon" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li></ul></div><a href="https://github.com/apache/ozone" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub Repo"></a><div class="toggle_F0tt colorModeToggle_Cksm"><button class="clean-btn toggleButton_tFD4 toggleButtonDisabled_UmGx" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_gzz6"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_HsWo"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_SQAi"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_HMzJ"><div class="docsWrapper_TA0s"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton__Euq" type="button"></button><div class="docRoot_VN1Z"><aside class="theme-doc-sidebar-container docSidebarContainer_jdpB"><div class="sidebarViewport_pKkV"><div class="scrollCustom_InGK"><div class="customSidebarVersion_kZiw"><div class="customSidebarInner_rBmt"><span style="display:inline-block">Version:</span> <a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/core-concepts/architecture/recon">Next</a></div></div><div id="sidebarCssSelector_uq97"><div class="sidebar_W81o"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_KB1A"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/quick-start/">Quick Start</a><button aria-label="Expand sidebar category &#x27;Quick Start&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/core-concepts/">Core Concepts</a><button aria-label="Collapse sidebar category &#x27;Core Concepts&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/core-concepts/architecture/">Architecture</a><button aria-label="Collapse sidebar category &#x27;Architecture&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/architecture/overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/architecture/ozone-manager">Ozone Manager</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/architecture/storage-container-manager">Storage Container Manager</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/architecture/s3-gateway">Ozone S3 Gateway</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/architecture/datanodes">Datanodes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/core-concepts/architecture/recon">Recon</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/core-concepts/replication/">Replication</a><button aria-label="Expand sidebar category &#x27;Replication&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/core-concepts/namespace/">Namespace</a><button aria-label="Expand sidebar category &#x27;Namespace&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/core-concepts/security/">Security</a><button aria-label="Expand sidebar category &#x27;Security&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/core-concepts/high-availability/">High Availability</a><button aria-label="Expand sidebar category &#x27;High Availability&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/comparison">Comparison with Other Storage Technologies</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/user-guide/">User Guide</a><button aria-label="Expand sidebar category &#x27;User Guide&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/administrator-guide/">Administrator Guide</a><button aria-label="Expand sidebar category &#x27;Administrator Guide&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/troubleshooting/">Troubleshooting</a><button aria-label="Expand sidebar category &#x27;Troubleshooting&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/system-internals/">System Internals</a><button aria-label="Expand sidebar category &#x27;System Internals&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/developer-guide/">Developer Guide</a><button aria-label="Expand sidebar category &#x27;Developer Guide&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></div></div></aside><main class="docMainContainer_YnIx"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_oKcN"><div class="docItemContainer_EnqJ"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_JwNh" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_gcoS"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/core-concepts/"><span itemprop="name">Core Concepts</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/core-concepts/architecture/"><span itemprop="name">Architecture</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Recon</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_my_n theme-doc-toc-mobile tocMobile_mwTw"><button type="button" class="clean-btn tocCollapsibleButton_v3oV">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Recon</h1></header>
<p>Recon serves as a management and monitoring console for Ozone. It gives a bird&#x27;s-eye view of Ozone and helps users troubleshoot any issues by presenting the current state of the cluster through REST based APIs and rich web UI.</p>
<h2 class="anchor anchorWithStickyNavbar_e_9H" id="high-level-design">High Level Design<a href="#high-level-design" class="hash-link" aria-label="Direct link to High Level Design" title="Direct link to High Level Design">​</a></h2>
<p><img decoding="async" loading="lazy" alt="Recon High Level Design" src="/assets/images/ReconHighLevelDesign-2616251c073fa1d9c9e8ec7d07c9da5b.png" width="1930" height="1018" class="img_zmyy"></p>
<p>On a high level, Recon collects and aggregates metadata from Ozone Manager (OM), Storage Container Manager (SCM) and Datanodes (DN) and acts as a central management and monitoring console. Ozone administrators can use Recon to query the current state of the system without overloading OM or SCM.</p>
<p>Recon maintains multiple databases to enable batch processing, faster querying and to persist aggregate information. It maintains a local copy of OM db and SCM db along with a SQL database for persisting aggregate information.</p>
<p>Recon also integrates with Prometheus to provide a HTTP endpoint to query Prometheus for Ozone metrics and also to display a few crucial point in time metrics in the web UI.</p>
<h2 class="anchor anchorWithStickyNavbar_e_9H" id="recon-and-ozone-manager">Recon and Ozone Manager<a href="#recon-and-ozone-manager" class="hash-link" aria-label="Direct link to Recon and Ozone Manager" title="Direct link to Recon and Ozone Manager">​</a></h2>
<p><img decoding="async" loading="lazy" alt="Recon OM Design" src="/assets/images/ReconOmDesign-0027b37ae6de87428bb247838100eb75.png" width="2131" height="958" class="img_zmyy"></p>
<p>Recon gets a full snapshot of OM rocks db initially from the leader OM&#x27;s HTTP endpoint, untars the file and initializes RocksDB for querying locally. The database is kept in sync by periodically requesting delta updates from the leader OM via RPC calls from the last applied sequence id. If for any reason, the delta updates could not be retrieved or applied to the local db, a full snapshot is requested again to keep the local db in sync with OM db. Due to this, Recon can show stale information since the local db will not always be in sync.</p>
<p>The db updates retrieved from OM is then converted into a batch of events for further processing by OM db tasks via <a href="#task-framework">Recon Task Framework</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_e_9H" id="recon-and-storage-container-manager">Recon and Storage Container Manager<a href="#recon-and-storage-container-manager" class="hash-link" aria-label="Direct link to Recon and Storage Container Manager" title="Direct link to Recon and Storage Container Manager">​</a></h2>
<p><img decoding="async" loading="lazy" alt="Recon SCM Design" src="/assets/images/ReconScmDesign-0821f5808e438bc50c2770e8ec4a3c3c.png" width="2038" height="942" class="img_zmyy"></p>
<p>Recon also acts as a passive SCM for Datanodes. When Recon is configured in the cluster, all the Datanodes register with Recon and send heartbeats, container reports, incremental container reports etc. to Recon similar to SCM. Recon uses all the information it gets from Datanodes to construct its own copy of SCM rocks db locally. Recon never sends any command to Datanodes in response and just acts as a passive SCM for faster lookup of SCM metadata.</p>
<h2 class="anchor anchorWithStickyNavbar_e_9H" id="task-framework">Task Framework<a href="#task-framework" class="hash-link" aria-label="Direct link to Task Framework" title="Direct link to Task Framework">​</a></h2>
<p>Recon has its own Task framework to enable batch processing of data obtained from OM and SCM. A task can listen to and act upon db events such as <code>PUT</code>, <code>DELETE</code>, <code>UPDATE</code>, etc. on either OM db or SCM db. Based on this, a task either implements <code>org.apache.hadoop.ozone.recon.tasks.ReconOmTask</code> or extends <code>org.apache.hadoop.ozone.recon.scm.ReconScmTask</code>.</p>
<p>An example <code>ReconOmTask</code> is <code>ContainerKeyMapperTask</code> that persists the container -&gt; key mapping in RocksDB. This is useful to understand which keys were part
of the container when the container is reported missing or is in a bad health state. Another example is FileSizeCountTask which keeps track of count of
files within a given file size range in a SQL database. These tasks have implementations for two scenarios:</p>
<ul>
<li>Full snapshot (<code>reprocess()</code>)</li>
<li>Delta updates (<code>process()</code>)</li>
</ul>
<p>When a full snapshot of OM db is obtained from the leader OM, the <code>reprocess()</code> is called on all the registered OM tasks. On subsequent delta updates, <code>process()</code> is called on these OM tasks.</p>
<p>An example <code>ReconScmTask</code> is <code>ContainerHealthTask</code> that runs in configurable intervals to scan the list of all the containers and to persist the state of unhealthy containers (<code>MISSING</code>, <code>MIS_REPLICATED</code>, <code>UNDER_REPLICATED</code>, <code>OVER_REPLICATED</code>) in a SQL table. This information is used to determine if there are any missing containers in the cluster.</p>
<h2 class="anchor anchorWithStickyNavbar_e_9H" id="recon-and-prometheus">Recon and Prometheus<a href="#recon-and-prometheus" class="hash-link" aria-label="Direct link to Recon and Prometheus" title="Direct link to Recon and Prometheus">​</a></h2>
<p>Recon can integrate with any Prometheus instance configured to collected metrics and can display useful information in Recon UI in Datanodes and Pipelines pages. Recon also exposes a proxy endpoint
(<a href="https://ozone.apache.org/docs/edge/interface/reconapi.html#metrics" target="_blank" rel="noopener noreferrer">/metrics</a>) to query Prometheus. This integration can be enabled by setting this configuration <code>ozone.recon.prometheus.http.endpoint</code> to the Prometheus endpoint like <code>ozone.recon.prometheus.http.endpoint=http://prometheus:9090</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_e_9H" id="api-reference">API Reference<a href="#api-reference" class="hash-link" aria-label="Direct link to API Reference" title="Direct link to API Reference">​</a></h2>
<p><a href="/docs/administrator-guide/operations/observability/recon/recon-rest-api">Link to complete API Reference</a></p>
<h2 class="anchor anchorWithStickyNavbar_e_9H" id="persisted-state">Persisted state<a href="#persisted-state" class="hash-link" aria-label="Direct link to Persisted state" title="Direct link to Persisted state">​</a></h2>
<ul>
<li>A local copy of <a href="/docs/core-concepts/architecture/ozone-manager#persisted-state">OM database</a></li>
<li>A local copy of <a href="/docs/core-concepts/architecture/storage-container-manager#persisted-state">SCM database</a></li>
</ul>
<p>The following data is persisted in Recon in the specified RocksDB directory:</p>
<ul>
<li><strong>ContainerKey table</strong>
<ul>
<li>Stores the mapping (container, key) -&gt; count</li>
</ul>
</li>
<li><strong>ContainerKeyCount table</strong>
<ul>
<li>Stores containerID -&gt; no. of keys count within the container</li>
</ul>
</li>
</ul>
<p>The following data is stored in the configured SQL database (<strong>default is Derby</strong>):</p>
<ul>
<li><strong>GlobalStats table</strong>
<ul>
<li>A Key -&gt; Value table to store aggregate information like total number of volumes / buckets / keys present in the cluster</li>
</ul>
</li>
<li><strong>FileCountBySize table</strong>
<ul>
<li>Keeps track of the number of files present within a file size range in the cluster</li>
</ul>
</li>
<li><strong>ReconTaskStatus table</strong>
<ul>
<li>Keeps track of the status and last run timestamp of the registered OM and SCM db tasks in the <a href="#task-framework">Recon Task Framework</a></li>
</ul>
</li>
<li><strong>ContainerHistory table</strong>
<ul>
<li>Stores ContainerReplica -&gt; Datanode mapping with last known timestamp. This is used to determine the last known Datanodes when a container is reported missing</li>
</ul>
</li>
<li><strong>UnhealthyContainers table</strong>
<ul>
<li>Keeps track of all the Unhealthy Containers (MISSING, UNDER_REPLICATED, OVER_REPLICATED, MIS_REPLICATED) in the cluster at any given time</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_e_9H" id="notable-configurations">Notable configurations<a href="#notable-configurations" class="hash-link" aria-label="Direct link to Notable configurations" title="Direct link to Notable configurations">​</a></h2>
<table><thead><tr><th>Key</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>ozone.recon.http-address</code></td><td>0.0.0.0:9888</td><td>The address and the base port where the Recon web UI will listen on.</td></tr><tr><td><code>ozone.recon.address</code></td><td>0.0.0.0:9891</td><td>RPC address of the Recon.</td></tr><tr><td><code>ozone.recon.heatmap.provider</code></td><td>none</td><td>HeatMapProvider for Recon.</td></tr><tr><td><code>ozone.recon.db.dir</code></td><td>none</td><td>Directory where the Recon Server stores its metadata.</td></tr><tr><td><code>ozone.recon.om.db.dir</code></td><td>none</td><td>Directory where the Recon Server stores its OM snapshot DB.</td></tr><tr><td><code>ozone.recon.om.snapshot.task.interval.delay</code></td><td>10m</td><td>Interval in MINUTES by Recon to request OM DB Snapshot / delta updates.</td></tr><tr><td><code>ozone.recon.task.missingcontainer.interval</code></td><td>300s</td><td>Time interval of the periodic check for Unhealthy Containers in the cluster.</td></tr><tr><td><code>ozone.recon.task.safemode.wait.threshold</code></td><td>300s</td><td>Max time for Recon to wait before it exits out of safe or warmup mode.</td></tr><tr><td><code>ozone.recon.sql.db.jooq.dialect</code></td><td>DERBY</td><td>Please refer to <a href="https://www.jooq.org/javadoc/latest/org.jooq/org/jooq/SQLDialect.html" target="_blank" rel="noopener noreferrer">SQL Dialect</a> to specify a different dialect.</td></tr><tr><td><code>ozone.recon.sql.db.jdbc.url</code></td><td><code>jdbc:derby:$&amp;#123;ozone.recon.db.dir&amp;#125;</code><br><code>/ozone_recon_derby.db</code></td><td>Recon SQL database jdbc url.</td></tr><tr><td><code>ozone.recon.sql.db.username</code></td><td>none</td><td>Recon SQL database username.</td></tr><tr><td><code>ozone.recon.sql.db.password</code></td><td>none</td><td>Recon SQL database password.</td></tr><tr><td><code>ozone.recon.sql.db.driver</code></td><td><code>org.apache.derby.jdbc.EmbeddedDriver</code></td><td>Recon SQL database jdbc driver.</td></tr><tr><td><code>ozone.recon.prometheus.http.endpoint</code></td><td>none</td><td>Prometheus HTTP endpoint URL for Recon to integrate with Prometheus. Enables display of metrics in Recon UI and exposes a proxy endpoint to query Prometheus. Example: <code>http://prometheus:9090</code>.</td></tr><tr><td><code>ozone.recon.scmconfig</code></td><td>none</td><td>Prefix for SCM configuration.</td></tr><tr><td><code>ozone.recon.db.dirs.permissions</code></td><td><code>750</code></td><td>Permissions for the metadata directories for Recon. The permissions can either be octal or symbolic. If the default permissions are not set then the default value of 750 will be used.</td></tr><tr><td><code>ozone.recon.datanode.address</code></td><td>none</td><td>Datanode address for Recon.</td></tr><tr><td><code>ozone.recon.heatmap.enable</code></td><td><code>false</code></td><td>To enable/disable Recon heatmap feature. Along with this config, user must also provide the implementation of <code>org.apache.hadoop.ozone.recon.heatmap.IHeatMapProvider</code> interface and configure in <code>ozone.recon.heatmap.provider</code> configuration.</td></tr><tr><td><code>ozone.recon.https-address</code></td><td><code>0.0.0.0:9889</code></td><td>The address and the base port where the Recon web UI will listen on using HTTPS. If the port is 0 then the server will start on a free port.</td></tr><tr><td><code>ozone.recon.datanode.bind.host</code></td><td><code>0.0.0.0</code></td><td>Bind host for Datanode address.</td></tr></tbody></table></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/apache/ozone-site/tree/HDDS-9225-website-v2/docs/03-core-concepts/01-architecture/06-recon.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_kQtw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_orCj"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/core-concepts/architecture/datanodes"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Datanodes</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/core-concepts/replication/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Replication</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_reur thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#high-level-design" class="table-of-contents__link toc-highlight">High Level Design</a></li><li><a href="#recon-and-ozone-manager" class="table-of-contents__link toc-highlight">Recon and Ozone Manager</a></li><li><a href="#recon-and-storage-container-manager" class="table-of-contents__link toc-highlight">Recon and Storage Container Manager</a></li><li><a href="#task-framework" class="table-of-contents__link toc-highlight">Task Framework</a></li><li><a href="#recon-and-prometheus" class="table-of-contents__link toc-highlight">Recon and Prometheus</a></li><li><a href="#api-reference" class="table-of-contents__link toc-highlight">API Reference</a></li><li><a href="#persisted-state" class="table-of-contents__link toc-highlight">Persisted state</a></li><li><a href="#notable-configurations" class="table-of-contents__link toc-highlight">Notable configurations</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Apache Software Foundation</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Foundation<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QWNa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="footer__link-item">License<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QWNa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.apache.org/events/current-event" target="_blank" rel="noopener noreferrer" class="footer__link-item">Events<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QWNa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Sponsorship<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QWNa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://privacy.apache.org/policies/privacy-policy-public.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QWNa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.apache.org/security/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Security<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QWNa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Thanks<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QWNa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/apache/ozone/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item"><img src="/img/social/github.svg" alt="GitHub Discussions Icon" style="width:1em;height:1em;margin-right:0.5em;vertical-align:middle">GitHub Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QWNa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://issues.apache.org/jira/projects/HDDS/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item"><img src="/img/social/jira.svg" alt="Jira Issues Icon" style="width:1em;height:1em;margin-right:0.5em;vertical-align:middle">Jira Issues<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QWNa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://infra.apache.org/slack.html" target="_blank" rel="noopener noreferrer" class="footer__link-item"><img src="/img/social/slack.svg" alt="Slack Icon" style="width:1em;height:1em;margin-right:0.5em;vertical-align:middle">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QWNa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="mailto:dev@ozone.apache.org" target="_blank" rel="noopener noreferrer" class="footer__link-item"><img src="/img/social/mail.svg" alt="Mailing List Icon" style="width:1em;height:1em;margin-right:0.5em;vertical-align:middle">Mailing List<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QWNa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/@ApacheOzone" target="_blank" rel="noopener noreferrer" class="footer__link-item"><img src="/img/social/youtube.svg" alt="YouTube Icon" style="width:1em;height:1em;margin-right:0.5em;vertical-align:middle">YouTube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QWNa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/ApacheOzone" target="_blank" rel="noopener noreferrer" class="footer__link-item"><img src="/img/social/twitter-x.svg" alt="Twitter Icon" style="width:1em;height:1em;margin-right:0.5em;vertical-align:middle">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QWNa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Repositories</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/apache/ozone" target="_blank" rel="noopener noreferrer" class="footer__link-item">Ozone</a></li><li class="footer__item"><a href="https://github.com/apache/ozone-site" target="_blank" rel="noopener noreferrer" class="footer__link-item">Website</a></li><li class="footer__item"><a href="https://github.com/apache/ozone-docker" target="_blank" rel="noopener noreferrer" class="footer__link-item">Docker Image</a></li><li class="footer__item"><a href="https://github.com/apache/ozone-docker-runner" target="_blank" rel="noopener noreferrer" class="footer__link-item">Docker Runner Image</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">
        <div>
          Copyright © 2026 <a href="https://www.apache.org/" class="copyright-link">The Apache Software Foundation</a>. Licensed under the <a href="https://www.apache.org/licenses/LICENSE-2.0" class="copyright-link">Apache License, Version 2.0</a>. <br>
          <div>
            <p>The Apache Software Foundation, Apache Ozone, Ozone, Apache, the Apache Feather, and the Apache Ozone project logo are either registered trademarks or trademarks of the Apache Software Foundation.</p>
          </div>
        </div></div></div></div></footer></div>
</body>
</html>