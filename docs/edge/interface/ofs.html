

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <meta name="description" content="Apache Ozone Documentation">

    <title>Documentation for Apache Ozone</title>

    
    <link href="../css/bootstrap.min.css" rel="stylesheet">

    
    <link href="../css/ozonedoc.css" rel="stylesheet">

    
    
    <link href="../swagger-resources/swagger-ui.css" rel="stylesheet">

    
    <script>
      var _paq = window._paq = window._paq || [];
      

       
      _paq.push(['disableCookies']);
      

      _paq.push(['trackPageView']);
      _paq.push(['enableLinkTracking']);
      (function() {
        var u="//analytics.apache.org/";
        _paq.push(['setTrackerUrl', u+'matomo.php']);
        _paq.push(['setSiteId', '34']);
        var d=document, g=d.createElement('script'),
s=d.getElementsByTagName('script')[0];
        g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
      })();
    </script>
    

  </head>


<body>

  
<nav class="navbar navbar-inverse navbar-fixed-top">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#sidebar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a href="../index.html" class="navbar-left ozone-logo">
        <img src="../ozone-logo-small.png"/>
      </a>
      <a class="navbar-brand hidden-xs" href="../index.html">
        Apache Ozone/HDDS Documentation
      </a>
      <a class="navbar-brand visible-xs-inline" href="#">Apache Ozone</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li><a href="https://github.com/apache/ozone">Source</a></li>
        <li><a href="https://ozone.apache.org">Apache Ozone</a></li>
        <li><a href="https://apache.org">ASF</a></li>
      </ul>
    </div>
  </div>
</nav>


  <div class="wrapper">
  <div class="container-fluid">
    <div class="row">
      
<div class="col-sm-2 col-md-2 sidebar" id="sidebar">
  <ul class="nav nav-sidebar">
    
    
        
            <li class="">
                
                   <a href="../index.html">
                

                    
                    <span>Overview</span>
                </a>
            </li>
        
    
        
            <li class="">
                
                   <a href="../start.html">
                

                    
                    <span>Getting Started</span>
                </a>
            </li>
        
    
        
            <li class="">
                <a href="../concept.html">
                    
                    <span>Architecture</span>
                </a>
                <ul class="nav">
                    
                        <li class="">
                           
                           <a href="../concept/overview.html">Overview</a>
                           
                        </li>
                    
                        <li class="">
                           
                               <a href="../concept/ozonemanager.html">
                                 
                                 <span>Ozone Manager</span>
                               </a>
                               <ul class="nav">
                               
                                  <li class="">
                                     <a href="../concept/volumesbucketskeys.html">Volumes, Buckets, and Keys</a>
                                  </li>
                               
                               </ul>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../concept/storagecontainermanager.html">Storage Container Manager</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../concept/containers.html">Containers</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../concept/datanodes.html">Datanodes</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../concept/ozones3gateway.html">Ozone S3 Gateway</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../concept/recon.html">Recon</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../concept/networkports.html">Network Ports</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../concept/comparison.html">Comparison with Other Storage Technologies</a>
                           
                        </li>
                    
                </ul>
            </li>
        
    
        
            <li class="">
                <a href="../feature.html">
                    
                    <span>Features</span>
                </a>
                <ul class="nav">
                    
                        <li class="">
                           
                           <a href="../feature/decommission.html">Decommissioning</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../feature/om-ha.html">OM High Availability</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../feature/erasurecoding.html">Ozone Erasure Coding</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../feature/snapshot.html">Ozone Snapshot</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../feature/scm-ha.html">SCM High Availability</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../feature/streaming-write-pipeline.html">Streaming Write Pipeline</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../feature/dn-merge-rocksdb.html">Merge Container RocksDB in DN</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../feature/prefixfso.html">Prefix based File System Optimization</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../feature/topology.html">Topology awareness</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../feature/quota.html">Quota in Ozone</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../feature/recon.html">Recon Server</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../feature/observability.html">Observability</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../feature/nonrolling-upgrade.html">Non-Rolling Upgrades and Downgrades</a>
                           
                        </li>
                    
                        <li class="">
                           
                               <a href="../feature/s3-multi-tenancy.html">
                                 
                                 <span>S3 Multi-Tenancy</span>
                               </a>
                               <ul class="nav">
                               
                                  <li class="">
                                     <a href="../feature/s3-multi-tenancy-setup.html">Setup</a>
                                  </li>
                               
                                  <li class="">
                                     <a href="../feature/s3-tenant-commands.html">Tenant commands</a>
                                  </li>
                               
                                  <li class="">
                                     <a href="../feature/s3-multi-tenancy-access-control.html">Access Control</a>
                                  </li>
                               
                               </ul>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../feature/reconfigurability.html">Reconfigurability</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../feature/multi-raft-support.html">Multi-Raft Support in Ozone</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../feature/trash.html">Trash</a>
                           
                        </li>
                    
                </ul>
            </li>
        
    
        
            <li class="">
                <a href="../integration.html">
                    
                    <span>Application Integrations</span>
                </a>
                <ul class="nav">
                    
                        <li class="">
                           
                           <a href="../integration/distcp.html">Hadoop DistCp</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../integration/hive.html">Hive</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../integration/impala.html">Impala</a>
                           
                        </li>
                    
                </ul>
            </li>
        
    
        
            <li class="">
                <a href="../interface.html">
                    
                    <span>Client Interfaces</span>
                </a>
                <ul class="nav">
                    
                        <li class="active">
                           
                           <a href="../interface/ofs.html">Ofs (Hadoop compatible)</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../interface/o3fs.html">O3fs (Hadoop compatible)</a>
                           
                        </li>
                    
                        <li class="">
                           
                               <a href="../interface/s3.html">
                                 
                                 <span>S3 Protocol</span>
                               </a>
                               <ul class="nav">
                               
                                  <li class="">
                                     <a href="../interface/cyberduckozones3.html">Accessing Ozone S3 via CyberDuck</a>
                                  </li>
                               
                               </ul>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../interface/cli.html">Command Line Interface</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../interface/reconapi.html">Recon API</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../interface/javaapi.html">Java API</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../interface/python.html">Accessing Apache Ozone from Python</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../interface/csi.html">CSI Protocol</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../interface/httpfs.html">HttpFS Gateway</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../interface/native-cpp.html">Native C/C&#43;&#43; Client Access to Ozone</a>
                           
                        </li>
                    
                </ul>
            </li>
        
    
        
            <li class="">
                <a href="../security.html">
                    
                    <span>Security</span>
                </a>
                <ul class="nav">
                    
                        <li class="">
                           
                           <a href="../security/secureozone.html">Securing Ozone</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../security/securingtde.html">Transparent Data Encryption</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../security/gdpr.html">GDPR in Ozone</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../security/securingdatanodes.html">Securing Datanodes</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../security/securingozonehttp.html">Securing HTTP</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../security/securings3.html">Securing S3</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../security/securityacls.html">Ozone ACLs</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../security/protect-in-transit-traffic.html">Protect In-Transit Traffic</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../security/securitywithranger.html">Apache Ranger</a>
                           
                        </li>
                    
                </ul>
            </li>
        
    
        
            <li class="">
                
                   <a href="../tools.html">
                

                    
                    <span>Tools</span>
                </a>
            </li>
        
    
        
            <li class="">
                
                   <a href="../recipe.html">
                

                    
                    <span>Recipes</span>
                </a>
            </li>
        
    
        
            <li class="">
                
                   <a href="../troubleshooting.html">
                

                    
                    <span>Troubleshooting</span>
                </a>
            </li>
        
    
    <li><a href="../design.html"><span><b>Design docs</b></span></a></li>
    <li class="visible-xs"><a href="#">References</a>
    <ul class="nav">
        <li><a href="https://github.com/apache/ozone"><span class="glyphicon glyphicon-new-window" aria-hidden="true"></span> Source</a></li>
        <li><a href="https://ozone.apache.org"><span class="glyphicon glyphicon-new-window" aria-hidden="true"></span> Apache Ozone</a></li>
        <li><a href="https://apache.org"><span class="glyphicon glyphicon-new-window" aria-hidden="true"></span> ASF</a></li>
    </ul></li>
  </ul>

</div>

      <div class="col-sm-10 col-sm-offset-2 col-md-10 col-md-offset-2 main-content">



        <div class="col-md-9">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                  <li class="breadcrumb-item"><a href="../index.html">Home</a></li>
                  <li class="breadcrumb-item" aria-current="page"><a href="../interface.html">Client Interfaces</a></li>
                  <li class="breadcrumb-item active" aria-current="page">Ofs (Hadoop compatible)</li>
                </ol>
              </nav>

          

<div class="pull-right">
    
    
    
    
    
    <a href="../zh/interface/ofs.html"><span class="label label-success">中文</span></a>
    
    
</div>


          <div class="col-md-9">
            <h1>Ofs (Hadoop compatible)</h1>

            <!---
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<p>The Hadoop compatible file system interface allows storage backends like Ozone
to be easily integrated into Hadoop eco-system.  Ozone file system is an
Hadoop compatible file system.</p>
<div class="alert alert-warning" role="alert">
<p>Currently, Ozone supports two scheme: <code>o3fs://</code> and <code>ofs://</code>.
The biggest difference between the <code>o3fs</code> and <code>ofs</code>，is that <code>o3fs</code> supports operations
only at a <strong>single bucket</strong>, while ofs supports operations across all volumes and buckets and
provides a full view of all the volume/buckets.</p>
</div>
<h2 id="the-basics">The Basics</h2>
<p>Examples of valid OFS paths:</p>
<pre tabindex="0"><code>ofs://om1/
ofs://om3:9862/
ofs://omservice/
ofs://omservice/volume1/
ofs://omservice/volume1/bucket1/
ofs://omservice/volume1/bucket1/dir1
ofs://omservice/volume1/bucket1/dir1/key1

ofs://omservice/tmp/
ofs://omservice/tmp/key1
</code></pre><p>Volumes and mount(s) are located at the root level of an OFS Filesystem.
Buckets are listed naturally under volumes.
Keys and directories are under each buckets.</p>
<p>Note that for mounts, only temp mount <code>/tmp</code> is supported at the moment.</p>
<h2 id="configuration">Configuration</h2>
<p>Please add the following entry to the core-site.xml.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;property&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;name&gt;</span>fs.ofs.impl<span style="color:#f92672">&lt;/name&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;value&gt;</span>org.apache.hadoop.fs.ozone.RootedOzoneFileSystem<span style="color:#f92672">&lt;/value&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;property&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;name&gt;</span>fs.defaultFS<span style="color:#f92672">&lt;/name&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;value&gt;</span>ofs://om-host.example.com/<span style="color:#f92672">&lt;/value&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/property&gt;</span></span></span></code></pre></div>
<p>This will make all the volumes and buckets to be the default Hadoop compatible file system and register the ofs file system type.</p>
<p>You also need to add the ozone-filesystem-hadoop3.jar file to the classpath:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>export HADOOP_CLASSPATH<span style="color:#f92672">=</span>/opt/ozone/share/ozone/lib/ozone-filesystem-hadoop3-*.jar:$HADOOP_CLASSPATH</span></span></code></pre></div>
<p>(Note: with Hadoop 2.x, use the <code>ozone-filesystem-hadoop2-*.jar</code>)</p>
<p>Once the default Filesystem has been setup, users can run commands like ls, put, mkdir, etc.
For example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>hdfs dfs -ls /</span></span></code></pre></div>
<p>Note that ofs works on all buckets and volumes. Users can create buckets and volumes using mkdir, such as create volume named volume1 and  bucket named bucket1:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>hdfs dfs -mkdir /volume1
</span></span><span style="display:flex;"><span>hdfs dfs -mkdir /volume1/bucket1</span></span></code></pre></div>
<p>Or use the put command to write a file to the bucket.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>hdfs dfs -put /etc/hosts /volume1/bucket1/test</span></span></code></pre></div>
<p>For more usage, see: <a href="https://issues.apache.org/jira/secure/attachment/12987636/Design%20ofs%20v1.pdf">https://issues.apache.org/jira/secure/attachment/12987636/Design%20ofs%20v1.pdf</a></p>
<h2 id="differences-from-o3fshahahugoshortcode108s5hbhb">Differences from <a href="../interface/o3fs.html">o3fs</a></h2>
<h3 id="creating-files">Creating files</h3>
<p>OFS doesn&rsquo;t allow creating keys(files) directly under root or volumes.
Users will receive an error message when they try to do that:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ ozone fs -touch /volume1/key1
</span></span><span style="display:flex;"><span>touch: Cannot create file under root or volume.
</span></span></code></pre></div><h3 id="simplify-fsdefaultfs">Simplify fs.defaultFS</h3>
<p>With OFS, fs.defaultFS (in core-site.xml) no longer needs to have a specific
volume and bucket in its path like o3fs did.
Simply put the OM host or service ID (in case of HA):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;property&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;name&gt;</span>fs.defaultFS<span style="color:#f92672">&lt;/name&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;value&gt;</span>ofs://omservice<span style="color:#f92672">&lt;/value&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/property&gt;</span>
</span></span></code></pre></div><p>The client would then be able to access every volume and bucket on the cluster
without specifying the hostname or service ID.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ ozone fs -mkdir -p /volume1/bucket1
</span></span></code></pre></div><h3 id="volume-and-bucket-management-directly-from-filesystem-shell">Volume and bucket management directly from FileSystem shell</h3>
<p>Admins can create and delete volumes and buckets easily with Hadoop FS shell.
Volumes and buckets are treated similar to directories so they will be created
if they don&rsquo;t exist with <code>-p</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ ozone fs -mkdir -p ofs://omservice/volume1/bucket1/dir1/
</span></span></code></pre></div><p>Note that the supported volume and bucket name character set rule still applies.
For instance, bucket and volume names don&rsquo;t take underscore(<code>_</code>):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ ozone fs -mkdir -p /volume_1
</span></span><span style="display:flex;"><span>mkdir: Bucket or Volume name has an unsupported character : _
</span></span></code></pre></div><h2 id="mounts-and-configuring-tmp">Mounts and Configuring /tmp</h2>
<p>In order to be compatible with legacy Hadoop applications that use /tmp/,
we have a special temp mount located at the root of the FS.
This feature may be expanded in the feature to support custom mount paths.</p>
<p>Currently Ozone supports two configurations for /tmp.  The first (default),
is a tmp directory for each user comprised of a mount volume with a
user specific temp bucket.  The second (configurable through ozone-site.xml),
a sticky-bit like tmp directory common to all users comprised of a mount
volume and a common temp bucket.</p>
<p>Important: To use it, first, an <strong>admin</strong> needs to create the volume tmp
(the volume name is hardcoded for now) and set its ACL to world ALL access.
Namely:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ ozone sh volume create tmp
</span></span><span style="display:flex;"><span>$ ozone sh volume setacl tmp -al world::a
</span></span></code></pre></div><p>These commands only need to be done <strong>once per cluster</strong>.</p>
<h3 id="for-tmp-directory-per-user-default">For /tmp directory per user (default)</h3>
<p>Then, <strong>each user</strong> needs to mkdir first to initialize their own temp bucket
once.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ ozone fs -mkdir /tmp
</span></span><span style="display:flex;"><span>2020-06-04 00:00:00,050 <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> INFO rpc.RpcClient: Creating Bucket: tmp/0238 ...
</span></span></code></pre></div><p>After that they can write to it just like they would do to a regular
directory. e.g.:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ ozone fs -touch /tmp/key1
</span></span></code></pre></div><h3 id="for-a-sharable-tmp-directory-common-to-all-users">For a sharable /tmp directory common to all users</h3>
<p>To enable the sticky-bit common /tmp directory, update the ozone-site.xml with
the following property</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;property&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;name&gt;</span>ozone.om.enable.ofs.shared.tmp.dir<span style="color:#f92672">&lt;/name&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;value&gt;</span>true<span style="color:#f92672">&lt;/value&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/property&gt;</span>
</span></span></code></pre></div><p>Then after setting up the volume tmp as <strong>admin</strong>, also configure a tmp bucket that
serves as the common /tmp directory for all users, for example,</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ ozone sh bucket create /tmp/tmp
</span></span><span style="display:flex;"><span>$ ozone sh volume setacl tmp -a user:anyuser:rwlc <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  user:adminuser:a,group:anyuser:rwlc,group:adminuser:a tmp/tmp
</span></span></code></pre></div><p>where, anyuser is username(s) admin wants to grant access and,
adminuser is the admin username.</p>
<p>Users then access the tmp directory as,</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ ozone fs -put ./NOTICE.txt ofs://om/tmp/key1
</span></span></code></pre></div><h2 id="delete-with-trash-enabled">Delete with trash enabled</h2>
<p>In order to enable trash in Ozone, Please add these configs to core-site.xml</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;property&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;name&gt;</span>fs.trash.interval<span style="color:#f92672">&lt;/name&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;value&gt;</span>10<span style="color:#f92672">&lt;/value&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;property&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;name&gt;</span>fs.trash.classname<span style="color:#f92672">&lt;/name&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;value&gt;</span>org.apache.hadoop.fs.ozone.OzoneTrashPolicy<span style="color:#f92672">&lt;/value&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/property&gt;</span></span></span></code></pre></div>
<p>When keys are deleted with trash enabled, they are moved to a trash directory
under each bucket, because keys aren&rsquo;t allowed to be moved(renamed) between
buckets in Ozone.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ ozone fs -rm /volume1/bucket1/key1
</span></span><span style="display:flex;"><span>2020-06-04 00:00:00,100 <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> INFO fs.TrashPolicyDefault: Moved: <span style="color:#e6db74">&#39;ofs://id1/volume1/bucket1/key1&#39;</span> to trash at: ofs://id1/volume1/bucket1/.Trash/hadoop/Current/volume1/bucket1/key1
</span></span></code></pre></div><p>This is very similar to how the HDFS encryption zone handles trash location.</p>
<p><strong>Note</strong></p>
<p>1.The flag <code>-skipTrash</code> can be used to delete files permanently without being moved to trash.</p>
<p>2.Deletes at bucket or volume level with trash enabled are not allowed. One must use skipTrash in such cases.
i.e <code>ozone fs -rm -R ofs://vol1/bucket1</code> or  <code>ozone fs -rm -R o3fs://bucket1.vol1</code> are not allowed without skipTrash</p>
<h2 id="recursive-listing">Recursive listing</h2>
<p>OFS supports recursive volume, bucket and key listing.</p>
<p>i.e. <code>ozone fs -ls -R ofs://omservice/</code> will recursively list all volumes,
buckets and keys the user has LIST permission to if ACL is enabled.
If ACL is disabled, the command would just list literally everything on that
cluster.</p>
<p>This feature wouldn&rsquo;t degrade server performance as the loop is on the client.
Think it as a client is issuing multiple requests to the server to get all the
information.</p>
<h2 id="operation-support">Operation Support</h2>
<p>lists the support status of Ofs operations</p>
<h3 id="supported">Supported</h3>
<table>
  <thead>
      <tr>
          <th>Operation</th>
          <th>Description</th>
          <th>Support</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>create</code></td>
          <td>Creates a new file.</td>
          <td>Supported</td>
      </tr>
      <tr>
          <td><code>open</code></td>
          <td>Opens a file for reading.</td>
          <td>Supported</td>
      </tr>
      <tr>
          <td><code>rename</code></td>
          <td>Renames a file or directory.</td>
          <td>Supported [1]</td>
      </tr>
      <tr>
          <td><code>delete</code></td>
          <td>Deletes a file or directory.</td>
          <td>Supported [2]</td>
      </tr>
      <tr>
          <td><code>listStatus</code></td>
          <td>Lists the status of files in a directory.</td>
          <td>Supported [3]</td>
      </tr>
      <tr>
          <td><code>mkdirs</code></td>
          <td>Creates a directory and its parents.</td>
          <td>Supported</td>
      </tr>
      <tr>
          <td><code>getFileStatus</code></td>
          <td>Gets the status of a file.</td>
          <td>Supported</td>
      </tr>
      <tr>
          <td><code>setTimes</code></td>
          <td>Sets the modification and access times.</td>
          <td>Supported</td>
      </tr>
      <tr>
          <td><code>getLinkTarget</code></td>
          <td>Gets the target of a symbolic link.</td>
          <td>Supported [4]</td>
      </tr>
      <tr>
          <td><code>getFileChecksum</code></td>
          <td>Gets the checksum of a file.</td>
          <td>Supported</td>
      </tr>
      <tr>
          <td><code>setSafeMode</code></td>
          <td>Enters or leaves safe mode.</td>
          <td>Supported</td>
      </tr>
      <tr>
          <td><code>recoverLease</code></td>
          <td>Recovers a file lease.</td>
          <td>Supported</td>
      </tr>
      <tr>
          <td><code>isFileClosed</code></td>
          <td>Checks if a file is closed.</td>
          <td>Supported</td>
      </tr>
      <tr>
          <td><code>createSnapshot</code></td>
          <td>Creates a snapshot.</td>
          <td>Supported [5]</td>
      </tr>
      <tr>
          <td><code>deleteSnapshot</code></td>
          <td>Deletes a snapshot.</td>
          <td>Supported [5]</td>
      </tr>
      <tr>
          <td><code>renameSnapshot</code></td>
          <td>Renames a snapshot.</td>
          <td>Supported [5]</td>
      </tr>
      <tr>
          <td><code>getSnapshotDiffReport</code></td>
          <td>Gets a snapshot diff report.</td>
          <td>Supported [5]</td>
      </tr>
      <tr>
          <td><code>copyFromLocalFile</code></td>
          <td>Copies a file from the local filesystem.</td>
          <td>Supported</td>
      </tr>
      <tr>
          <td><code>exists</code></td>
          <td>Checks if a path exists.</td>
          <td>Supported</td>
      </tr>
      <tr>
          <td><code>getContentSummary</code></td>
          <td>Gets the content summary of a path.</td>
          <td>Supported</td>
      </tr>
      <tr>
          <td><code>getDefaultBlockSize</code></td>
          <td>Gets the default block size.</td>
          <td>Supported</td>
      </tr>
      <tr>
          <td><code>getDefaultReplication</code></td>
          <td>Gets the default replication factor.</td>
          <td>Supported</td>
      </tr>
      <tr>
          <td><code>getDelegationToken</code></td>
          <td>Gets a delegation token.</td>
          <td>Supported</td>
      </tr>
      <tr>
          <td><code>getFileBlockLocations</code></td>
          <td>Gets file block locations.</td>
          <td>Supported</td>
      </tr>
      <tr>
          <td><code>getHomeDirectory</code></td>
          <td>Gets the user&rsquo;s home directory.</td>
          <td>Supported</td>
      </tr>
      <tr>
          <td><code>getServerDefaults</code></td>
          <td>Gets the server default values.</td>
          <td>Supported</td>
      </tr>
      <tr>
          <td><code>getTrashRoot</code></td>
          <td>Gets the trash root for a path.</td>
          <td>Supported</td>
      </tr>
      <tr>
          <td><code>getTrashRoots</code></td>
          <td>Gets all trash roots.</td>
          <td>Supported</td>
      </tr>
      <tr>
          <td><code>getWorkingDirectory</code></td>
          <td>Gets the current working directory.</td>
          <td>Supported</td>
      </tr>
      <tr>
          <td><code>globStatus</code></td>
          <td>Finds files matching a pattern.</td>
          <td>Supported</td>
      </tr>
      <tr>
          <td><code>hasPathCapability</code></td>
          <td>Queries for a path capability.</td>
          <td>Supported</td>
      </tr>
      <tr>
          <td><code>isDirectory</code></td>
          <td>Checks if a path is a directory.</td>
          <td>Supported</td>
      </tr>
      <tr>
          <td><code>isFile</code></td>
          <td>Checks if a path is a file.</td>
          <td>Supported</td>
      </tr>
      <tr>
          <td><code>listFiles</code></td>
          <td>Returns a remote iterator for files.</td>
          <td>Supported</td>
      </tr>
      <tr>
          <td><code>listLocatedStatus</code></td>
          <td>Returns a remote iterator for located file statuses.</td>
          <td>Supported</td>
      </tr>
      <tr>
          <td><code>listStatusIterator</code></td>
          <td>Returns a remote iterator for file statuses.</td>
          <td>Supported</td>
      </tr>
      <tr>
          <td><code>setWorkingDirectory</code></td>
          <td>Sets the current working directory.</td>
          <td>Supported</td>
      </tr>
      <tr>
          <td><code>supportsSymlinks</code></td>
          <td>Checks if symbolic links are supported.</td>
          <td>Supported</td>
      </tr>
  </tbody>
</table>
<h3 id="unsupported">Unsupported</h3>
<table>
  <thead>
      <tr>
          <th>Operation</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>append</code></td>
          <td>Appends to an existing file.</td>
      </tr>
      <tr>
          <td><code>setPermission</code></td>
          <td>Sets the permission of a file.</td>
      </tr>
      <tr>
          <td><code>setOwner</code></td>
          <td>Sets the owner of a file.</td>
      </tr>
      <tr>
          <td><code>setReplication</code></td>
          <td>Sets the replication factor of a file.</td>
      </tr>
      <tr>
          <td><code>createSymlink</code></td>
          <td>Creates a symbolic link.</td>
      </tr>
      <tr>
          <td><code>resolveLink</code></td>
          <td>Resolves a symbolic link.</td>
      </tr>
      <tr>
          <td><code>setXAttr</code></td>
          <td>Sets an extended attribute.</td>
      </tr>
      <tr>
          <td><code>getXAttr</code></td>
          <td>Gets an extended attribute.</td>
      </tr>
      <tr>
          <td><code>listXAttrs</code></td>
          <td>Lists extended attributes.</td>
      </tr>
      <tr>
          <td><code>removeXAttr</code></td>
          <td>Removes an extended attribute.</td>
      </tr>
      <tr>
          <td><code>setAcl</code></td>
          <td>Sets an ACL.</td>
      </tr>
      <tr>
          <td><code>getAclStatus</code></td>
          <td>Gets an ACL status.</td>
      </tr>
      <tr>
          <td><code>modifyAclEntries</code></td>
          <td>Modifies ACL entries.</td>
      </tr>
      <tr>
          <td><code>removeAclEntries</code></td>
          <td>Removes ACL entries.</td>
      </tr>
      <tr>
          <td><code>removeDefaultAcl</code></td>
          <td>Removes the default ACL.</td>
      </tr>
      <tr>
          <td><code>removeAcl</code></td>
          <td>Removes an ACL.</td>
      </tr>
      <tr>
          <td><code>truncate</code></td>
          <td>Truncates a file.</td>
      </tr>
      <tr>
          <td><code>concat</code></td>
          <td>Concatenates files.</td>
      </tr>
  </tbody>
</table>
<p><strong>Footnotes:</strong></p>
<p>[1] Renaming across buckets is not supported. For File System Optimized (FSO) buckets, rename is an atomic metadata operation. For legacy buckets, renaming a directory is non-atomic, as it is implemented by renaming each file and subdirectory individually.</p>
<p>[2] Deleting the root of the filesystem is not allowed. Recursive volume deletion is not supported.</p>
<p>[3] Recursive listing at the root or volume level is not supported.</p>
<p>[4] OFS supports &rsquo;linked buckets&rsquo;, where one bucket acts as a link to another. General-purpose symbolic links for files or directories are not supported.</p>
<p>[5] Snapshots are only supported at the bucket level.</p>
<h3 id="unsupported-hdfs-specific-operations">Unsupported HDFS-Specific Operations</h3>
<p>The following operations are specific to HDFS and are not supported by Ofs.</p>
<table>
  <thead>
      <tr>
          <th>Operation</th>
          <th>Description</th>
          <th>Support</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>setStoragePolicy</code></td>
          <td>Sets a storage policy on a file or directory.</td>
          <td>Unsupported</td>
      </tr>
      <tr>
          <td><code>getStoragePolicy</code></td>
          <td>Gets the storage policy of a file or directory.</td>
          <td>Unsupported</td>
      </tr>
      <tr>
          <td><code>getErasureCodingPolicy</code></td>
          <td>Gets the erasure coding policy of a file or directory.</td>
          <td>Unsupported</td>
      </tr>
      <tr>
          <td><code>setErasureCodingPolicy</code></td>
          <td>Sets an erasure coding policy on a directory.</td>
          <td>Unsupported</td>
      </tr>
      <tr>
          <td><code>unsetErasureCodingPolicy</code></td>
          <td>Unsets an erasure coding policy on a directory.</td>
          <td>Unsupported</td>
      </tr>
      <tr>
          <td><code>addCachePool</code></td>
          <td>Adds a cache pool.</td>
          <td>Unsupported</td>
      </tr>
      <tr>
          <td><code>modifyCachePool</code></td>
          <td>Modifies a cache pool.</td>
          <td>Unsupported</td>
      </tr>
      <tr>
          <td><code>removeCachePool</code></td>
          <td>Removes a cache pool.</td>
          <td>Unsupported</td>
      </tr>
      <tr>
          <td><code>listCachePools</code></td>
          <td>Lists all cache pools.</td>
          <td>Unsupported</td>
      </tr>
      <tr>
          <td><code>addCacheDirective</code></td>
          <td>Adds a cache directive.</td>
          <td>Unsupported</td>
      </tr>
      <tr>
          <td><code>modifyCacheDirective</code></td>
          <td>Modifies a cache directive.</td>
          <td>Unsupported</td>
      </tr>
      <tr>
          <td><code>removeCacheDirective</code></td>
          <td>Removes a cache directive.</td>
          <td>Unsupported</td>
      </tr>
      <tr>
          <td><code>listCacheDirectives</code></td>
          <td>Lists cache directives.</td>
          <td>Unsupported</td>
      </tr>
      <tr>
          <td><code>allowSnapshot</code></td>
          <td>Allows snapshots to be taken on a directory.</td>
          <td>Unsupported</td>
      </tr>
      <tr>
          <td><code>disallowSnapshot</code></td>
          <td>Disallows snapshots to be taken on a directory.</td>
          <td>Unsupported</td>
      </tr>
      <tr>
          <td><code>addErasureCodingPolicies</code></td>
          <td>Adds erasure coding policies.</td>
          <td>Unsupported</td>
      </tr>
      <tr>
          <td><code>getErasureCodingPolicies</code></td>
          <td>Gets the available erasure coding policies.</td>
          <td>Unsupported</td>
      </tr>
      <tr>
          <td><code>removeErasureCodingPolicy</code></td>
          <td>Removes an erasure coding policy.</td>
          <td>Unsupported</td>
      </tr>
      <tr>
          <td><code>enableErasureCodingPolicy</code></td>
          <td>Enables an erasure coding policy.</td>
          <td>Unsupported</td>
      </tr>
      <tr>
          <td><code>disableErasureCodingPolicy</code></td>
          <td>Disables an erasure coding policy.</td>
          <td>Unsupported</td>
      </tr>
      <tr>
          <td><code>getEZForPath</code></td>
          <td>Gets the encryption zone for a path.</td>
          <td>Unsupported</td>
      </tr>
      <tr>
          <td><code>listErasureCodingPolicies</code></td>
          <td>Lists all erasure coding policies.</td>
          <td>Unsupported</td>
      </tr>
      <tr>
          <td><code>listErasureCodingCodecs</code></td>
          <td>Lists all erasure coding codecs.</td>
          <td>Unsupported</td>
      </tr>
      <tr>
          <td><code>getQuotaUsage</code></td>
          <td>Gets the quota usage for a path.</td>
          <td>Unsupported</td>
      </tr>
      <tr>
          <td><code>setQuotaByStorageType</code></td>
          <td>Sets the quota by storage type for a path.</td>
          <td>Unsupported</td>
      </tr>
      <tr>
          <td><code>getQuotaByStorageType</code></td>
          <td>Gets the quota by storage type for a path.</td>
          <td>Unsupported</td>
      </tr>
      <tr>
          <td><code>msync</code></td>
          <td>Flushes out the data in client&rsquo;s user buffer.</td>
          <td>Unsupported</td>
      </tr>
      <tr>
          <td><code>satisfyStoragePolicy</code></td>
          <td>Satisfies the storage policy of a file.</td>
          <td>Unsupported</td>
      </tr>
  </tbody>
</table>


          
          <a class="btn  btn-success btn-lg" href="../interface/o3fs.html">Next >></a>
          
          </div>

        </div>
      </div>
    </div>
  </div>
    <div class="push"></div>
  </div>

  

<footer class="footer">
  <div class="container">
    <span class="small text-muted">
      Version: 2.1.0-SNAPSHOT, Last Modified: July 9, 2025 <a class="hide-child link primary-color" href="https://github.com/apache/ozone/commit/1ad1b2d58ad49f08b2202f6106853a97c1eefb41">1ad1b2d58a</a>
    </span>
  </div>
</footer>



<script src="../js/jquery-3.5.1.min.js"></script>
<script src="../js/ozonedoc.js"></script>
<script src="../js/bootstrap.min.js"></script>


</body>

</html>