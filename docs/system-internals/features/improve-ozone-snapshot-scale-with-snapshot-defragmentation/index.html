<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-system-internals/features/improve-ozone-snapshot-scale-with-snapshot-defragmentation" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Improve Ozone Snapshot Scale with Snapshot Defragmentation | Apache Ozone</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="robots" content="noindex, nofollow"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://ozone-site-v2.staged.apache.org/img/social-card.png"><meta data-rh="true" name="twitter:image" content="https://ozone-site-v2.staged.apache.org/img/social-card.png"><meta data-rh="true" property="og:url" content="https://ozone-site-v2.staged.apache.org/docs/system-internals/features/improve-ozone-snapshot-scale-with-snapshot-defragmentation"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Improve Ozone Snapshot Scale with Snapshot Defragmentation | Apache Ozone"><meta data-rh="true" name="description" content="Improving Snapshot Scale"><meta data-rh="true" property="og:description" content="Improving Snapshot Scale"><link data-rh="true" rel="canonical" href="https://ozone-site-v2.staged.apache.org/docs/system-internals/features/improve-ozone-snapshot-scale-with-snapshot-defragmentation"><link data-rh="true" rel="alternate" href="https://ozone-site-v2.staged.apache.org/docs/system-internals/features/improve-ozone-snapshot-scale-with-snapshot-defragmentation" hreflang="en"><link data-rh="true" rel="alternate" href="https://ozone-site-v2.staged.apache.org/docs/system-internals/features/improve-ozone-snapshot-scale-with-snapshot-defragmentation" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://PLACEHOLDER-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Apache Ozone RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Apache Ozone Atom Feed">




<link rel="search" type="application/opensearchdescription+xml" title="Apache Ozone" href="/opensearch.xml">
<link rel="manifest" href="/pwa/manifest.json">

<link rel="icon" href="favicon.ico" sizes="32x32">
<link rel="icon" href="favicon.svg" type="image/svg+xml">
<link rel="apple-touch-icon" href="apple-touch-icon.png">
<script src="/script/matomo.js"></script><link rel="stylesheet" href="/assets/css/styles.27c88cdc.css">
<script src="/assets/js/runtime~main.a1617199.js" defer="defer"></script>
<script src="/assets/js/main.9dca3952.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_wi3M" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/ozone-logo.svg" alt="Ozone Logo" class="themedComponent_Ka_G themedComponent--light_hIiB"><img src="/img/ozone-logo.svg" alt="Ozone Logo" class="themedComponent_Ka_G themedComponent--dark_GbLg"></div><b class="navbar__title text--truncate">Apache Ozone</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">Docs</a><a class="navbar__item navbar__link" href="/download">Download</a><a class="navbar__item navbar__link" href="/roadmap">Roadmap</a><a class="navbar__item navbar__link" href="/faq">FAQ</a><a class="navbar__item navbar__link" href="/blog">Blog</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Community</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/community/communication-channels">Communication Channels</a></li><li><a class="dropdown__link" href="/community/who-uses-ozone">Who Uses Ozone?</a></li><li><a class="dropdown__link" href="/community/report-an-issue">Report An Issue</a></li><li><a class="dropdown__link" href="/community/ask-a-question">Ask a Question</a></li><li><a class="dropdown__link" href="/community/how-to-contribute">How to Contribute</a></li><li><a class="dropdown__link" href="/community/events-and-media">Events and Media</a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_NU7Q"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/docs/system-internals/features/improve-ozone-snapshot-scale-with-snapshot-defragmentation" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li></ul></div><a href="https://github.com/apache/ozone" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub Repo"></a><div class="toggle_F0tt colorModeToggle_Cksm"><button class="clean-btn toggleButton_tFD4 toggleButtonDisabled_UmGx" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_gzz6"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_HsWo"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_SQAi"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_HMzJ"><div class="docsWrapper_TA0s"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton__Euq" type="button"></button><div class="docRoot_VN1Z"><aside class="theme-doc-sidebar-container docSidebarContainer_jdpB"><div class="sidebarViewport_pKkV"><div class="scrollCustom_InGK"><div class="customSidebarVersion_kZiw"><div class="customSidebarInner_rBmt"><span style="display:inline-block">Version:</span> <a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/system-internals/features/improve-ozone-snapshot-scale-with-snapshot-defragmentation">Next</a></div></div><div id="sidebarCssSelector_uq97"><div class="sidebar_W81o"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_KB1A"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/quick-start/">Quick Start</a><button aria-label="Expand sidebar category &#x27;Quick Start&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/core-concepts/">Core Concepts</a><button aria-label="Expand sidebar category &#x27;Core Concepts&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/user-guide/">User Guide</a><button aria-label="Expand sidebar category &#x27;User Guide&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/administrator-guide/">Administrator Guide</a><button aria-label="Expand sidebar category &#x27;Administrator Guide&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/troubleshooting/">Troubleshooting</a><button aria-label="Expand sidebar category &#x27;Troubleshooting&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/system-internals/">System Internals</a><button aria-label="Collapse sidebar category &#x27;System Internals&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/system-internals/components/">Components</a><button aria-label="Expand sidebar category &#x27;Components&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/system-internals/data-operations/">Data Operations</a><button aria-label="Expand sidebar category &#x27;Data Operations&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/system-internals/data-integrity/">Data Integrity</a><button aria-label="Expand sidebar category &#x27;Data Integrity&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/system-internals/replication/">Replication</a><button aria-label="Expand sidebar category &#x27;Replication&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/system-internals/security/">Security</a><button aria-label="Expand sidebar category &#x27;Security&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/system-internals/network-protocols/">Network Protocols</a><button aria-label="Expand sidebar category &#x27;Network Protocols&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/system-internals/features/">Features</a><button aria-label="Collapse sidebar category &#x27;Features&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/system-internals/features/filesystem-optimization">Filesystem Optimization (FSO)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/system-internals/features/upgrade-downgrade">Upgrade and Downgrade</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/system-internals/features/bucket-snapshots">Bucket Snapshot</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/system-internals/features/erasure-coding">Erasure Coding</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/system-internals/features/improve-ozone-snapshot-scale-with-snapshot-defragmentation">Improve Ozone Snapshot Scale with Snapshot Defragmentation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/system-internals/features/om-bootstrapping-with-snapshots">OM Bootstrapping with Snapshots</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/developer-guide/">Developer Guide</a><button aria-label="Expand sidebar category &#x27;Developer Guide&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></div></div></aside><main class="docMainContainer_YnIx"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_oKcN"><div class="docItemContainer_EnqJ"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_JwNh" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_gcoS"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/system-internals/"><span itemprop="name">System Internals</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/system-internals/features/"><span itemprop="name">Features</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Improve Ozone Snapshot Scale with Snapshot Defragmentation</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_my_n theme-doc-toc-mobile tocMobile_mwTw"><button type="button" class="clean-btn tocCollapsibleButton_v3oV">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Improve Ozone Snapshot Scale with Snapshot Defragmentation</h1></header>
<h2 class="anchor anchorWithStickyNavbar_e_9H" id="improving-snapshot-scale">Improving Snapshot Scale<a href="#improving-snapshot-scale" class="hash-link" aria-label="Direct link to Improving Snapshot Scale" title="Direct link to Improving Snapshot Scale">​</a></h2>
<p><a href="https://issues.apache.org/jira/browse/HDDS-13003" target="_blank" rel="noopener noreferrer">HDDS-13003</a></p>
<h2 class="anchor anchorWithStickyNavbar_e_9H" id="problem-statement">Problem Statement<a href="#problem-statement" class="hash-link" aria-label="Direct link to Problem Statement" title="Direct link to Problem Statement">​</a></h2>
<p>In Apache Ozone, snapshots currently take a checkpoint of the Active Object Store (AOS) RocksDB each time a snapshot is created and track the compaction of SST files over time. This model works efficiently when snapshots are short-lived, as they merely serve as hard links to the AOS RocksDB. However, over time, if an older snapshot persists while significant churn occurs in the AOS RocksDB (due to compactions and writes), the snapshot RocksDB may diverge significantly from both the AOS RocksDB and other snapshot RocksDB instances. This divergence increases storage requirements linearly with the number of snapshots.</p>
<h2 class="anchor anchorWithStickyNavbar_e_9H" id="solution-proposal">Solution Proposal<a href="#solution-proposal" class="hash-link" aria-label="Direct link to Solution Proposal" title="Direct link to Solution Proposal">​</a></h2>
<p>The primary inefficiency in the current snapshot mechanism stems from constant RocksDB compactions in AOS, which can cause a key, file, or directory entry to appear in multiple SST files. Ideally, each unique key, file, or directory entry should reside in only one SST file, eliminating redundant storage and mitigating the multiplier effect caused by snapshots. If implemented correctly, the total RocksDB size would be proportional to the total number of unique keys in the system rather than the number of snapshots.</p>
<h2 class="anchor anchorWithStickyNavbar_e_9H" id="snapshot-defragmentation">Snapshot Defragmentation<a href="#snapshot-defragmentation" class="hash-link" aria-label="Direct link to Snapshot Defragmentation" title="Direct link to Snapshot Defragmentation">​</a></h2>
<p>Currently, snapshot RocksDBs has automatic RocksDB compaction disabled intentionally to preserve snapshot diff performance, preventing any form of compaction. However, snapshots can be defragmented in the way that the next active snapshot in the chain is a checkpoint of its previous active snapshot plus a diff stored in separate SST files (one SST for each column family changed). The proposed approach involves rewriting snapshots iteratively from the beginning of the snapshot chain and restructuring them in a separate directory.</p>
<p>Note: Snapshot Defragmentation was previously called Snapshot Compaction earlier during the design phase. It is not RocksDB compaction. Thus the rename to avoid such confusion. We are also not going to enable RocksDB auto compaction on snapshot RocksDBs.</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_e_9H" id="1-introducing-last-defragmentation-time">1. Introducing Last Defragmentation Time<a href="#1-introducing-last-defragmentation-time" class="hash-link" aria-label="Direct link to 1. Introducing Last Defragmentation Time" title="Direct link to 1. Introducing Last Defragmentation Time">​</a></h3>
<p>A new boolean flag (<code>needsDefrag</code>), timestamp (<code>lastDefragTime</code>), int <code>version</code> would be added to snapshot metadata.<br>
<code>needsDefrag</code> tells the system whether a snapshot is pending defrag (<code>true</code>) or if it is already defragged and up to date (<code>false</code>). This helps manage and automate the defrag workflow, ensuring snapshots are efficiently stored and maintained. <code>needsDefrag</code> defaults to <code>false</code> during initialization and when absent.<br>
<!-- -->A new list of <code>Map&lt;String, List&lt;Longs&gt;&gt;</code> (<code>notDefraggedSstFileList</code>) also would be added to snapshot meta as part of snapshot create operation; this would be storing the original list of SST files in the not defragged copy of the snapshot corresponding to keyTable/fileTable/DirectoryTable. This should be done as part of the snapshot create operation.<br>
<!-- -->Since this is not going to be consistent across all OMs this would have to be written to a local YAML file inside the snapshot directory and this can be maintained in the SnapshotChainManager in memory on startup. So all updates should not go through Ratis.<br>
<!-- -->An additional <code>Map&lt;Integer, Map&lt;String, List&lt;Long&gt;&gt;&gt;</code> (<code>defraggedSstFileList</code>) also would be added to snapshotMeta. This will be maintaining a list of sstFiles of different versions of defragged snapshots. The key here would be the version number of snapshot DBs.</p>
<h3 class="anchor anchorWithStickyNavbar_e_9H" id="2-snapshot-cache-lock-for-read-prevention">2. Snapshot Cache Lock for Read Prevention<a href="#2-snapshot-cache-lock-for-read-prevention" class="hash-link" aria-label="Direct link to 2. Snapshot Cache Lock for Read Prevention" title="Direct link to 2. Snapshot Cache Lock for Read Prevention">​</a></h3>
<p>A snapshot lock will be introduced in the snapshot cache to prevent reads on a specific snapshot during the last step of defragmentation. This ensures no active reads occur while we are replacing the underlying RocksDB instance. The swap should be instantaneous.</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_e_9H" id="3-directory-structure-changes">3. Directory Structure Changes<a href="#3-directory-structure-changes" class="hash-link" aria-label="Direct link to 3. Directory Structure Changes" title="Direct link to 3. Directory Structure Changes">​</a></h3>
<p>Snapshots currently reside under <code>db.snapshots/checkpointState/</code> directory. The proposal introduces a <code>db.snapshots/checkpointStateDefragged/</code> directory for defragged snapshots. The directory format should be as follows:</p>
<div class="language-text codeBlockContainer_mZR4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_rIoO"><pre tabindex="0" class="prism-code language-text codeBlock_kDDR thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_SQL2"><span class="token-line" style="color:#393A34"><span class="token plain">db.snapshots/checkpointState/</span><br></span></code></pre><div class="buttonGroup_QU8l"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_PE_v" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_bUEh"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_DKrM"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_e_9H" id="4-optimized-snapshot-diff-computation">4. Optimized Snapshot Diff Computation<a href="#4-optimized-snapshot-diff-computation" class="hash-link" aria-label="Direct link to 4. Optimized Snapshot Diff Computation" title="Direct link to 4. Optimized Snapshot Diff Computation">​</a></h3>
<p>To compute a snapshot diff:</p>
<ul>
<li>If both snapshots are defragged, their defragged versions will be used. The diff between two defragged snapshot should be present in one SST file.</li>
<li>If the target snapshot is not defragged &amp; the source snapshot is defragged (other way is not possible as we always defrag snapshots in order) and if the DAG has all the sst files corresponding to the not defragged snapshot version of the defragged snapshot which would be captured as part of the snapshot metadata, then an efficient diff can be performed with the information present in the DAG. Use <code>notDefraggedSstFileList</code> from each of the snapshot’s meta</li>
<li>Otherwise, a full diff will be computed between the defragged source and the defragged target snapshot. Delta SST files would be computed corresponding to the latest version number of the target snapshot(version number of target snapshot would always be greater)</li>
<li>Changes in the full diff logic is required to check inode ids of sst files and remove the common sst files b/w source and target snapshots.</li>
</ul>
<hr>
<h3 class="anchor anchorWithStickyNavbar_e_9H" id="5-snapshot-defragmentation-workflow">5. Snapshot Defragmentation Workflow<a href="#5-snapshot-defragmentation-workflow" class="hash-link" aria-label="Direct link to 5. Snapshot Defragmentation Workflow" title="Direct link to 5. Snapshot Defragmentation Workflow">​</a></h3>
<p>A background snapshot defragmentation service should be added which would be done by iterating through the snapshot chain in the same order as the global snapshot chain. This is to ensure the snapshot created after is always defragged after all the snapshots previously created are defragged. Snapshot defragmentation should only occur once the snapshot has undergone SST filtering. The following steps outline the process:</p>
<ul>
<li>
<p><strong>Create a RocksDB checkpoint</strong> of the path previous snapshot corresponding to the bucket in the chain (if it exists). <code>version</code> of previous snapshot should be strictly greater than the current snapshot’s <code>version</code> otherwise skip compacting this snapshot in this iteration.</p>
</li>
<li>
<p><strong>Acquire the <code>SNAPSHOT_GC_LOCK</code></strong> for the snapshot ID to prevent garbage collection during defragmentation[This is to keep contents of deleted Table contents same while defragmentation consistent].</p>
<ol>
<li>
<p>If there is no path previous snapshot then</p>
<ol>
<li>Take a checkpoint of the same RocksDB instance remove keys that don’t correspond to the bucket from tables <code>keyTable</code>, <code>fileTable</code>, <code>directoryTable,deletedTable,deletedDirectoryTable</code> by running RocksDB delete range api. This should be done if the snapshot has never been defragged before i.e. if <code>lastDefragTime</code> is zero or null. Otherwise just update the <code>needsDefrag</code> to False.</li>
<li>We can trigger a forced manual compaction on the RocksDB instance(i &amp; ii can be behind a flag where in we can just work with the checkpoint of the RocksDB if the flag is disabled).</li>
</ol>
</li>
<li>
<p>If path previous snapshot exists:</p>
<ol>
<li><strong>Compute the diff</strong> between tables (<code>keyTable</code>, <code>fileTable</code>, <code>directoryTable</code>) of the checkpoint and the current snapshot using snapshot diff functionality.</li>
<li><strong>Flush changed objects</strong> into separate SST files using the SST file writer, categorizing them by table type.</li>
<li><strong>Ingest these SST files</strong> into the RocksDB checkpoint using the <code>ingestFile</code> API.</li>
</ol>
</li>
</ol>
</li>
<li>
<p>Check if the entire current snapshot has been flushed to disk otherwise wait for the flush to happen.</p>
</li>
<li>
<p>Truncate <code>deletedTable,deletedDirectoryTable,snapshotRenamedTable etc. (All tables excepting keyTable/fileTable/directoryTable)</code> in checkpointed RocksDB and ingest the entire table from deletedTable and deletedDirectoryTable from the current snapshot RocksDB.</p>
</li>
<li>
<p><strong>Acquire the snapshot cache lock</strong> to prevent snapshot access during directory updates.[While performing the snapshot RocksDB directory switch there should be no RocksDB handle with read happening on it].</p>
</li>
<li>
<p><strong>Move the checkpoint directory</strong> into <code>checkpointStateDefragged</code> with the format:</p>
</li>
</ul>
<div class="language-text codeBlockContainer_mZR4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_rIoO"><pre tabindex="0" class="prism-code language-text codeBlock_kDDR thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_SQL2"><span class="token-line" style="color:#393A34"><span class="token plain">om.db-&lt;snapshot_id&gt;-&lt;version&gt;</span><br></span></code></pre><div class="buttonGroup_QU8l"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_PE_v" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_bUEh"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_DKrM"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>
<p><strong>Update snapshot metadata</strong>, setting <code>lastDefragTime</code> and marking <code>needsDefrag = false</code> and set the next snapshot in the chain is marked for defragmentation. If there is no path previous snapshot in the chain then increase <code>version</code> by 1 otherwise set <code>version</code> which is equal to the previous snapshot in the chain. Based on the sstFiles in the RocksDB compute <code>Map&lt;String, List&lt;Long&gt;&gt;</code> and add this Map to <code>defraggedSstFileList</code> corresponding to the <code>version</code> of the snapshot.</p>
</li>
<li>
<p><strong>Delete old not defragged/defragged snapshots</strong>, ensuring unreferenced not defragged/defragged snapshots are purged during OM startup(This is to handle JVM crash after viii).</p>
</li>
<li>
<p><strong>Release the snapshot cache lock</strong> on the snapshot id. Now the snapshot is ready to be used to read</p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_e_9H" id="visualization">Visualization<a href="#visualization" class="hash-link" aria-label="Direct link to Visualization" title="Direct link to Visualization">​</a></h4>
<!-- -->
<h3 class="anchor anchorWithStickyNavbar_e_9H" id="computing-changed-objects-between-snapshots">Computing Changed Objects Between Snapshots<a href="#computing-changed-objects-between-snapshots" class="hash-link" aria-label="Direct link to Computing Changed Objects Between Snapshots" title="Direct link to Computing Changed Objects Between Snapshots">​</a></h3>
<p>The following steps outline how to compute changed objects between snapshots:</p>
<ol>
<li>
<p><strong>Determine delta SST files</strong></p>
<ul>
<li>Retrieve delta SST files from the DAG if the snapshot was not previously defragmented
and the previous snapshot has a non-defragmented copy.</li>
<li>Otherwise, compute delta SST files by comparing SST files in both defragmented
RocksDB instances.</li>
</ul>
</li>
<li>
<p><strong>Initialize SST file writers</strong> for the following tables <code>keyTable</code>, <code>directoryTable</code> and <code>fileTable</code></p>
</li>
<li>
<p><strong>Iterate SST files in parallel</strong>, reading and merging keys to maintain sorted order.(Similar to the MinHeapIterator instead of iterating through multiple tables we would be iterating through multiple sst files concurrently).</p>
</li>
<li>
<p><strong>Compare keys</strong> between snapshots to determine changes and write updated objects if and only if they have changed into the SST file.</p>
<ul>
<li>If the object is present in the target snapshot then do an <code>sstFileWriter.put()</code>.<!-- -->
<ul>
<li>If the object is present in source snapshot but not present in target snapshot then we just have to write a tombstone entry by calling <code>sstFileWriter.delete()</code>.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Ingest the generated SST files</strong> into the checkpointed RocksDB.</p>
</li>
</ol>
<hr>
<h4 class="anchor anchorWithStickyNavbar_e_9H" id="visualization-1">Visualization<a href="#visualization-1" class="hash-link" aria-label="Direct link to Visualization" title="Direct link to Visualization">​</a></h4>
<!-- -->
<h3 class="anchor anchorWithStickyNavbar_e_9H" id="handling-snapshot-purge">Handling Snapshot Purge<a href="#handling-snapshot-purge" class="hash-link" aria-label="Direct link to Handling Snapshot Purge" title="Direct link to Handling Snapshot Purge">​</a></h3>
<p>Upon snapshot deletion, the <code>needsDefrag</code> flag for the next snapshot in the chain
is set to <code>true</code>, ensuring defragmentation propagates incrementally across the snapshot chain.</p>
<h4 class="anchor anchorWithStickyNavbar_e_9H" id="visualization-2">Visualization<a href="#visualization-2" class="hash-link" aria-label="Direct link to Visualization" title="Direct link to Visualization">​</a></h4>
<!-- -->
<h2 class="anchor anchorWithStickyNavbar_e_9H" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p>This approach effectively reduces storage overhead while maintaining efficient snapshot retrieval and diff computation. The total storage would be in the order of total number of keys in the snapshots + AOS by reducing overall redundancy of the objects while also making the snapshot diff computation for even older snapshots more computationally efficient.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/apache/ozone-site/tree/HDDS-9225-website-v2/docs/07-system-internals/07-features/06-improve-ozone-snapshot-scale-with-snapshot-defragmentation.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_kQtw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_orCj"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/system-internals/features/erasure-coding"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Erasure Coding</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/system-internals/features/om-bootstrapping-with-snapshots"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">OM Bootstrapping with Snapshots</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_reur thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#improving-snapshot-scale" class="table-of-contents__link toc-highlight">Improving Snapshot Scale</a></li><li><a href="#problem-statement" class="table-of-contents__link toc-highlight">Problem Statement</a></li><li><a href="#solution-proposal" class="table-of-contents__link toc-highlight">Solution Proposal</a></li><li><a href="#snapshot-defragmentation" class="table-of-contents__link toc-highlight">Snapshot Defragmentation</a><ul><li><a href="#1-introducing-last-defragmentation-time" class="table-of-contents__link toc-highlight">1. Introducing Last Defragmentation Time</a></li><li><a href="#2-snapshot-cache-lock-for-read-prevention" class="table-of-contents__link toc-highlight">2. Snapshot Cache Lock for Read Prevention</a></li><li><a href="#3-directory-structure-changes" class="table-of-contents__link toc-highlight">3. Directory Structure Changes</a></li><li><a href="#4-optimized-snapshot-diff-computation" class="table-of-contents__link toc-highlight">4. Optimized Snapshot Diff Computation</a></li><li><a href="#5-snapshot-defragmentation-workflow" class="table-of-contents__link toc-highlight">5. Snapshot Defragmentation Workflow</a></li><li><a href="#computing-changed-objects-between-snapshots" class="table-of-contents__link toc-highlight">Computing Changed Objects Between Snapshots</a></li><li><a href="#handling-snapshot-purge" class="table-of-contents__link toc-highlight">Handling Snapshot Purge</a></li></ul></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Apache Software Foundation</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Foundation<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QWNa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="footer__link-item">License<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QWNa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.apache.org/events/current-event" target="_blank" rel="noopener noreferrer" class="footer__link-item">Events<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QWNa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Sponsorship<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QWNa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://privacy.apache.org/policies/privacy-policy-public.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QWNa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.apache.org/security/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Security<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QWNa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Thanks<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QWNa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/apache/ozone/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item"><img src="/img/social/github.svg" alt="GitHub Discussions Icon" style="width:1em;height:1em;margin-right:0.5em;vertical-align:middle">GitHub Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QWNa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://issues.apache.org/jira/projects/HDDS/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item"><img src="/img/social/jira.svg" alt="Jira Issues Icon" style="width:1em;height:1em;margin-right:0.5em;vertical-align:middle">Jira Issues<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QWNa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://infra.apache.org/slack.html" target="_blank" rel="noopener noreferrer" class="footer__link-item"><img src="/img/social/slack.svg" alt="Slack Icon" style="width:1em;height:1em;margin-right:0.5em;vertical-align:middle">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QWNa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="mailto:dev@ozone.apache.org" target="_blank" rel="noopener noreferrer" class="footer__link-item"><img src="/img/social/mail.svg" alt="Mailing List Icon" style="width:1em;height:1em;margin-right:0.5em;vertical-align:middle">Mailing List<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QWNa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/@ApacheOzone" target="_blank" rel="noopener noreferrer" class="footer__link-item"><img src="/img/social/youtube.svg" alt="YouTube Icon" style="width:1em;height:1em;margin-right:0.5em;vertical-align:middle">YouTube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QWNa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/ApacheOzone" target="_blank" rel="noopener noreferrer" class="footer__link-item"><img src="/img/social/twitter-x.svg" alt="Twitter Icon" style="width:1em;height:1em;margin-right:0.5em;vertical-align:middle">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_QWNa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Repositories</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/apache/ozone" target="_blank" rel="noopener noreferrer" class="footer__link-item">Ozone</a></li><li class="footer__item"><a href="https://github.com/apache/ozone-site" target="_blank" rel="noopener noreferrer" class="footer__link-item">Website</a></li><li class="footer__item"><a href="https://github.com/apache/ozone-docker" target="_blank" rel="noopener noreferrer" class="footer__link-item">Docker Image</a></li><li class="footer__item"><a href="https://github.com/apache/ozone-docker-runner" target="_blank" rel="noopener noreferrer" class="footer__link-item">Docker Runner Image</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">
        <div>
          Copyright © 2026 <a href="https://www.apache.org/" class="copyright-link">The Apache Software Foundation</a>. Licensed under the <a href="https://www.apache.org/licenses/LICENSE-2.0" class="copyright-link">Apache License, Version 2.0</a>. <br>
          <div>
            <p>The Apache Software Foundation, Apache Ozone, Ozone, Apache, the Apache Feather, and the Apache Ozone project logo are either registered trademarks or trademarks of the Apache Software Foundation.</p>
          </div>
        </div></div></div></div></footer></div>
</body>
</html>