

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <meta name="description" content="Apache Ozone Documentation">

    <title>Documentation for Apache Ozone</title>

    
    <link href="../../css/bootstrap.min.css" rel="stylesheet">

    
    <link href="../../css/ozonedoc.css" rel="stylesheet">

    
    
    <link href="../../swagger-resources/swagger-ui.css" rel="stylesheet">

    
    <script>
      var _paq = window._paq = window._paq || [];
      

       
      _paq.push(['disableCookies']);
      

      _paq.push(['trackPageView']);
      _paq.push(['enableLinkTracking']);
      (function() {
        var u="//analytics.apache.org/";
        _paq.push(['setTrackerUrl', u+'matomo.php']);
        _paq.push(['setSiteId', '34']);
        var d=document, g=d.createElement('script'),
s=d.getElementsByTagName('script')[0];
        g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
      })();
    </script>
    

  </head>


<body>

  
<nav class="navbar navbar-inverse navbar-fixed-top">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#sidebar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a href="../../zh/index.html" class="navbar-left ozone-logo">
        <img src="../../ozone-logo-small.png"/>
      </a>
      <a class="navbar-brand hidden-xs" href="../../zh/index.html">
        Apache Ozone/HDDS Documentation
      </a>
      <a class="navbar-brand visible-xs-inline" href="#">Apache Ozone</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li><a href="https://github.com/apache/ozone">Source</a></li>
        <li><a href="https://ozone.apache.org">Apache Ozone</a></li>
        <li><a href="https://apache.org">ASF</a></li>
      </ul>
    </div>
  </div>
</nav>


  <div class="wrapper">
  <div class="container-fluid">
    <div class="row">
      
<div class="col-sm-2 col-md-2 sidebar" id="sidebar">
  <ul class="nav nav-sidebar">
    
    
        
            <li class="">
                
                   <a href="../../zh/index.html">
                

                    
                    <span>概述</span>
                </a>
            </li>
        
    
        
            <li class="">
                
                   <a href="../../zh/start.html">
                

                    
                    <span>快速入门</span>
                </a>
            </li>
        
    
        
            <li class="">
                <a href="../../zh/concept.html">
                    
                    <span>概念</span>
                </a>
                <ul class="nav">
                    
                        <li class="">
                           
                           <a href="../../zh/concept/overview.html">概览</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../../zh/concept/ozonemanager.html">Ozone Manager</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../../zh/concept/storagecontainermanager.html">Storage Container Manager</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../../zh/concept/datanodes.html">数据节点</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../../zh/concept/containers.html">Containers</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../../zh/concept/recon.html">Recon</a>
                           
                        </li>
                    
                </ul>
            </li>
        
    
        
            <li class="">
                <a href="../../zh/feature.html">
                    
                    <span>特性</span>
                </a>
                <ul class="nav">
                    
                        <li class="">
                           
                           <a href="../../zh/feature/decommission.html">Decommissioning</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../../zh/feature/erasurecoding.html">纠删码</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../../zh/feature/om-ha.html">高可用 OM</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../../zh/feature/scm-ha.html">高可用 SCM</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../../zh/feature/dn-merge-rocksdb.html">在DataNode上合并Container的RocksDB</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../../zh/feature/prefixfso.html">基于前缀的文件系统优化</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../../zh/feature/topology.html">拓扑感知能力</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../../zh/feature/quota.html">Ozone 中的配额</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../../zh/feature/recon.html">Recon 服务器</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../../zh/feature/reconfigurability.html">动态加载配置</a>
                           
                        </li>
                    
                </ul>
            </li>
        
    
        
            <li class="">
                <a href="../../zh/security.html">
                    
                    <span>安全</span>
                </a>
                <ul class="nav">
                    
                        <li class="">
                           
                           <a href="../../zh/security/secureozone.html">安全化 Ozone</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../../zh/security/securingtde.html">透明数据加密</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../../zh/security/gdpr.html">Ozone 中的 GDPR</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../../zh/security/securingdatanodes.html">安全化 Datanode</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../../zh/security/securingozonehttp.html">安全化 HTTP</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../../zh/security/securings3.html">安全化 S3</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../../zh/security/securityacls.html">Ozone 访问控制列表</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../../zh/security/securitywithranger.html">Apache Ranger</a>
                           
                        </li>
                    
                </ul>
            </li>
        
    
        
            <li class="">
                <a href="../../zh/interface.html">
                    
                    <span>客户端接口</span>
                </a>
                <ul class="nav">
                    
                        <li class="active">
                           
                           <a href="../../zh/interface/cli.html">命令行接口</a>
                           
                        </li>
                    
                </ul>
            </li>
        
    
        
            <li class="">
                
                   <a href="../../zh/tools.html">
                

                    
                    <span>工具</span>
                </a>
            </li>
        
    
        
            <li class="">
                
                   <a href="../../zh/recipe.html">
                

                    
                    <span>使用配方</span>
                </a>
            </li>
        
    
        
            <li class="">
                <a href="../../">
                    
                    <span></span>
                </a>
                <ul class="nav">
                    
                        <li class="">
                           
                           <a href="../../zh/interface/javaapi.html">Java API</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../../zh/interface/ofs.html">Ofs (兼容 Hadoop 的文件系统)</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../../zh/interface/o3fs.html">Ozone 文件系统</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../../zh/interface/csi.html">CSI 协议</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../../zh/interface/s3.html">S3 协议接口</a>
                           
                        </li>
                    
                        <li class="">
                           
                           <a href="../../zh/interface/reconapi.html">Recon API</a>
                           
                        </li>
                    
                </ul>
            </li>
        
    
    <li><a href="../../design.html"><span><b>Design docs</b></span></a></li>
    <li class="visible-xs"><a href="#">References</a>
    <ul class="nav">
        <li><a href="https://github.com/apache/ozone"><span class="glyphicon glyphicon-new-window" aria-hidden="true"></span> Source</a></li>
        <li><a href="https://ozone.apache.org"><span class="glyphicon glyphicon-new-window" aria-hidden="true"></span> Apache Ozone</a></li>
        <li><a href="https://apache.org"><span class="glyphicon glyphicon-new-window" aria-hidden="true"></span> ASF</a></li>
    </ul></li>
  </ul>

</div>

      <div class="col-sm-10 col-sm-offset-2 col-md-10 col-md-offset-2 main-content">



        <div class="col-md-9">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                  <li class="breadcrumb-item"><a href="../../zh/index.html">Home</a></li>
                  <li class="breadcrumb-item" aria-current="page"><a href="../../zh/interface.html">客户端接口</a></li>
                  <li class="breadcrumb-item active" aria-current="page">命令行接口</li>
                </ol>
              </nav>

          

<div class="pull-right">
    
    
    
    <a href="../../interface/cli.html"><span class="label label-success">English</span></a>
    
    
    
    
</div>


          <div class="col-md-9">
            <h1>命令行接口</h1>

            <!---
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<p>Ozone shell 是从命令行与 Ozone 交互的主要接口。在后台，它调用 <a href="../../zh/interface/javaapi.html">Java API</a>.</p>
<p>有些功能只能通过使用 <code>ozone sh</code> 命令才能访问。例如：</p>
<ol>
<li>创建带有配额的卷</li>
<li>管理内部 ACL</li>
<li>创建带有加密的键的桶</li>
</ol>
<p>所有这些命令都是一次性的管理任务。应用程序也可以使用其他接口，如 Hadoop 兼容文件系统（o3fs 或 ofs）或 S3 接口来实现相同功能而无需使用 Ozone 命令行接口。</p>
<p>Ozone shell 的帮助菜单可以在 <em>对象</em> 级别 或者 <em>动作</em> 级别被调出.</p>
<p>示例命令:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ozone sh volume --help
</span></span></code></pre></div><p>这条命令展示了卷的所有可用的 <em>动作</em> 命令</p>
<p>或者也可以用来解释具体的某个 <em>动作</em> ，例如：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ozone sh volume create --help
</span></span></code></pre></div><p>这条命令输出卷的<code>create</code>动作的所有命令行选项</p>
<h2 id="通用命令格式">通用命令格式</h2>
<p>Ozone shell 命令采取以下形式:</p>
<blockquote>
<p><em>ozone sh object action url</em></p>
</blockquote>
<p><strong>ozone</strong> 脚本用于调用所有 Ozone 子命令。通过 <code>sh</code> 命令调用 ozone shell 命令。</p>
<p>对象可以是卷、桶或键。动作可以是创建、列出、删除等。</p>
<p>根据动作，Ozone URL 可以指向以下格式的卷、桶或键:</p>
<p><em>[schema][server:port]/volume/bucket/key</em></p>
<p>其中，</p>
<ol>
<li>
<p><strong>Schema</strong> - 应为 <code>o3</code>，这是访问 Ozone API 的原生 RPC 协议。是否指定 schema 是可选的。</p>
</li>
<li>
<p><strong>Server:Port</strong> - 应为 Ozone Manager 的地址。如果不指定端口，则将使用 ozone-site.xml 中的默认端口。</p>
</li>
</ol>
<p>请查看卷命令、桶命令和键命令部分了解更多详情。</p>
<h2 id="卷操作">卷操作</h2>
<p>卷位于层次结构的顶层，仅由管理员管理。也可以指定所有者用户和配额。</p>
<p>示例命令：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ ozone sh volume create /vol1
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ ozone sh volume info /vol1
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;metadata&#34;</span> : <span style="color:#f92672">{</span> <span style="color:#f92672">}</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;name&#34;</span> : <span style="color:#e6db74">&#34;vol1&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;admin&#34;</span> : <span style="color:#e6db74">&#34;hadoop&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;owner&#34;</span> : <span style="color:#e6db74">&#34;hadoop&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;creationTime&#34;</span> : <span style="color:#e6db74">&#34;2020-07-28T12:31:50.112Z&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;modificationTime&#34;</span> : <span style="color:#e6db74">&#34;2020-07-28T12:31:50.112Z&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;acls&#34;</span> : <span style="color:#f92672">[</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;type&#34;</span> : <span style="color:#e6db74">&#34;USER&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;name&#34;</span> : <span style="color:#e6db74">&#34;hadoop&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;aclScope&#34;</span> : <span style="color:#e6db74">&#34;ACCESS&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;aclList&#34;</span> : <span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;ALL&#34;</span> <span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">}</span>, <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;type&#34;</span> : <span style="color:#e6db74">&#34;GROUP&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;name&#34;</span> : <span style="color:#e6db74">&#34;users&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;aclScope&#34;</span> : <span style="color:#e6db74">&#34;ACCESS&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;aclList&#34;</span> : <span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;ALL&#34;</span> <span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">}</span> <span style="color:#f92672">]</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;quota&#34;</span> : <span style="color:#ae81ff">1152921504606846976</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ ozone sh volume list /
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;metadata&#34;</span> : <span style="color:#f92672">{</span> <span style="color:#f92672">}</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;name&#34;</span> : <span style="color:#e6db74">&#34;s3v&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;admin&#34;</span> : <span style="color:#e6db74">&#34;hadoop&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;owner&#34;</span> : <span style="color:#e6db74">&#34;hadoop&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;creationTime&#34;</span> : <span style="color:#e6db74">&#34;2020-07-27T11:32:22.314Z&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;modificationTime&#34;</span> : <span style="color:#e6db74">&#34;2020-07-27T11:32:22.314Z&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;acls&#34;</span> : <span style="color:#f92672">[</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;type&#34;</span> : <span style="color:#e6db74">&#34;USER&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;name&#34;</span> : <span style="color:#e6db74">&#34;hadoop&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;aclScope&#34;</span> : <span style="color:#e6db74">&#34;ACCESS&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;aclList&#34;</span> : <span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;ALL&#34;</span> <span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">}</span>, <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;type&#34;</span> : <span style="color:#e6db74">&#34;GROUP&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;name&#34;</span> : <span style="color:#e6db74">&#34;users&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;aclScope&#34;</span> : <span style="color:#e6db74">&#34;ACCESS&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;aclList&#34;</span> : <span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;ALL&#34;</span> <span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">}</span> <span style="color:#f92672">]</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;quota&#34;</span> : <span style="color:#ae81ff">1152921504606846976</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>, <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  ....
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span> <span style="color:#f92672">]</span>
</span></span></code></pre></div><p>如果卷为空，我们可以使用以下命令删除卷。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ ozone sh volume delete /vol1
</span></span><span style="display:flex;"><span>Volume vol1 is deleted
</span></span></code></pre></div><p>如果卷包含任意桶或键，我们可以递归地删除卷。这将删除卷中所有的桶和键，然后删除卷本身。在运行这个命令后，将无法恢复已删除的内容。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ ozone sh volume delete -r /vol1
</span></span><span style="display:flex;"><span>This command will delete volume recursively.
</span></span><span style="display:flex;"><span>There is no recovery option after using this command, and no trash <span style="color:#66d9ef">for</span> FSO buckets.
</span></span><span style="display:flex;"><span>Delay is expected running this command.
</span></span><span style="display:flex;"><span>Enter <span style="color:#e6db74">&#39;yes&#39;</span> to proceed<span style="color:#960050;background-color:#1e0010">&#39;</span>: yes
</span></span><span style="display:flex;"><span>Volume vol1 is deleted
</span></span></code></pre></div><h2 id="桶操作">桶操作</h2>
<p>桶是层次结构的第二层级，与 AWS S3 桶相似。如果用户有必要的权限，可以在卷中创建桶。</p>
<p>示例命令：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ ozone sh bucket create /vol1/bucket1
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ ozone sh bucket info /vol1/bucket1
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;metadata&#34;</span> : <span style="color:#f92672">{</span> <span style="color:#f92672">}</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;volumeName&#34;</span> : <span style="color:#e6db74">&#34;vol1&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;name&#34;</span> : <span style="color:#e6db74">&#34;bucket1&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;storageType&#34;</span> : <span style="color:#e6db74">&#34;DISK&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;versioning&#34;</span> : false,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;creationTime&#34;</span> : <span style="color:#e6db74">&#34;2020-07-28T13:14:45.091Z&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;modificationTime&#34;</span> : <span style="color:#e6db74">&#34;2020-07-28T13:14:45.091Z&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;encryptionKeyName&#34;</span> : null,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;sourceVolume&#34;</span> : null,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;sourceBucket&#34;</span> : null
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p>如果桶是空的，我们可以用以下命令来删除桶。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ ozone sh bucket delete /vol1/bucket1
</span></span><span style="display:flex;"><span>Bucket bucket1 is deleted
</span></span></code></pre></div><p>如果桶包含任意键，我们可以递归地删除桶。这将删除桶中的所有键，然后删除桶本身。在运行这个命令后，将无法恢复已删除的内容。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ ozone sh bucket delete -r /vol1/bucket1
</span></span><span style="display:flex;"><span>This command will delete bucket recursively.
</span></span><span style="display:flex;"><span>There is no recovery option after using this command, and deleted keys won<span style="color:#e6db74">&#39;t move to trash.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Enter &#39;</span>yes<span style="color:#e6db74">&#39; to proceed&#39;</span>: yes
</span></span><span style="display:flex;"><span>Bucket bucket1 is deleted
</span></span></code></pre></div><p><a href="../../zh/security/securingtde.html">透明数据加密</a> 可以在桶层级被启用。</p>
<h2 id="键操作">键操作</h2>
<p>键是可以存储数据的对象。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ ozone sh key put /vol1/bucket1/README.md README.md
</span></span></code></pre></div><div class="alert alert-warning" role="alert">
<p>在这个命令中，标准的命令顺序 <code>ozone sh &lt;object_type&gt; &lt;action&gt; &lt;url&gt;</code> 可能会让使用者困惑, 因为它的格式是 <code>ozone sh key put &lt;destination&gt; &lt;source&gt;</code>， 而不是我们习惯的自然的顺序 <code>&lt;source&gt; &lt;destination&gt;</code>.</p>
</div>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ ozone sh key info /vol1/bucket1/README.md
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;volumeName&#34;</span> : <span style="color:#e6db74">&#34;vol1&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;bucketName&#34;</span> : <span style="color:#e6db74">&#34;bucket1&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;name&#34;</span> : <span style="color:#e6db74">&#34;README.md&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;dataSize&#34;</span> : 3841,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;creationTime&#34;</span> : <span style="color:#e6db74">&#34;2020-07-28T13:17:20.749Z&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;modificationTime&#34;</span> : <span style="color:#e6db74">&#34;2020-07-28T13:17:21.979Z&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;replicationType&#34;</span> : <span style="color:#e6db74">&#34;RATIS&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;replicationFactor&#34;</span> : 1,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;ozoneKeyLocations&#34;</span> : <span style="color:#f92672">[</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;containerID&#34;</span> : 1,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;localID&#34;</span> : 104591670688743424,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;length&#34;</span> : 3841,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;offset&#34;</span> : <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">}</span> <span style="color:#f92672">]</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;metadata&#34;</span> : <span style="color:#f92672">{</span> <span style="color:#f92672">}</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;fileEncryptionInfo&#34;</span> : null
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ ozone sh key get /vol1/bucket1/README.md /tmp/
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ ozone sh key delete /vol1/bucket1/key1
</span></span></code></pre></div><p>如果键是在 <a href="../../zh/feature/prefixfso.html">FSO</a> 桶中，当删除键时它会被移动到回收站，回收站的位置是:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ /&lt;volume&gt;/&lt;bucket&gt;/.Trash/&lt;user&gt;
</span></span></code></pre></div><p>如果键是在OBS桶中，它将被永久删除。</p>
<h2 id="查询命令行结果">查询命令行结果</h2>
<p>Ozone命令行返回JSON响应。<a href="https://stedolan.github.io/jq/manual/">jq</a> 是一个命令行JSON处理器，可以用来过滤CLI结果以获取所需信息.</p>
<p>示例命令:</p>
<ul>
<li>列出不是链接的 FSO 桶。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ ozone sh bucket list /s3v | jq <span style="color:#e6db74">&#39;.[] | select(.link==false and .bucketLayout==&#34;FILE_SYSTEM_OPTIMIZED&#34;)&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;metadata&#34;</span>: <span style="color:#f92672">{}</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;volumeName&#34;</span>: <span style="color:#e6db74">&#34;s3v&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;fso-bucket&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;storageType&#34;</span>: <span style="color:#e6db74">&#34;DISK&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;versioning&#34;</span>: false,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;usedBytes&#34;</span>: 0,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;usedNamespace&#34;</span>: 0,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;creationTime&#34;</span>: <span style="color:#e6db74">&#34;2023-02-01T05:18:46.974Z&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;modificationTime&#34;</span>: <span style="color:#e6db74">&#34;2023-02-01T05:18:46.974Z&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;quotaInBytes&#34;</span>: -1,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;quotaInNamespace&#34;</span>: -1,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;bucketLayout&#34;</span>: <span style="color:#e6db74">&#34;FILE_SYSTEM_OPTIMIZED&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;owner&#34;</span>: <span style="color:#e6db74">&#34;om&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;link&#34;</span>: false
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><ul>
<li>列出 EC 桶以及它们的复制策略配置。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ ozone sh bucket list /vol1 | jq -r <span style="color:#e6db74">&#39;.[] | select(.replicationConfig.replicationType == &#34;EC&#34;) | {&#34;name&#34;: .name, &#34;replicationConfig&#34;: .replicationConfig}&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;ec5&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;replicationConfig&#34;</span>: <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;data&#34;</span>: 3,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;parity&#34;</span>: 2,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;ecChunkSize&#34;</span>: 1048576,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;codec&#34;</span>: <span style="color:#e6db74">&#34;RS&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;replicationType&#34;</span>: <span style="color:#e6db74">&#34;EC&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;requiredNodes&#34;</span>: <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;ec9&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;replicationConfig&#34;</span>: <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;data&#34;</span>: 6,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;parity&#34;</span>: 3,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;ecChunkSize&#34;</span>: 1048576,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;codec&#34;</span>: <span style="color:#e6db74">&#34;RS&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;replicationType&#34;</span>: <span style="color:#e6db74">&#34;EC&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;requiredNodes&#34;</span>: <span style="color:#ae81ff">9</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><ul>
<li>以制表符分隔的格式列出加密桶的名字以及它们的加密的键名。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ ozone sh bucket list /vol1 | jq -r <span style="color:#e6db74">&#39;.[] | select(.encryptionKeyName != null) | [.name, .encryptionKeyName] | @tsv&#39;</span>
</span></span><span style="display:flex;"><span>ec5     key1
</span></span><span style="display:flex;"><span>encrypted-bucket        key1
</span></span></code></pre></div>

          
          </div>

        </div>
      </div>
    </div>
  </div>
    <div class="push"></div>
  </div>

  

<footer class="footer">
  <div class="container">
    <span class="small text-muted">
      Version: 2.0.0, Last Modified: April 5, 2024 <a class="hide-child link primary-color" href="https://github.com/apache/ozone/commit/e34de9fbdbb7c78a5a415d8fe234f0db408fad61">e34de9fbdb</a>
    </span>
  </div>
</footer>



<script src="../../js/jquery-3.5.1.min.js"></script>
<script src="../../js/ozonedoc.js"></script>
<script src="../../js/bootstrap.min.js"></script>


</body>

</html>