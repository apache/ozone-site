# Release 2.1.0 Available

![Joshua-Trees-haiku](/releases-2.1.0.jpg)

## Release Notes

Apache Ozone 2.1.0 adds 805 new features, improvements and bug fixes on top of Ozone 2.0.

## Notable Changes

### [HDDS-10239](https://issues.apache.org/jira/browse/HDDS-10239) | **Storage Container Reconciliation**

Introduced a container reconciliation protocol to resolve mismatched container states and verify replica integrity.

---

### [HDDS-12940](https://issues.apache.org/jira/browse/HDDS-12940) | **Ozone Snapshot Phase 3: Scale up Snapshot Operations**

Enhanced Ozone Snapshot scalability and continued stability improvements.

---

### [HDDS-8387](https://issues.apache.org/jira/browse/HDDS-8387) | **Container and volume scanners phase II**

Enhanced storage volume failure handling by introducing a 'degraded' state to preserve data availability, along with improved health observability.

---

### [HDDS-12564](https://issues.apache.org/jira/browse/HDDS-12564) | **Handling disk issues in Datanodes - Phase II**

Enhanced Datanode disk space management to prevent out-of-space failures.

---

## New Configuration Options

- **OZONE_SERVER_OPTS**: A new environment variable was added to allow setting common Java options for all Ozone server processes at once.
- **ozone.compaction.service.enabled**: Enable or disable a background job that periodically compacts RocksDB tables flagged for compaction. The default is false.
- **ozone.OM.compaction.service.run.interval**: A background job that periodically compacts RocksDB tables flagged for compaction. The default is 6 hours.
- **ozone.OM.compaction.service.timeout**: A timeout value of compaction service. If this is set greater than 0, the service will stop waiting for compaction completion after this time. Unit could be defined with postfix (ns,ms,s,m,h,d). The default is 10 min.
- **ozone.OM.compaction.service.columnfamilies**: A comma separated, no spaces list of all the column families that are compacted by the compaction service. If this is empty, no column families are compacted. The default is "keyTable,fileTable,directoryTable,deletedTable,deletedDirectoryTable,multipartInfoTable".
- **ozone.OM.snapshot.prune.compaction.backup.batch.size**: This property controls Prune SST files in Compaction backup directory in batches every `ozone.om.snapshot.compaction.dag.prune.daemon.run.interval`. The default is 2000.

These properties provide more control over the Ratis write buffer, which can be adjusted to optimize performance based on workload and hardware:

- **ozone.OM.ratis.server.pending.write.byte-limit**: Sets the maximum byte size of all pending write requests. The default is 64MB.
- **ozone.OM.ratis.server.pending.write.element-limit**: Sets the maximum number of pending write requests. The default is 4096.

## Incompatible Change

[**HDDS-12152**](https://issues.apache.org/jira/browse/HDDS-12152) | Ozone now requires the Hadoop 3.4 runtime. Support for Hadoop 3.1.2 is deprecated.

### Default Value Changes

- **HDDS.SCM.block.deletion.per-interval.max**: Default is now 500,000 blocks per interval.
- **HDDS.Datanode.volume.choosing.policy**: Default changed from RoundRobinVolumeChoosingPolicy to CapacityVolumeChoosingPolicy.
- **HDDS.Datanode.volume.min.free.space**: Default changed from 5GB to 20GB.
- **HDDS.Datanode.volume.min.free.space.percent**: Default changed to 0.1%.
- **HDDS.Datanode.block.deleting.limit.per.interval**: Default is now 20,000 blocks per interval.
- **HDDS.SCM.safemode.min.Datanode**: Default changed from 1 to 3.
- **HDDS.secret.key.expiry.duration**: Default is now 9 days. This change ensures that tokens remain valid for their full configured duration, preventing premature key invalidation and improving stable authentication.
- **fs.trash.classname**: Class name updated to org.apache.Hadoop.fs.ozone.OzoneTrashPolicy.
- **ozone.key.deleting.limit.per.task**: Default is now 50,000 keys per task.
- **ozone.s3g.https-address**: Default changed from None to 0.0.0.0:9879.
- **ozone.OM.fs.snapshot.max.limit**: Default is now 10,000 snapshots.
- **ozone.OM.ratis.segment.size**: Default is now 64MB (was 4MB).
- **ozone.SCM.ha.dbtransactionbuffer.flush.interval**: Default is now 1 min.
- **ozone.SCM.ha.ratis.segment.size**: Default is now 64MB (was 4MB).

### Removed Configurations

- **HDDS.rest.http-address**: This configuration is removed since [HDDS-12761](https://issues.apache.org/jira/browse/HDDS-12761).
- **HDDS.SCM.safemode.pipeline-availability.check**: This configuration is removed since [HDDS-11799](https://issues.apache.org/jira/browse/HDDS-11799).

## Changelog

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

### [2.1.0] - 2025-12-31

#### Added

- Added design documentation and initial integration steps for OpenTelemetry. ([HDDS-13679](https://issues.apache.org/jira/browse/HDDS-13679))
- Implemented an in-memory manager for Snapshot Local Data. ([HDDS-13627](https://issues.apache.org/jira/browse/HDDS-13627))
- Added support for Ranger to authorize STS tokens. ([HDDS-13848](https://issues.apache.org/jira/browse/HDDS-13848))
- Added latency metrics for key creation operations and deletion services to Grafana dashboards. ([HDDS-13510](https://issues.apache.org/jira/browse/HDDS-13510))
- Include openssl native library check in the Ozone debug checknative command output. ([HDDS-13266](https://issues.apache.org/jira/browse/HDDS-13266))
- Apache Ozone is migrated from OpenTracing to OpenTelemetry for distributed tracing. ([HDDS-13680](https://issues.apache.org/jira/browse/HDDS-13680))
- Enable rpm builds for Ozone. To build rpm packages, do: mvn clean package -DskipTests=true -Prpm. Optionally specify -Drpm.targetArch=aarch64 for ARM builds. ([HDDS-13439](https://issues.apache.org/jira/browse/HDDS-13439))
- Ozone supports creating deb package for Debian. Example command: mvn clean package -Pdeb The package file `ozone_<ozone_version>-<linux_distro>_.deb` will be created under folder path Hadoop-ozone/dist/target. The Ozone binary will be installed under /opt/ozone directory. ([HDDS-13414](https://issues.apache.org/jira/browse/HDDS-13414))
- Added a "Deletion Progress" section to the OM Web UI to track Key Deleting Service metrics (count and size) from the last 24 hours, along with service status and schedule details. ([HDDS-12887](https://issues.apache.org/jira/browse/HDDS-12887))
- Added a throttling mechanism to SCM to prevent excessive memory usage and long GC pauses during large-scale block deletions. ([HDDS-12087](https://issues.apache.org/jira/browse/HDDS-12087))
- Added support for Listener Ozone Managers (OM). Listener OMs are read-only, non-voting nodes that replicate logs from the leader to serve read requests, improving read performance and offloading voting OMs. ([HDDS-11523](https://issues.apache.org/jira/browse/HDDS-11523))
- Exposed new metrics under `StorageVolumeScannerMetrics` and `VolumeInfoMetrics` on Datanodes to improve observability of storage volume scanning activity and health. ([HDDS-8783](https://issues.apache.org/jira/browse/HDDS-8783))
- Added specific audit logs for background deletion services and internal OM requests. ([HDDS-13370](https://issues.apache.org/jira/browse/HDDS-13370), [HDDS-11314](https://issues.apache.org/jira/browse/HDDS-11314))
- Added logic to immediately trigger heartbeat and container close when a volume is full. ([HDDS-13045](https://issues.apache.org/jira/browse/HDDS-13045))
- Added support for uploading and deleting objects using presigned URLs. ([HDDS-5195](https://issues.apache.org/jira/browse/HDDS-5195), [HDDS-13663](https://issues.apache.org/jira/browse/HDDS-13663))
- Added support for custom metadata headers with uppercase characters. ([HDDS-13429](https://issues.apache.org/jira/browse/HDDS-13429))
- Added support for S3 STANDARD_IA storage class to accept EC replication config and owner field in listBuckets. ([HDDS-1097](https://issues.apache.org/jira/browse/HDDS-1097))
- Added new Grafana dashboards for low-level RocksDB operations and Deletion progress. ([HDDS-12446](https://issues.apache.org/jira/browse/HDDS-12446), [HDDS-13259](https://issues.apache.org/jira/browse/HDDS-13259))
- Added a "Mismatched Replica" tab to the Containers Page and improved mismatch API. ([HDDS-12395](https://issues.apache.org/jira/browse/HDDS-12395))
- Added Ozone admin commands for listing containers based on health state and sorting Datanodes. ([HDDS-12653](https://issues.apache.org/jira/browse/HDDS-12653), [HDDS-13095](https://issues.apache.org/jira/browse/HDDS-13095))

#### Changed

- **Metadata Storage**: Moved container-related metadata and OM task metadata from Derby DB to Ozone Manager (OM) RocksDB. ([HDDS-13669](https://issues.apache.org/jira/browse/HDDS-13669))
- **Locking**: Refactored OzoneManagerLock to handle hierarchical resource locking and implemented a pool-based lock manager. ([HDDS-13797](https://issues.apache.org/jira/browse/HDDS-13797), [HDDS-13798](https://issues.apache.org/jira/browse/HDDS-13798))
- Bumped Apache Ratis to version 3.2.0. ([HDDS-12070](https://issues.apache.org/jira/browse/HDDS-12070))
- Bumped AWS SDK to version 2.35.5. ([HDDS-13793](https://issues.apache.org/jira/browse/HDDS-13793))
- Bumped Jetty to 9.4.58. ([HDDS-13585](https://issues.apache.org/jira/browse/HDDS-13585))
- Bumped minimum Maven version to 3.6.3. ([HDDS-13364](https://issues.apache.org/jira/browse/HDDS-13364))
- **Recon Sync**: Separated Recon OM synchronization from task processing to improve stability. ([HDDS-8633](https://issues.apache.org/jira/browse/HDDS-8633))
- The default backup SST pruning interval is now **10 minutes**. This means old backup files will be deleted more frequently, improving disk space usage if Ozone Snapshot is enabled. ([HDDS-13638](https://issues.apache.org/jira/browse/HDDS-13638))
- Ozone now requires the Hadoop 3.4 runtime. Support for Hadoop 3.1.2 is deprecated. ([HDDS-12152](https://issues.apache.org/jira/browse/HDDS-12152))
- Renamed the previous functionality of the `--all` option in `ozone sh snapshot lsDiff` to `--all-status`. The `--all` option now behaves as a listing limit, setting the count to `Integer.MAX_VALUE`. ([HDDS-8802](https://issues.apache.org/jira/browse/HDDS-8802))

#### Fixed

- **Snapshot Locking**: Fixed OMLockDetails usage where it incorrectly returned a ThreadLocal Object. ([HDDS-13978](https://issues.apache.org/jira/browse/HDDS-13978), [HDDS-13004](https://issues.apache.org/jira/browse/HDDS-13004))
- **Recon Startup**: Improved Recon bootup times by handling failed delta tasks from previous runs and making task reprocessing non-blocking. ([HDDS-13791](https://issues.apache.org/jira/browse/HDDS-13791))
- Corrected pagination semantics for listMultipartUploads and ListObjectsV2. ([HDDS-13290](https://issues.apache.org/jira/browse/HDDS-13290))
- Fixed Datanode decommission failing when other nodes are offline in Ratis replication. ([HDDS-13544](https://issues.apache.org/jira/browse/HDDS-13544))
- Fixed memory leaks in NSSummary and issues with Derby during schema upgrade. ([HDDS-8565](https://issues.apache.org/jira/browse/HDDS-8565), [HDDS-12968](https://issues.apache.org/jira/browse/HDDS-12968))

#### Security

- **Ranger**: Added artifacts for Ranger to authorize STS tokens. ([HDDS-13848](https://issues.apache.org/jira/browse/HDDS-13848))

### Downloads

- [Download tar.gz](https://www.apache.org/dyn/closer.cgi/ozone/2.1.0/ozone-2.1.0.tar.gz) ([checksum](https://downloads.apache.org/ozone/2.1.0/ozone-2.1.0.tar.gz.sha512), [signature](https://downloads.apache.org/ozone/2.1.0/ozone-2.1.0.tar.gz.asc))
- [Download src](https://www.apache.org/dyn/closer.cgi/ozone/2.1.0/ozone-2.1.0-src.tar.gz) ([checksum](https://downloads.apache.org/ozone/2.1.0/ozone-2.1.0-src.tar.gz.sha512), [signature](https://downloads.apache.org/ozone/2.1.0/ozone-2.1.0-src.tar.gz.asc))

### Documentation

- [Ozone 2.1.0 Documentation](https://ozone.apache.org/docs/2.1.0)

**Release Date:** 2025 Dec 31
