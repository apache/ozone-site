<!--
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License. See accompanying LICENSE file.
-->

# Apache Ozone Website v2

Welcome to the development branch of the new and improved Apache Ozone website. The new site is being built with [Docusaurus](https://docusaurus.io/). See the [Docusaurus docs](https://docusaurus.io/docs) for details on working with this framework.

## Relevant Links

- [HDDS-9225](https://issues.apache.org/jira/browse/HDDS-9225) is the parent Jira tracking current tasks required to get the new website ready for deployment.

- Attached to this Jira is a [document](https://issues.apache.org/jira/secure/attachment/13062569/Improving%20the%20Apache%20Ozone%20Website.pdf) outlining the long term plan required to get the new website ready for deployment.

- This [Apache mail thread](https://lists.apache.org/thread/fooxgc81cbglpl8kcfxr5mfgm9qrf5v1) is the original dev mailing thread discussing the new Ozone website.

## Branches

- Development of the new website is currently happening on the `HDDS-9225-website-v2` branch. All changes specific to the new website should be merged into this branch.

- The `master` branch is still tracking content for the currently active Ozone website. `master` and `HDDS-9225-website-v2` will remain separate until the new website is ready to be deployed.

- The `asf-site` branch is still holding build artifacts being used to deploy content from the `master` branch. The new website is not being hosted anywhere, but can be previewed locally.

## Local Development

### Setup

1. Install [pnpm](https://pnpm.io/installation), which will be used to build the site.

2. Install dependencies required to build the website by running `pnpm install` at the website root.

### Preview

Once installed, there are two ways to preview the website locally. Each option will launch the site at `localhost:3000` on your machine.

- **Development Server** (See [Docusaurus docs](https://docusaurus.io/docs/installation#running-the-development-server)): This option will start the Docusaurus development server. It will not produce a `build` directory with build artifacts, and allows updates to website files to be displayed in the browser in real time.

  1. Run `pnpm start` from the repository root to start the development server.

- **Local Build** (See [Docusaurus docs](https://docusaurus.io/docs/installation#build)): This option will do a production build, putting artifacts in the `build` directory. This can still be previewed locally, but will not automatically reflect changes to website files.

  1. Run `pnpm build` from the repository root to build the content.

  2. Run `pnpm serve` to preview the built website locally.

- **Containerized Build (Recommended)**: This is the easiest way to preview the website and the easiest for any developer who would want to contribute to the project.
**Prerequisites**:
  
  - Docker
  - Docker Compose

  The project has included `Dockerfile` and `compose.yml` files to build and run the website in a containerized environment.

    1. Make sure the current repository is the working directory.
        - Default port is mapped to **3000**. Make changes accordingly if this is already being used in the local machine.
    2. Run `docker-compose up`.
    3. Preview for the website will be available at `localhost:3000`

  Any changes made in the repository will be reflected in the preview. No extra installation required.




### Updating the Website

The following files can be modified to change various aspects of the website:

- `docusaurus.config.js`
  - The main configuration file for the docusaurus site.
  - See https://docusaurus.io/docs/configuration

- `sidebars.js`
  - Configuration of the documentation menu sidebars.
  - This file should not need to be modified since the menu will be auto-generated from the directory and file layout.
  - See https://docusaurus.io/docs/sidebar/autogenerated

- `static`
  - Contains non-code files that are directly copied to the build output.
  - See https://docusaurus.io/docs/static-assets
  - `static/img`
    - Directory for all images needed to build the site.

- `docs`
  - Documentation pages.
  - See https://docusaurus.io/docs/create-doc

- `src/pages`
  - Static pages outside of the documentation section.
  - See https://docusaurus.io/docs/creating-pages
