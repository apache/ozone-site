<!--
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License. See accompanying LICENSE file.
-->

# Apache Ozone Website v2

Welcome to the development branch of the new and improved Apache Ozone website. The new site is being built with [Docusaurus](https://docusaurus.io/). See the [Docusaurus docs](https://docusaurus.io/docs) for details on working with this framework.

You can preview the current state of the new website at https://ozone-site-v2.staged.apache.org.

## Context

- [HDDS-9225](https://issues.apache.org/jira/browse/HDDS-9225) is the parent Jira tracking current tasks required to get the new website ready for deployment.

- Attached to this Jira is a [document](https://issues.apache.org/jira/secure/attachment/13062569/Improving%20the%20Apache%20Ozone%20Website.pdf) outlining the long term plan required to get the new website ready for deployment.

- This [Apache mail thread](https://lists.apache.org/thread/fooxgc81cbglpl8kcfxr5mfgm9qrf5v1) is the original dev mailing thread discussing the new Ozone website.

## Branches

- Development of the new website is currently happening on the `HDDS-9225-website-v2` branch. All changes specific to the new website should be merged into this branch.

- The `master` branch is still tracking content for the currently active Ozone website. `master` and `HDDS-9225-website-v2` will remain separate until the new website is ready to be deployed.

- The `asf-site` branch is still holding build artifacts being used to deploy content from the `master` branch. The new website is not being hosted anywhere, but can be previewed locally.

## Local Development

Docusaurus supports previewing the website locally. Below are various options to launch a preview of the site at `localhost:3000` on your machine.

### Option 1: Docker (Recommended)

The project includes a `Dockerfile` and a `compose.yml` file to build and run the website in a containerized environment. This creates a docker image called `ozone-site-dev` with all the dependencies included, and uses it to run the [Docusaurus development server](https://docusaurus.io/docs/installation#running-the-development-server).

1. Install [docker](https://docs.docker.com/engine/install/).

2. Install [docker compose](https://docs.docker.com/compose/install/).

3. Run `docker compose up` from the repository root.

4. Preview the website at `localhost:3000` in your browser.

  - Any changes made in the repository will be reflected in the preview.

5. Press `Ctrl+C` or run `docker compose down` to stop the preview.

### Option 2: pnpm

Build and run the website locally with the `pnpm` package manager.

1. Install [pnpm](https://pnpm.io/installation), which will be used to build the site.

2. Install dependencies required to build the website by running `pnpm install` at the website root.

- [**Development Server**](https://docusaurus.io/docs/installation#running-the-development-server): This option will start the Docusaurus development server, which allows updates to website files to be displayed in the browser in real time. It will not produce a `build` directory with build artifacts.

  1. Run `pnpm start` from the repository root to start the development server.

  2. Preview the website at `localhost:3000` in your browser.

  3. Press `Ctrl+C` to stop the preview.

- [**Local Build**](https://docusaurus.io/docs/installation#build): This option will do a production build, putting artifacts in the `build` directory. This can still be previewed locally, but will not automatically reflect changes to website files.

  1. Run `pnpm build` from the repository root to build the content.

  2. Run `pnpm serve` to preview the built website locally.

  3. Preview the website at `localhost:3000` in your browser.

  4. Press `Ctrl+C` to stop the preview.

### Updating the Website

The following files can be modified to change various aspects of the website:

- `docusaurus.config.js`
  - The main configuration file for the docusaurus site.
  - See https://docusaurus.io/docs/configuration

- `sidebars.js`
  - Configuration of the documentation menu sidebars.
  - This file should not need to be modified since the menu will be auto-generated from the directory and file layout.
  - See https://docusaurus.io/docs/sidebar/autogenerated

- `static`
  - Contains non-code files that are directly copied to the build output.
  - See https://docusaurus.io/docs/static-assets
  - `static/img`
    - Directory for all images needed to build the site.

- `docs`
  - Documentation pages.
  - See https://docusaurus.io/docs/create-doc

- `src/pages`
  - Static pages outside of the documentation section.
  - See https://docusaurus.io/docs/creating-pages