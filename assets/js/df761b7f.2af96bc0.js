"use strict";(self.webpackChunkdoc_site=self.webpackChunkdoc_site||[]).push([[5660],{4913:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>m,frontMatter:()=>o,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"system-internals/features/filesystem-optimization","title":"File System Optimization (FSO) System Internals","description":"The prefix-based File System Optimization feature supports atomic rename and delete of any directory at any level in the","source":"@site/docs/07-system-internals/07-features/01-filesystem-optimization.md","sourceDirName":"07-system-internals/07-features","slug":"/system-internals/features/filesystem-optimization","permalink":"/docs/system-internals/features/filesystem-optimization","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/ozone-site/tree/HDDS-9225-website-v2/docs/07-system-internals/07-features/01-filesystem-optimization.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_label":"Filesystem Optimization (FSO)"},"sidebar":"defaultSidebar","previous":{"title":"Features","permalink":"/docs/system-internals/features/"},"next":{"title":"Upgrade and Downgrade","permalink":"/docs/system-internals/features/upgrade-downgrade"}}');var a=i(86070),r=i(62392);const o={sidebar_label:"Filesystem Optimization (FSO)"},s="File System Optimization (FSO) System Internals",l={},d=[{value:"OzoneManager Metadata layout format",id:"ozonemanager-metadata-layout-format",level:2},{value:"Directory delete operation with prefix layout",id:"directory-delete-operation-with-prefix-layout",level:3},{value:"Directory rename operation with prefix layout",id:"directory-rename-operation-with-prefix-layout",level:3},{value:"Configuration",id:"configuration",level:2}];function c(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"file-system-optimization-fso-system-internals",children:"File System Optimization (FSO) System Internals"})}),"\n",(0,a.jsx)(t.p,{children:"The prefix-based File System Optimization feature supports atomic rename and delete of any directory at any level in the\nnamespace in deterministic/constant time."}),"\n",(0,a.jsxs)(t.p,{children:["This feature can be enabled for each specific bucket that requires it by setting the ",(0,a.jsx)(t.code,{children:"--layout"})," flag\nto ",(0,a.jsx)(t.code,{children:"FILE_SYSTEM_OPTIMIZED"})," at the time of bucket creation."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-bash",children:"ozone sh bucket create /<volume-name>/<bucket-name> --layout FILE_SYSTEM_OPTIMIZED\n"})}),"\n",(0,a.jsx)(t.p,{children:"Note: File System Optimization favors Hadoop Compatible File System instead of S3 compatibility. Some irregular S3 key\nnames may be rejected or normalized."}),"\n",(0,a.jsx)(t.p,{children:"This feature is strongly recommended to be turned ON for Ozone buckets mainly used via Hadoop compatible interfaces,\nespecially with high number of files in deep directory hierarchy."}),"\n",(0,a.jsx)(t.h2,{id:"ozonemanager-metadata-layout-format",children:"OzoneManager Metadata layout format"}),"\n",(0,a.jsx)(t.p,{children:"OzoneManager supports two metadata bucket layout formats - Object Store (OBS) and File System Optimized (FSO)."}),"\n",(0,a.jsxs)(t.p,{children:["Object Store (OBS) is the existing OM metadata format, which stores key entry with full path name. In File System\nOptimized (FSO) buckets, OM metadata format stores intermediate directories into ",(0,a.jsx)(t.code,{children:"DirectoryTable"})," and files\ninto ",(0,a.jsx)(t.code,{children:"FileTable"})," as shown in the below picture. The key to the table is the name of a directory or a file prefixed by\nthe unique identifier of its parent directory, ",(0,a.jsx)(t.code,{children:"<parent unique-id>/<filename>"}),"."]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Prefix FSO Format",src:i(66633).A+"",width:"1830",height:"880"})}),"\n",(0,a.jsx)(t.h3,{id:"directory-delete-operation-with-prefix-layout",children:"Directory delete operation with prefix layout"}),"\n",(0,a.jsx)(t.p,{children:"Following picture describes the OM metadata changes while performing a delete\noperation on a directory."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Prefix FSO Delete",src:i(93489).A+"",width:"1784",height:"916"})}),"\n",(0,a.jsx)(t.h3,{id:"directory-rename-operation-with-prefix-layout",children:"Directory rename operation with prefix layout"}),"\n",(0,a.jsx)(t.p,{children:"Following picture describes the OM metadata changes while performing a rename\noperation on a directory."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Prefix FSO Rename",src:i(82838).A+"",width:"1770",height:"904"})}),"\n",(0,a.jsx)(t.h2,{id:"configuration",children:"Configuration"}),"\n",(0,a.jsxs)(t.p,{children:["The following configuration can be configured in ",(0,a.jsx)(t.code,{children:"ozone-site.xml"})," to define the default value for bucket layout during bucket creation\nif the client has not specified the bucket layout argument.\nSupported values are ",(0,a.jsx)(t.code,{children:"OBJECT_STORE"}),", ",(0,a.jsx)(t.code,{children:"FILE_SYSTEM_OPTIMIZED"})," and ",(0,a.jsx)(t.code,{children:"LEGACY"}),"."]}),"\n",(0,a.jsxs)(t.p,{children:["By default, this config value is empty. Ozone will default to ",(0,a.jsx)(t.code,{children:"FILE_SYSTEM_OPTIMIZED"})," bucket layout if it finds an empty config value."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-xml",children:"<property>\n    <name>ozone.default.bucket.layout</name>\n    <value/>\n</property>\n"})})]})}function m(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},62392:(e,t,i)=>{i.d(t,{R:()=>o,x:()=>s});var n=i(30758);const a={},r=n.createContext(a);function o(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),n.createElement(r.Provider,{value:t},e.children)}},66633:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/PrefixFSO-Format-e3d29291d2e8ccb2767bb25d56d382a1.png"},82838:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/PrefixFSO-Rename-daa685e54c515e7ab4aaa194d4497062.png"},93489:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/PrefixFSO-Delete-829a8d2b097fb698106e432f9d35d132.png"}}]);