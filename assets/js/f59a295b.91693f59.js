"use strict";(self.webpackChunkdoc_site=self.webpackChunkdoc_site||[]).push([[67160],{53883:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>u,frontMatter:()=>c,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"core-concepts/namespace/buckets/layouts/object-store","title":"Object Store Buckets (OBS)","description":"1. Overview","source":"@site/docs/03-core-concepts/03-namespace/02-buckets/04-layouts/01-object-store.md","sourceDirName":"03-core-concepts/03-namespace/02-buckets/04-layouts","slug":"/core-concepts/namespace/buckets/layouts/object-store","permalink":"/docs/next/core-concepts/namespace/buckets/layouts/object-store","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/ozone-site/tree/master/docs/03-core-concepts/03-namespace/02-buckets/04-layouts/01-object-store.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_label":"Object Store (OBS)"},"sidebar":"defaultSidebar","previous":{"title":"Layouts","permalink":"/docs/next/core-concepts/namespace/buckets/layouts/"},"next":{"title":"File System Optimized (FSO)","permalink":"/docs/next/core-concepts/namespace/buckets/layouts/file-system-optimized"}}');var s=n(86070),o=n(62392);const c={sidebar_label:"Object Store (OBS)"},r="Object Store Buckets (OBS)",l={},a=[{value:"1. Overview",id:"1-overview",level:2},{value:"2. How It Works",id:"2-how-it-works",level:2},{value:"Example: Creating Keys",id:"example-creating-keys",level:3},{value:"3. Command Line Operations",id:"3-command-line-operations",level:2},{value:"Creating an Object Store Bucket",id:"creating-an-object-store-bucket",level:3},{value:"Checking Bucket Layout",id:"checking-bucket-layout",level:3},{value:"Deleting Keys",id:"deleting-keys",level:3},{value:"Deleting Buckets",id:"deleting-buckets",level:3},{value:"4. Configuration",id:"4-configuration",level:2},{value:"Default Bucket Layout",id:"default-bucket-layout",level:3},{value:"S3 Gateway Default Layout",id:"s3-gateway-default-layout",level:3},{value:"5. Limitations",id:"5-limitations",level:2},{value:"6. Best Practices",id:"6-best-practices",level:2}];function d(e){const t={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"object-store-buckets-obs",children:"Object Store Buckets (OBS)"})}),"\n",(0,s.jsx)(t.h2,{id:"1-overview",children:"1. Overview"}),"\n",(0,s.jsxs)(t.p,{children:["Object Store bucket layout stores keys with their full path names in a flat namespace, optimized for S3-compatible access patterns. Each key is stored independently with its complete path (e.g., ",(0,s.jsx)(t.code,{children:"dir1/dir2/file.txt"}),"), similar to Amazon S3."]}),"\n",(0,s.jsx)(t.p,{children:"Unlike File System Optimized (FSO) buckets, Object Store buckets:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Do not create intermediate directory entries"}),"\n",(0,s.jsx)(t.li,{children:"Preserve key names exactly as provided (no path normalization)"}),"\n",(0,s.jsx)(t.li,{children:"Prioritize S3 API compatibility over file system semantics"}),"\n"]}),"\n",(0,s.jsxs)(t.admonition,{type:"note",children:[(0,s.jsx)(t.p,{children:"Apache Ozone supports three bucket layout types:"}),(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"OBJECT_STORE (OBS)"}),", ",(0,s.jsx)(t.strong,{children:"FILE_SYSTEM_OPTIMIZED (FSO)"})," and ",(0,s.jsx)(t.strong,{children:"LEGACY"})," (deprecated layout for backward compatibility)."]}),"\n"]})]}),"\n",(0,s.jsx)(t.h2,{id:"2-how-it-works",children:"2. How It Works"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Keys are stored with their full path names as single entries. When creating ",(0,s.jsx)(t.code,{children:"dir1/dir2/file.txt"}),", only the key itself is stored\u2014no intermediate directories are created."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"Operations support prefix-based listing and filtering. Keys are independent objects\u2014deleting one does not affect others, even if they share a common prefix."}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Object Store is the ",(0,s.jsx)(t.strong,{children:"default layout"})," for buckets created through the ",(0,s.jsx)(t.strong,{children:"S3 Gateway"}),", ensuring S3 API compatibility."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.h3,{id:"example-creating-keys",children:"Example: Creating Keys"}),"\n",(0,s.jsx)(t.p,{children:"When you create keys in an Object Store bucket:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"# Create these keys:\nozone sh key put /myvolume/mybucket/images/photo1.jpg photo1.jpg\nozone sh key put /myvolume/mybucket/images/subfolder/photo3.jpg photo3.jpg\nozone sh key put /myvolume/mybucket/data/2024/01/report.json report.json\n"})}),"\n",(0,s.jsx)(t.p,{children:"The KeyTable will contain three independent entries:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.code,{children:"/myvolume/mybucket/images/photo1.jpg"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.code,{children:"/myvolume/mybucket/images/subfolder/photo3.jpg"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.code,{children:"/myvolume/mybucket/data/2024/01/report.json"})}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"No intermediate directories are created"})," - the paths (",(0,s.jsx)(t.code,{children:"images/"}),", ",(0,s.jsx)(t.code,{children:"images/subfolder/"}),", ",(0,s.jsx)(t.code,{children:"data/2024/01/"}),") are just part of the key names themselves."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"Comparison with File System Optimized Layout:"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-text",children:"Object Store (OBS) Structure:          File System Optimized (FSO) Structure:\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510            \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502      KeyTable           \u2502            \u2502    DirectoryTable       \u2502\n\u2502  (Flat, full paths)     \u2502            \u2502  (Hierarchical IDs)     \u2502\n\u2502                         \u2502            \u2502                         \u2502\n\u2502 /vol/bucket/dir/file    \u2502            \u2502 /volID/bucketID/dirID   \u2502\n\u2502 /vol/bucket/dir/file2   \u2502            \u2502 /volID/bucketID/dir2ID  \u2502\n\u2502 /vol/bucket/dir2/file3  \u2502            \u2502                         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518            \u2502      FileTable          \u2502\n                                       \u2502  (Files with parent IDs) \u2502\n                                       \u2502                         \u2502\n                                       \u2502 dirID/file              \u2502\n                                       \u2502 dirID/file2             \u2502\n                                       \u2502 dir2ID/file3            \u2502\n                                       \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,s.jsx)(t.h2,{id:"3-command-line-operations",children:"3. Command Line Operations"}),"\n",(0,s.jsx)(t.h3,{id:"creating-an-object-store-bucket",children:"Creating an Object Store Bucket"}),"\n",(0,s.jsxs)(t.p,{children:["To create a bucket with Object Store layout, use the ",(0,s.jsx)(t.code,{children:"--layout"})," option with the value ",(0,s.jsx)(t.code,{children:"obs"})," or ",(0,s.jsx)(t.code,{children:"OBJECT_STORE"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"# Using short form 'obs'\nozone sh bucket create /myvolume/mybucket --layout obs\n\n# Using full form 'OBJECT_STORE'\nozone sh bucket create /myvolume/mybucket --layout OBJECT_STORE\n"})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"Example:"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"$ ozone sh bucket create /s3v/myapp-data --layout obs\nBucket myapp-data is created\n"})}),"\n",(0,s.jsx)(t.h3,{id:"checking-bucket-layout",children:"Checking Bucket Layout"}),"\n",(0,s.jsxs)(t.p,{children:["To verify the layout of an existing bucket, use the ",(0,s.jsx)(t.code,{children:"bucket info"})," command:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"ozone sh bucket info /myvolume/mybucket\n"})}),"\n",(0,s.jsxs)(t.p,{children:["The output will include the ",(0,s.jsx)(t.code,{children:"bucketLayout"})," field:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-json",children:'{\n  "volumeName" : "myvolume",\n  "name" : "mybucket",\n  "bucketLayout" : "OBJECT_STORE",\n  "storageType" : "DISK",\n  "versioning" : false,\n  "creationTime" : "2024-01-15T10:30:00.000Z",\n  "modificationTime" : "2024-01-15T10:30:00.000Z"\n}\n'})}),"\n",(0,s.jsx)(t.h3,{id:"deleting-keys",children:"Deleting Keys"}),"\n",(0,s.jsx)(t.p,{children:"Delete keys from an Object Store bucket:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"# Delete a single key\nozone sh key delete /myvolume/mybucket/dir1/dir2/file.txt\n\n# Delete multiple keys (requires prefix matching)\nozone sh key delete /myvolume/mybucket/dir1/ --recursive\n"})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Note"}),": The ",(0,s.jsx)(t.code,{children:"--recursive"})," flag deletes all keys with the specified prefix, but this is not an atomic operation - it deletes keys one by one."]}),"\n",(0,s.jsx)(t.h3,{id:"deleting-buckets",children:"Deleting Buckets"}),"\n",(0,s.jsx)(t.p,{children:"Delete an Object Store bucket:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"# Delete empty bucket\nozone sh bucket delete /myvolume/mybucket\n\n# Delete bucket with all keys (recursive)\nozone sh bucket delete /myvolume/mybucket --recursive\n"})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Warning"}),": Recursive deletion permanently removes all keys in the bucket. There is no recovery option."]}),"\n",(0,s.jsx)(t.h2,{id:"4-configuration",children:"4. Configuration"}),"\n",(0,s.jsx)(t.h3,{id:"default-bucket-layout",children:"Default Bucket Layout"}),"\n",(0,s.jsxs)(t.p,{children:["You can configure the default bucket layout used when creating buckets without specifying the ",(0,s.jsx)(t.code,{children:"--layout"})," option. Set this in ",(0,s.jsx)(t.code,{children:"ozone-site.xml"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-xml",children:"<property>\n  <name>ozone.default.bucket.layout</name>\n  <value>OBJECT_STORE</value>\n</property>\n"})}),"\n",(0,s.jsx)(t.h3,{id:"s3-gateway-default-layout",children:"S3 Gateway Default Layout"}),"\n",(0,s.jsx)(t.p,{children:"For buckets created through the S3 Gateway, configure the default layout:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-xml",children:"<property>\n  <name>ozone.s3g.default.bucket.layout</name>\n  <value>OBJECT_STORE</value>\n</property>\n"})}),"\n",(0,s.jsx)(t.h2,{id:"5-limitations",children:"5. Limitations"}),"\n",(0,s.jsx)(t.p,{children:"When using Object Store bucket layout, be aware of the following limitations:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"No atomic rename (copy and delete required)"}),"\n",(0,s.jsx)(t.li,{children:"No atomic directory delete"}),"\n",(0,s.jsx)(t.li,{children:"No directory operations (directories are part of key names)"}),"\n",(0,s.jsx)(t.li,{children:"Limited Hadoop file system compatibility"}),"\n",(0,s.jsx)(t.li,{children:"No path normalization"}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"6-best-practices",children:"6. Best Practices"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Use Object Store layout for S3 APIs; use FSO for file system operations"}),"\n",(0,s.jsxs)(t.li,{children:["Organize keys with consistent prefixes (e.g., ",(0,s.jsx)(t.code,{children:"year/month/day/file.txt"}),")"]}),"\n"]})]})}function u(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},62392:(e,t,n)=>{n.d(t,{R:()=>c,x:()=>r});var i=n(30758);const s={},o=i.createContext(s);function c(e){const t=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),i.createElement(o.Provider,{value:t},e.children)}}}]);