"use strict";(self.webpackChunkdoc_site=self.webpackChunkdoc_site||[]).push([[48675],{54568:(e,r,s)=>{s.r(r),s.d(r,{assets:()=>c,contentTitle:()=>o,default:()=>l,frontMatter:()=>d,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"administrator-guide/configuration/security/kerberos","title":"Configuring Kerberos","description":"Ozone depends on Kerberos to make the clusters secure. Historically, HDFS has supported running in an isolated secure networks where it is possible to deploy without securing the cluster.","source":"@site/docs/05-administrator-guide/02-configuration/03-security/02-kerberos.md","sourceDirName":"05-administrator-guide/02-configuration/03-security","slug":"/administrator-guide/configuration/security/kerberos","permalink":"/docs/next/administrator-guide/configuration/security/kerberos","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/ozone-site/tree/master/docs/05-administrator-guide/02-configuration/03-security/02-kerberos.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_label":"Kerberos"},"sidebar":"defaultSidebar","previous":{"title":"Administrators","permalink":"/docs/next/administrator-guide/configuration/security/administrators"},"next":{"title":"HTTPS","permalink":"/docs/next/administrator-guide/configuration/security/https"}}');var n=s(86070),i=s(62392);const d={sidebar_label:"Kerberos"},o="Configuring Kerberos",c={},a=[{value:"Storage Container Manager",id:"storage-container-manager",level:2},{value:"Ozone Manager",id:"ozone-manager",level:2},{value:"S3 Gateway",id:"s3-gateway",level:2},{value:"HttpFS Gateway",id:"httpfs-gateway",level:2},{value:"Recon Server",id:"recon-server",level:2},{value:"Securing Datanodes",id:"securing-datanodes",level:2}];function h(e){const r={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",p:"p",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.header,{children:(0,n.jsx)(r.h1,{id:"configuring-kerberos",children:"Configuring Kerberos"})}),"\n",(0,n.jsxs)(r.p,{children:["Ozone depends on ",(0,n.jsx)(r.a,{href:"https://web.mit.edu/kerberos/",children:"Kerberos"})," to make the clusters secure. Historically, HDFS has supported running in an isolated secure networks where it is possible to deploy without securing the cluster."]}),"\n",(0,n.jsxs)(r.p,{children:["This release of Ozone follows that model, but soon will move to ",(0,n.jsx)(r.em,{children:"secure by default."})," Today to enable security in Ozone cluster, we need to set the configuration ",(0,n.jsx)(r.code,{children:"ozone.security.enabled"})," to ",(0,n.jsx)(r.code,{children:"true"})," and ",(0,n.jsx)(r.code,{children:"hadoop.security.authentication"})," to ",(0,n.jsx)(r.code,{children:"kerberos"}),"."]}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"Property"}),(0,n.jsx)(r.th,{children:"Value"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"ozone.security.enabled"})}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"true"})})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"hadoop.security.authentication"})}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"kerberos"})})]})]})]}),"\n",(0,n.jsx)(r.h2,{id:"storage-container-manager",children:"Storage Container Manager"}),"\n",(0,n.jsx)(r.p,{children:"SCM requires two Kerberos principals, and the corresponding key tab files for both of these principals."}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"Property"}),(0,n.jsx)(r.th,{children:"Description"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"hdds.scm.kerberos.principal"})}),(0,n.jsxs)(r.td,{children:["The SCM service principal. e.g. ",(0,n.jsx)(r.code,{children:"scm/_HOST@REALM.COM"})]})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"hdds.scm.kerberos.keytab.file"})}),(0,n.jsx)(r.td,{children:"The keytab file used by SCM daemon to login as its service principal."})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"hdds.scm.http.auth.kerberos.principal"})}),(0,n.jsx)(r.td,{children:"SCM HTTP server service principal if SPNEGO is enabled for SCM HTTP server."})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"hdds.scm.http.auth.kerberos.keytab"})}),(0,n.jsx)(r.td,{children:"The keytab file used by SCM HTTP server to login as its service principal if SPNEGO is enabled for SCM HTTP server."})]})]})]}),"\n",(0,n.jsx)(r.admonition,{type:"note",children:(0,n.jsxs)(r.p,{children:["For general configuration on enabling Kerberos based SPNEGO authentication for HTTP web-consoles, refer to ",(0,n.jsx)(r.a,{href:"/docs/next/administrator-guide/configuration/security/https",children:"Configuring HTTP authentication using Kerberos SPNEGO"}),"."]})}),"\n",(0,n.jsx)(r.h2,{id:"ozone-manager",children:"Ozone Manager"}),"\n",(0,n.jsx)(r.p,{children:"Like SCM, OM also requires two Kerberos principals, and the corresponding key tab files for both of these principals."}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"Property"}),(0,n.jsx)(r.th,{children:"Description"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"ozone.om.kerberos.principal"})}),(0,n.jsxs)(r.td,{children:["The OzoneManager service principal. e.g. ",(0,n.jsx)(r.code,{children:"om/_HOST@REALM.COM"})]})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"ozone.om.kerberos.keytab.file"})}),(0,n.jsx)(r.td,{children:"The keytab file used by OM daemon to login as its service principal."})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"ozone.om.http.auth.kerberos.principal"})}),(0,n.jsx)(r.td,{children:"Ozone Manager HTTP server service principal if SPNEGO is enabled for OM HTTP server."})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"ozone.om.http.auth.kerberos.keytab"})}),(0,n.jsx)(r.td,{children:"The keytab file used by OM HTTP server to login as its service principal if SPNEGO is enabled for OM HTTP server."})]})]})]}),"\n",(0,n.jsx)(r.h2,{id:"s3-gateway",children:"S3 Gateway"}),"\n",(0,n.jsxs)(r.p,{children:["S3 Gateway requires one service principal and here the configuration values needed in the ",(0,n.jsx)(r.code,{children:"ozone-site.xml"}),"."]}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"Property"}),(0,n.jsx)(r.th,{children:"Description"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"ozone.s3g.kerberos.principal"})}),(0,n.jsxs)(r.td,{children:["S3 Gateway principal. e.g. ",(0,n.jsx)(r.code,{children:"s3g/_HOST@REALM"})]})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"ozone.s3g.kerberos.keytab.file"})}),(0,n.jsxs)(r.td,{children:["The keytab file used by S3 Gateway. e.g. ",(0,n.jsx)(r.code,{children:"/etc/security/keytabs/s3g.keytab"})]})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"ozone.s3g.http.auth.kerberos.principal"})}),(0,n.jsxs)(r.td,{children:["S3 Gateway principal if SPNEGO is enabled for S3 Gateway HTTP server. e.g. ",(0,n.jsx)(r.code,{children:"HTTP/_HOST@EXAMPLE.COM"})]})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"ozone.s3g.http.auth.kerberos.keytab"})}),(0,n.jsx)(r.td,{children:"The keytab file used by S3 Gateway if SPNEGO is enabled for S3 Gateway HTTP server."})]})]})]}),"\n",(0,n.jsx)(r.h2,{id:"httpfs-gateway",children:"HttpFS Gateway"}),"\n",(0,n.jsxs)(r.p,{children:["The HttpFS gateway offers an HDFS-compatible REST API (",(0,n.jsx)(r.code,{children:"webhdfs"}),"). It requires Kerberos for its client-facing HTTP endpoint and for its internal connection to the Ozone Manager (which acts as an HDFS NameNode proxy)."]}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"Property"}),(0,n.jsx)(r.th,{children:"Description"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"hadoop.http.authentication.type"})}),(0,n.jsxs)(r.td,{children:["Defines the authentication mechanism used by HttpFS for its HTTP clients. Valid values are ",(0,n.jsx)(r.code,{children:"simple"})," or ",(0,n.jsx)(r.code,{children:"kerberos"}),". Set to ",(0,n.jsx)(r.code,{children:"kerberos"})," for SPNEGO."]})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"hadoop.http.authentication.kerberos.principal"})}),(0,n.jsxs)(r.td,{children:["The HTTP Kerberos principal used by HttpFS for its client-facing HTTP endpoint. This MUST start with ",(0,n.jsx)(r.code,{children:"HTTP/"})," (e.g., ",(0,n.jsx)(r.code,{children:"HTTP/${httpfs.hostname}@${kerberos.realm}"}),")."]})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"hadoop.http.authentication.kerberos.keytab"})}),(0,n.jsxs)(r.td,{children:["The Kerberos keytab file for the client-facing HTTP principal. e.g., ",(0,n.jsx)(r.code,{children:"${user.home}/httpfs.keytab"}),"."]})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"httpfs.hadoop.authentication.type"})}),(0,n.jsxs)(r.td,{children:["Defines the authentication mechanism used by HttpFS to connect to the HDFS NameNode (Ozone Manager). Valid values are ",(0,n.jsx)(r.code,{children:"simple"})," (default) or ",(0,n.jsx)(r.code,{children:"kerberos"}),"."]})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"httpfs.hadoop.authentication.kerberos.principal"})}),(0,n.jsxs)(r.td,{children:["The Kerberos principal used by HttpFS to connect to the HDFS NameNode (Ozone Manager). e.g., ",(0,n.jsx)(r.code,{children:"${user.name}/${httpfs.hostname}@${kerberos.realm}"}),"."]})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"httpfs.hadoop.authentication.kerberos.keytab"})}),(0,n.jsxs)(r.td,{children:["The Kerberos keytab file for the principal used to connect to the HDFS NameNode (Ozone Manager). e.g., ",(0,n.jsx)(r.code,{children:"${user.home}/httpfs.keytab"}),"."]})]})]})]}),"\n",(0,n.jsx)(r.h2,{id:"recon-server",children:"Recon Server"}),"\n",(0,n.jsx)(r.p,{children:"Recon provides monitoring and management capabilities and can be secured using Kerberos authentication for its web UI and REST endpoints."}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"Property"}),(0,n.jsx)(r.th,{children:"Description"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"ozone.recon.http.auth.type"})}),(0,n.jsxs)(r.td,{children:["Sets Recon's HTTP authentication type. Set to ",(0,n.jsx)(r.code,{children:"kerberos"})," for SPNEGO."]})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"ozone.recon.http.auth.kerberos.principal"})}),(0,n.jsxs)(r.td,{children:["The service principal for the Recon HTTP endpoint. e.g., ",(0,n.jsx)(r.code,{children:"HTTP/_HOST@REALM"}),"."]})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"ozone.recon.http.auth.kerberos.keytab"})}),(0,n.jsxs)(r.td,{children:["The keytab file for the Recon HTTP principal. e.g., ",(0,n.jsx)(r.code,{children:"/path/to/HTTP.keytab"}),"."]})]})]})]}),"\n",(0,n.jsxs)(r.p,{children:["Access to Recon's admin-only APIs is controlled by ",(0,n.jsx)(r.code,{children:"ozone.administrators"})," or ",(0,n.jsx)(r.code,{children:"ozone.recon.administrators"})," lists. Refer to ",(0,n.jsx)(r.a,{href:"/docs/administrator-guide/configuration/security/administrators",children:"Configuring Ozone Administrators"})," for more details."]}),"\n",(0,n.jsx)(r.h2,{id:"securing-datanodes",children:"Securing Datanodes"}),"\n",(0,n.jsx)(r.p,{children:"Datanodes under Hadoop is traditionally secured by creating a Keytab file on the Datanodes. With Ozone, we have moved away to using Datanode certificates. That is, Kerberos on Datanodes is not needed in case of a secure Ozone cluster."}),"\n",(0,n.jsxs)(r.p,{children:["However, we support the legacy Kerberos based Authentication to make it easy for the current set of users. The HDFS configuration keys are the following that is setup in ",(0,n.jsx)(r.code,{children:"hdfs-site.xml"}),"."]}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"Property"}),(0,n.jsx)(r.th,{children:"Description"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"dfs.datanode.kerberos.principal"})}),(0,n.jsxs)(r.td,{children:["The Datanode service principal. e.g. ",(0,n.jsx)(r.code,{children:"dn/_HOST@REALM.COM"})]})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"dfs.datanode.kerberos.keytab.file"})}),(0,n.jsx)(r.td,{children:"The keytab file used by Datanode daemon to login as its service principal."})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"hdds.datanode.http.auth.kerberos.principal"})}),(0,n.jsx)(r.td,{children:"Datanode HTTP server service principal."})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"hdds.datanode.http.auth.kerberos.keytab"})}),(0,n.jsx)(r.td,{children:"The keytab file used by Datanode HTTP server to login as its service principal."})]})]})]})]})}function l(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(h,{...e})}):h(e)}},62392:(e,r,s)=>{s.d(r,{R:()=>d,x:()=>o});var t=s(30758);const n={},i=t.createContext(n);function d(e){const r=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function o(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:d(e.components),t.createElement(i.Provider,{value:r},e.children)}}}]);