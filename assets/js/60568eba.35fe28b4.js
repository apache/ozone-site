"use strict";(self.webpackChunkdoc_site=self.webpackChunkdoc_site||[]).push([[306],{62392:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>a});var t=i(30758);const o={},r=t.createContext(o);function s(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),t.createElement(r.Provider,{value:n},e.children)}},94738:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>c,frontMatter:()=>s,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"administrator-guide/configuration/logging/audit-logs","title":"Configuring Audit Logs","description":"Audit logs record security-sensitive operations, providing a trail of actions performed on the cluster. The following services produce audit logs:","source":"@site/docs/05-administrator-guide/02-configuration/02-logging/02-audit-logs.md","sourceDirName":"05-administrator-guide/02-configuration/02-logging","slug":"/administrator-guide/configuration/logging/audit-logs","permalink":"/docs/administrator-guide/configuration/logging/audit-logs","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/ozone-site/tree/HDDS-9225-website-v2/docs/05-administrator-guide/02-configuration/02-logging/02-audit-logs.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_label":"Audit Logs"},"sidebar":"defaultSidebar","previous":{"title":"Application Logs","permalink":"/docs/administrator-guide/configuration/logging/application-logs"},"next":{"title":"Security","permalink":"/docs/administrator-guide/configuration/security/"}}');var o=i(86070),r=i(62392);const s={sidebar_label:"Audit Logs"},a="Configuring Audit Logs",l={},d=[{value:"Sample Audit Log Entry",id:"sample-audit-log-entry",level:2},{value:"Deletion of Audit Logs",id:"deletion-of-audit-logs",level:2}];function g(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"configuring-audit-logs",children:"Configuring Audit Logs"})}),"\n",(0,o.jsx)(n.p,{children:"Audit logs record security-sensitive operations, providing a trail of actions performed on the cluster. The following services produce audit logs:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Ozone Manager"}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Storage Container Manager"}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Datanode"}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"S3 Gateway"}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["Audit log configurations are set in ",(0,o.jsx)(n.code,{children:"*-audit-log4j2.properties"})," files. You can change the corresponding files to update the audit log policies for each component."]}),"\n",(0,o.jsx)(n.h2,{id:"sample-audit-log-entry",children:"Sample Audit Log Entry"}),"\n",(0,o.jsx)(n.p,{children:"Here is an example of an audit log entry from the Ozone Manager:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-text",children:"INFO  | OMAudit | ? | user=hdfs | ip=127.0.0.1 | op=CREATE_VOLUME | params={volume=vol1, admin=hdfs, owner=hdfs} | result=SUCCESS\n"})}),"\n",(0,o.jsxs)(n.p,{children:["This entry shows that the user ",(0,o.jsx)(n.code,{children:"hdfs"})," successfully created a volume named ",(0,o.jsx)(n.code,{children:"vol1"}),"."]}),"\n",(0,o.jsx)(n.h2,{id:"deletion-of-audit-logs",children:"Deletion of Audit Logs"}),"\n",(0,o.jsx)(n.p,{children:"The default log appender is a rolling appender. The following configurations can be added for the deletion of out-of-date AuditLogs."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-properties",children:"appender.rolling.strategy.type=DefaultRolloverStrategy\n\nappender.rolling.strategy.max=3000\n\nappender.rolling.strategy.delete.type=Delete\n\nappender.rolling.strategy.delete.basePath=${sys:hadoop.log.dir}\n\nappender.rolling.strategy.delete.maxDepth=1\n\nappender.rolling.strategy.delete.ifFileName.type=IfFileName\n\nappender.rolling.strategy.delete.ifFileName.glob=om-audit-*.log.gz\n\nappender.rolling.strategy.delete.ifLastModified.type=IfLastModified\n\nappender.rolling.strategy.delete.ifLastModified.age=30d\n"})}),"\n",(0,o.jsxs)(n.p,{children:["For more details, please check ",(0,o.jsx)(n.a,{href:"https://logging.apache.org/log4j/2.x/manual/appenders.html#CustomDeleteOnRollover",children:"Log4j2 Delete on Rollover"}),"."]})]})}function c(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(g,{...e})}):g(e)}}}]);