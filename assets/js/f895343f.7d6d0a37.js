"use strict";(self.webpackChunkdoc_site=self.webpackChunkdoc_site||[]).push([[2033],{48637:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"core-concepts/namespace/volumes/owners","title":"Volume Owners","description":"1. Overview","source":"@site/versioned_docs/version-2.1.0/03-core-concepts/03-namespace/01-volumes/02-owners.md","sourceDirName":"03-core-concepts/03-namespace/01-volumes","slug":"/core-concepts/namespace/volumes/owners","permalink":"/docs/core-concepts/namespace/volumes/owners","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/ozone-site/tree/master/versioned_docs/version-2.1.0/03-core-concepts/03-namespace/01-volumes/02-owners.md","tags":[],"version":"2.1.0","sidebarPosition":2,"frontMatter":{"sidebar_label":"Owners"},"sidebar":"defaultSidebar","previous":{"title":"Overview","permalink":"/docs/core-concepts/namespace/volumes/overview"},"next":{"title":"Quotas","permalink":"/docs/core-concepts/namespace/volumes/quotas"}}');var r=o(86070),i=o(62392);const t={sidebar_label:"Owners"},l="Volume Owners",a={},c=[{value:"1. Overview",id:"1-overview",level:2},{value:"2. Setting the Volume Owner",id:"2-setting-the-volume-owner",level:2},{value:"During Volume Creation",id:"during-volume-creation",level:3},{value:"Changing Volume Ownership",id:"changing-volume-ownership",level:3},{value:"3. Volume Owner Privileges",id:"3-volume-owner-privileges",level:2},{value:"Bypass ACL Checks",id:"bypass-acl-checks",level:3},{value:"Volume Deletion by Owner",id:"volume-deletion-by-owner",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"volume-owners",children:"Volume Owners"})}),"\n",(0,r.jsx)(n.h2,{id:"1-overview",children:"1. Overview"}),"\n",(0,r.jsxs)(n.p,{children:["Every volume in Ozone has an ",(0,r.jsx)(n.strong,{children:"owner"})," property that identifies the user who owns the volume. The volume owner is a fundamental concept in Ozone's access control and resource management system. It plays a crucial role in determining permissions, storage accounting, and multi-tenant isolation."]}),"\n",(0,r.jsxs)(n.p,{children:["While volumes also have an ",(0,r.jsx)(n.code,{children:"admin"})," field in their metadata structure, ",(0,r.jsx)(n.strong,{children:"with Native ACLs"})," (",(0,r.jsx)(n.code,{children:"OzoneNativeAuthorizer"}),"), this field is stored but not functionally used by Ozone Manager for authorization or access control purposes. Authorization checks rely on ACLs and the volume owner instead.\nThe behavior of the ",(0,r.jsx)(n.code,{children:"admin"})," field may differ when using ",(0,r.jsx)(n.code,{children:"RangerOzoneAuthorizer"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"2-setting-the-volume-owner",children:"2. Setting the Volume Owner"}),"\n",(0,r.jsx)(n.h3,{id:"during-volume-creation",children:"During Volume Creation"}),"\n",(0,r.jsxs)(n.p,{children:["When creating a volume, the owner can be explicitly specified using the ",(0,r.jsx)(n.code,{children:"--user"})," command-line option:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'ozone sh volume create /myvolume --user alice\nozone sh volume info /myvolume\n{\n  "metadata" : { },\n  "name" : "myvolume",\n  "admin" : "om",\n  "owner" : "alice",\n  ...\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["If the ",(0,r.jsx)(n.code,{children:"--user"})," option is not provided during volume creation, Ozone automatically sets the owner to the ",(0,r.jsx)(n.strong,{children:"authenticated user identity"})," as determined by ",(0,r.jsx)(n.code,{children:"UserGroupInformation.getCurrentUser()"}),". The behavior differs based on the cluster security configuration:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Secure/Kerberos mode"}),": The owner is set to the Kerberos principal (or its short name) of the authenticated user. For example, if authenticated as Kerberos principal ",(0,r.jsx)(n.code,{children:"om@REALM"}),", the volume owner will be ",(0,r.jsx)(n.code,{children:"om"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Non-secure mode"}),": The owner is typically set to the Linux user running the CLI command. For example, if you run the command as Linux user ",(0,r.jsx)(n.code,{children:"root"}),", the volume owner will be ",(0,r.jsx)(n.code,{children:"root"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Owner defaults to authenticated user\nozone sh volume create /myvolume\n\n# secure mode kerberos authenticated user\nozone sh volume info /myvolume\n{\n  "metadata" : { },\n  "name" : "myvolume",\n  "admin" : "om",\n  "owner" : "om",\n  ...\n}\n\n# unsecure mode linux user root\nozone sh volume info /myvolume\n{\n  "metadata" : { },\n  "name" : "myvolume",\n  "admin" : "root",\n  "owner" : "root",\n  ...\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Default Behavior:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["If ",(0,r.jsx)(n.code,{children:"--user"})," is not provided, the owner defaults to the authenticated user creating the volume."]}),"\n",(0,r.jsxs)(n.li,{children:["The ",(0,r.jsx)(n.code,{children:"ozone sh volume create"})," command does not allow setting the admin user. The admin can only be set using the Ozone o3 native Java API."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example Output:"})}),"\n",(0,r.jsx)(n.p,{children:"When viewing volume information, you can see the default ACLs:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Volume created with explicit owner\n$ ozone sh volume create /myvolume --user alice\n$ ozone sh volume info /myvolume\n{\n  "name" : "myvolume",\n  "admin" : "om",\n  "owner" : "alice",\n  "acls" : [ {\n    "type" : "USER",\n    "name" : "alice",\n    "aclScope" : "ACCESS",\n    "aclList" : [ "ALL" ]\n  } ]\n}\n\n# Volume created without specifying owner (defaults to authenticated user)\n$ ozone sh volume create /myvol1\n$ ozone sh volume info /myvol1\n{\n  "name" : "myvol1",\n  "admin" : "om",\n  "owner" : "om",\n  "acls" : [ {\n    "type" : "USER",\n    "name" : "om",\n    "aclScope" : "ACCESS",\n    "aclList" : [ "ALL" ]\n  }, {\n    "type" : "GROUP",\n    "name" : "om",\n    "aclScope" : "ACCESS",\n    "aclList" : [ "READ", "LIST" ]\n  } ]\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Note:"})," While the volume owner has these default ACLs, they typically don't need them because owner privileges bypass ACL checks entirely. However, these ACLs are useful for:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Audit and compliance tracking"}),"\n",(0,r.jsx)(n.li,{children:"Documentation of intended permissions"}),"\n",(0,r.jsx)(n.li,{children:"Cases where ACLs might be evaluated before owner checks"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"changing-volume-ownership",children:"Changing Volume Ownership"}),"\n",(0,r.jsx)(n.p,{children:"The volume owner can be changed after creation using the volume update command:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'ozone sh volume update /myvolume --user bob\n{\n  "metadata" : { },\n  "name" : "myvolume",\n  "admin" : "om",\n  "owner" : "bob",\n  "quotaInBytes" : -1,\n  "quotaInNamespace" : -1,\n  "usedNamespace" : 0,\n  "creationTime" : "2026-01-25T15:12:12.922Z",\n  "modificationTime" : "2026-01-25T15:20:35.530Z",\n  "acls" : [ {\n    "type" : "USER",\n    "name" : "alice",\n    "aclScope" : "ACCESS",\n    "aclList" : [ "ALL" ],\n    "aclSet" : [ "ALL" ]\n  } ],\n  "refCount" : 0\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Requirements for Changing Ownership:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Permissions:"})," The user attempting to change ownership must have ",(0,r.jsx)(n.code,{children:"WRITE_ACL"})," permission on the volume. This ensures that only authorized users can transfer ownership."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Owner vs. ACLs:"})}),"\n",(0,r.jsxs)(n.p,{children:["Changing the volume owner via ",(0,r.jsx)(n.code,{children:"ozone sh volume update --user <new_user>"})," updates the ownership metadata but ",(0,r.jsx)(n.strong,{children:"does not automatically modify ACLs"}),". The previous owner's ACL entries remain unchanged. If you need to revoke the old owner's access entirely, you must manage ACLs separately using ACL update commands."]}),"\n",(0,r.jsx)(n.admonition,{title:"Volume-Level Operations and Permissions",type:"note",children:(0,r.jsx)(n.p,{children:"Volume-level operations with respect to permissions can differ between Native ACL and Ranger ACL implementations. The permission requirements described here are specific to Native ACLs."})}),"\n",(0,r.jsxs)(n.p,{children:["For detailed information on how permissions and operations work for both ",(0,r.jsx)(n.strong,{children:"Native ACL"})," and ",(0,r.jsx)(n.strong,{children:"Ranger ACL"}),", refer to the ",(0,r.jsx)(n.a,{href:"../../security/acls",children:"ACLs documentation"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"3-volume-owner-privileges",children:"3. Volume Owner Privileges"}),"\n",(0,r.jsxs)(n.p,{children:["The volume owner receives special privileges that provide comprehensive access to the volume and all resources within it. These privileges are enforced by Ozone's native authorizer (",(0,r.jsx)(n.code,{children:"OzoneNativeAuthorizer"}),") and bypass standard ACL checks."]}),"\n",(0,r.jsx)(n.h3,{id:"bypass-acl-checks",children:"Bypass ACL Checks"}),"\n",(0,r.jsxs)(n.p,{children:["The volume owner can perform operations on buckets, keys, and prefixes within their volume ",(0,r.jsx)(n.strong,{children:"without requiring explicit ACL permissions"}),". This means the owner has ",(0,r.jsx)(n.strong,{children:"implicit access"})," to all resources in their volume, regardless of ACL settings on those resources. The owner check happens before any ACL evaluation, providing a fast-path for owner operations."]}),"\n",(0,r.jsx)(n.h3,{id:"volume-deletion-by-owner",children:"Volume Deletion by Owner"}),"\n",(0,r.jsxs)(n.p,{children:["Volume owners ",(0,r.jsx)(n.strong,{children:"can delete their own volumes"})," because volumes are created with default ACLs that grant the owner ",(0,r.jsx)(n.code,{children:"ALL"})," permissions, which includes ",(0,r.jsx)(n.code,{children:"DELETE"})," permission."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Requirements for Volume Deletion:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"DELETE Permission:"})," The requester must have ",(0,r.jsx)(n.code,{children:"DELETE"})," ACL permission on the volume."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Empty Volume:"})," The volume must contain no buckets. All buckets must be deleted before the volume can be deleted."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Zero Reference Count:"})," The volume's ",(0,r.jsx)(n.code,{children:"refCount"})," must be 0. If ",(0,r.jsx)(n.code,{children:"refCount > 0"}),', it indicates that Ozone features (like multi-tenancy) hold a "lock" on the volume. The lock must be released first (e.g., via ',(0,r.jsx)(n.code,{children:"ozone tenant delete <tenantId>"}),")."]}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["Volume creation is still an ",(0,r.jsx)(n.strong,{children:"administrative operation"})," that requires administrator privileges. Only administrators can create volumes."]})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},62392:(e,n,o)=>{o.d(n,{R:()=>t,x:()=>l});var s=o(30758);const r={},i=s.createContext(r);function t(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);