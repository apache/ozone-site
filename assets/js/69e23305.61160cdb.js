"use strict";(self.webpackChunkdoc_site=self.webpackChunkdoc_site||[]).push([[8194],{62392:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>l});var s=r(30758);const t={},o=s.createContext(t);function i(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),s.createElement(o.Provider,{value:n},e.children)}},67629:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"administrator-guide/configuration/security/encryption/network-encryption/web-ui-https","title":"Configuring HTTPS for Web UI","description":"Ozone exposes multiple Web UIs (OM, SCM, Datanode, HttpFS, Recon, S3 Gateway). This page describes how to enable HTTPS for these Web UIs and how to configure optional mutual TLS (mTLS) using server and client certificates.","source":"@site/versioned_docs/version-2.1.0/05-administrator-guide/02-configuration/03-security/05-encryption/01-network-encryption/03-web-ui-https.md","sourceDirName":"05-administrator-guide/02-configuration/03-security/05-encryption/01-network-encryption","slug":"/administrator-guide/configuration/security/encryption/network-encryption/web-ui-https","permalink":"/docs/administrator-guide/configuration/security/encryption/network-encryption/web-ui-https","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/ozone-site/tree/master/versioned_docs/version-2.1.0/05-administrator-guide/02-configuration/03-security/05-encryption/01-network-encryption/03-web-ui-https.md","tags":[],"version":"2.1.0","sidebarPosition":3,"frontMatter":{"sidebar_label":"Web UI HTTPS"},"sidebar":"defaultSidebar","previous":{"title":"gRPC TLS","permalink":"/docs/administrator-guide/configuration/security/encryption/network-encryption/grpc"},"next":{"title":"Transparent Data Encryption (TDE)","permalink":"/docs/administrator-guide/configuration/security/encryption/transparent-data-encryption"}}');var t=r(86070),o=r(62392);const i={sidebar_label:"Web UI HTTPS"},l="Configuring HTTPS for Web UI",c={},d=[{value:"1. Enabling HTTPS endpoints",id:"1-enabling-https-endpoints",level:2},{value:"Configuration key",id:"configuration-key",level:3},{value:"2. HTTP vs HTTPS ports for Web UIs",id:"2-http-vs-https-ports-for-web-uis",level:2},{value:"Example: Ozone Manager (OM)",id:"example-ozone-manager-om",level:3},{value:"Other services",id:"other-services",level:3},{value:"3. Server keystore and truststore configuration",id:"3-server-keystore-and-truststore-configuration",level:2},{value:"Configuration keys",id:"configuration-keys",level:3},{value:"Step 1 \u2013 Point Ozone to the server SSL resource",id:"step-1--point-ozone-to-the-server-ssl-resource",level:3},{value:"Step 2 \u2013 Define keystore and truststore in the SSL resource",id:"step-2--define-keystore-and-truststore-in-the-ssl-resource",level:3},{value:"Requirements",id:"requirements",level:3},{value:"4. Enabling mutual TLS (mTLS)",id:"4-enabling-mutual-tls-mtls",level:2},{value:"Configuration keys",id:"configuration-keys-1",level:3},{value:"mTLS considerations",id:"mtls-considerations",level:3},{value:"5. Example minimal configuration",id:"5-example-minimal-configuration",level:2}];function a(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"configuring-https-for-web-ui",children:"Configuring HTTPS for Web UI"})}),"\n",(0,t.jsx)(n.p,{children:"Ozone exposes multiple Web UIs (OM, SCM, Datanode, HttpFS, Recon, S3 Gateway). This page describes how to enable HTTPS for these Web UIs and how to configure optional mutual TLS (mTLS) using server and client certificates."}),"\n",(0,t.jsxs)(n.p,{children:["For authentication (Kerberos/SIMPLE) of the HTTP endpoints, see the ",(0,t.jsx)(n.strong,{children:"Securing HTTP"})," documentation. This page focuses on transport encryption only."]}),"\n",(0,t.jsx)(n.h2,{id:"1-enabling-https-endpoints",children:"1. Enabling HTTPS endpoints"}),"\n",(0,t.jsxs)(n.p,{children:["HTTPS for Web UIs is controlled globally by the ",(0,t.jsx)(n.code,{children:"ozone.http.policy"})," property."]}),"\n",(0,t.jsx)(n.h3,{id:"configuration-key",children:"Configuration key"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Property"}),(0,t.jsx)(n.th,{children:"Default"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsx)(n.tbody,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"ozone.http.policy"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"HTTP_ONLY"})}),(0,t.jsx)(n.td,{children:"Controls whether HTTPS is enabled for Ozone daemons' HTTP endpoints."})]})})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Supported values"})," (from ",(0,t.jsx)(n.a,{href:"https://github.com/apache/ozone/blob/master/hadoop-hdds/common/src/main/resources/ozone-default.xml",children:(0,t.jsx)(n.code,{children:"ozone-default.xml"})}),"):"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"HTTP_ONLY"}),": Service is provided only over HTTP."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"HTTPS_ONLY"}),": Service is provided only over HTTPS."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"HTTP_AND_HTTPS"}),": Both HTTP and HTTPS ports are enabled."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["To enable HTTPS for Web UIs, set the policy in ",(0,t.jsx)(n.code,{children:"ozone-site.xml"}),", for example:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:"<property>\n  <name>ozone.http.policy</name>\n  <value>HTTPS_ONLY</value>\n</property>\n"})}),"\n",(0,t.jsx)(n.p,{children:"Or, to keep both HTTP and HTTPS available:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:"<property>\n  <name>ozone.http.policy</name>\n  <value>HTTP_AND_HTTPS</value>\n</property>\n"})}),"\n",(0,t.jsx)(n.h2,{id:"2-http-vs-https-ports-for-web-uis",children:"2. HTTP vs HTTPS ports for Web UIs"}),"\n",(0,t.jsx)(n.p,{children:"Each service has separate configuration keys for its HTTP and HTTPS Web UI endpoints. HTTPS uses different ports than HTTP."}),"\n",(0,t.jsx)(n.h3,{id:"example-ozone-manager-om",children:"Example: Ozone Manager (OM)"}),"\n",(0,t.jsxs)(n.p,{children:["From ",(0,t.jsx)(n.code,{children:"ozone-default.xml"})," and the Network Ports reference:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"ozone.om.http-address"})," \u2013 default ",(0,t.jsx)(n.code,{children:"0.0.0.0:9874"})," (HTTP Web UI)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"ozone.om.https-address"})," \u2013 default ",(0,t.jsx)(n.code,{children:"0.0.0.0:9875"})," (HTTPS Web UI)"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Example in ",(0,t.jsx)(n.code,{children:"ozone-site.xml"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:"<property>\n  <name>ozone.om.http-address</name>\n  <value>0.0.0.0:9874</value>\n</property>\n\n<property>\n  <name>ozone.om.https-address</name>\n  <value>0.0.0.0:9875</value>\n</property>\n"})}),"\n",(0,t.jsxs)(n.p,{children:["When HA is enabled, append the service ID and node ID to each property, for example: ",(0,t.jsx)(n.code,{children:"ozone.om.https-address.service1.om1"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"other-services",children:"Other services"}),"\n",(0,t.jsx)(n.p,{children:"The same pattern is used for other Web UIs:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"SCM"}),": ",(0,t.jsx)(n.code,{children:"ozone.scm.http-address"}),", ",(0,t.jsx)(n.code,{children:"ozone.scm.https-address"})," (defaults 0.0.0.0:9876, 0.0.0.0:9877)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Recon"}),": ",(0,t.jsx)(n.code,{children:"ozone.recon.http-address"}),", ",(0,t.jsx)(n.code,{children:"ozone.recon.https-address"})," (defaults 0.0.0.0:9888, 0.0.0.0:9889)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"S3 Gateway (S3G)"}),": ",(0,t.jsx)(n.code,{children:"ozone.s3g.http-address"}),", ",(0,t.jsx)(n.code,{children:"ozone.s3g.https-address"})," (defaults 0.0.0.0:9878, 0.0.0.0:9879)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Datanode"}),": ",(0,t.jsx)(n.code,{children:"hdds.datanode.http-address"}),", ",(0,t.jsx)(n.code,{children:"hdds.datanode.https-address"})," (defaults 0.0.0.0:9882, 0.0.0.0:9883)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"HttpFS"}),": use ",(0,t.jsx)(n.code,{children:"httpfs.http.port"})," and corresponding SSL settings (see HttpFS documentation)"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["See the ",(0,t.jsx)(n.a,{href:"../../../basic/network/default-ports",children:"Default Ports"})," reference for the full list of default ports and keys."]}),"\n",(0,t.jsx)(n.h2,{id:"3-server-keystore-and-truststore-configuration",children:"3. Server keystore and truststore configuration"}),"\n",(0,t.jsx)(n.p,{children:"Ozone uses standard Hadoop SSL configuration. The main entry point is the server keystore resource."}),"\n",(0,t.jsx)(n.h3,{id:"configuration-keys",children:"Configuration keys"}),"\n",(0,t.jsxs)(n.p,{children:["From ",(0,t.jsx)(n.a,{href:"https://github.com/apache/ozone/blob/master/hadoop-hdds/common/src/main/resources/ozone-default.xml",children:(0,t.jsx)(n.code,{children:"ozone-default.xml"})}),":"]}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Property"}),(0,t.jsx)(n.th,{children:"Default"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"ozone.https.server.keystore.resource"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"ssl-server.xml"})}),(0,t.jsx)(n.td,{children:"Resource file from which server keystore information is read"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"ssl.server.keystore.location"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.em,{children:"(empty)"})}),(0,t.jsx)(n.td,{children:"Filesystem path to the server keystore file"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"ssl.server.keystore.password"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.em,{children:"(empty)"})}),(0,t.jsx)(n.td,{children:"Password for the server keystore"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"ssl.server.keystore.keypassword"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.em,{children:"(empty)"})}),(0,t.jsx)(n.td,{children:"Password for the private key in the keystore"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"ssl.server.truststore.location"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.em,{children:"(empty)"})}),(0,t.jsx)(n.td,{children:"Filesystem path to the server truststore file"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"ssl.server.truststore.password"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.em,{children:"(empty)"})}),(0,t.jsx)(n.td,{children:"Password for the server truststore"})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"step-1--point-ozone-to-the-server-ssl-resource",children:"Step 1 \u2013 Point Ozone to the server SSL resource"}),"\n",(0,t.jsxs)(n.p,{children:["In ",(0,t.jsx)(n.code,{children:"ozone-site.xml"}),", you can override the server SSL resource file name:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:"<property>\n  <name>ozone.https.server.keystore.resource</name>\n  <value>ssl-server.xml</value>\n</property>\n"})}),"\n",(0,t.jsx)(n.p,{children:"This resource is usually found on the classpath and contains the keystore/truststore definitions."}),"\n",(0,t.jsx)(n.h3,{id:"step-2--define-keystore-and-truststore-in-the-ssl-resource",children:"Step 2 \u2013 Define keystore and truststore in the SSL resource"}),"\n",(0,t.jsxs)(n.p,{children:["In the referenced ",(0,t.jsx)(n.code,{children:"ssl-server.xml"})," (or the file named by ",(0,t.jsx)(n.code,{children:"ozone.https.server.keystore.resource"}),"), configure the keystore and truststore locations and passwords:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:"<configuration>\n  <property>\n    <name>ssl.server.keystore.location</name>\n    <value>/etc/security/keystores/ozone-server.jks</value>\n  </property>\n\n  <property>\n    <name>ssl.server.keystore.password</name>\n    <value>changeit</value>\n  </property>\n\n  <property>\n    <name>ssl.server.keystore.keypassword</name>\n    <value>changeit</value>\n  </property>\n\n  <property>\n    <name>ssl.server.truststore.location</name>\n    <value>/etc/security/keystores/ozone-truststore.jks</value>\n  </property>\n\n  <property>\n    <name>ssl.server.truststore.password</name>\n    <value>changeit</value>\n  </property>\n</configuration>\n"})}),"\n",(0,t.jsx)(n.h3,{id:"requirements",children:"Requirements"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"The keystore must contain a certificate whose hostname matches the Web UI URL."}),"\n",(0,t.jsx)(n.li,{children:"All hosts running Ozone Web UI roles must be able to read the keystore and truststore files."}),"\n",(0,t.jsx)(n.li,{children:"Use strong passwords and protect these files carefully."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"4-enabling-mutual-tls-mtls",children:"4. Enabling mutual TLS (mTLS)"}),"\n",(0,t.jsxs)(n.p,{children:["By default, the server does ",(0,t.jsx)(n.strong,{children:"not"})," require a client certificate."]}),"\n",(0,t.jsx)(n.h3,{id:"configuration-keys-1",children:"Configuration keys"}),"\n",(0,t.jsxs)(n.p,{children:["From ",(0,t.jsx)(n.a,{href:"https://github.com/apache/ozone/blob/master/hadoop-hdds/common/src/main/resources/ozone-default.xml",children:(0,t.jsx)(n.code,{children:"ozone-default.xml"})}),":"]}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Property"}),(0,t.jsx)(n.th,{children:"Default"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"ozone.https.client.need-auth"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"false"})}),(0,t.jsx)(n.td,{children:"Whether SSL client certificate authentication is required (mTLS)."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"ozone.https.client.keystore.resource"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"ssl-client.xml"})}),(0,t.jsx)(n.td,{children:"Resource file describing the client keystore/truststore."})]})]})]}),"\n",(0,t.jsx)(n.p,{children:"To require client certificates (mTLS) for HTTPS Web UIs:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:"<property>\n  <name>ozone.https.client.need-auth</name>\n  <value>true</value>\n</property>\n"})}),"\n",(0,t.jsx)(n.p,{children:"Then configure the client SSL resource:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:"<property>\n  <name>ozone.https.client.keystore.resource</name>\n  <value>ssl-client.xml</value>\n</property>\n"})}),"\n",(0,t.jsxs)(n.p,{children:["In ",(0,t.jsx)(n.code,{children:"ssl-client.xml"}),", define the client keystore and truststore, for example:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:"<configuration>\n  <property>\n    <name>ssl.client.keystore.location</name>\n    <value>/etc/security/keystores/ozone-client.jks</value>\n  </property>\n\n  <property>\n    <name>ssl.client.keystore.password</name>\n    <value>changeit</value>\n  </property>\n\n  <property>\n    <name>ssl.client.truststore.location</name>\n    <value>/etc/security/keystores/ozone-client-truststore.jks</value>\n  </property>\n\n  <property>\n    <name>ssl.client.truststore.password</name>\n    <value>changeit</value>\n  </property>\n</configuration>\n"})}),"\n",(0,t.jsx)(n.h3,{id:"mtls-considerations",children:"mTLS considerations"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["The server truststore (",(0,t.jsx)(n.code,{children:"ssl.server.truststore.location"}),") must trust the CA that signed client certificates."]}),"\n",(0,t.jsx)(n.li,{children:"The client truststore must trust the server certificate's CA."}),"\n",(0,t.jsx)(n.li,{children:"For browser access, client certificates must be available in the browser's key store or the underlying OS keychain."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"5-example-minimal-configuration",children:"5. Example minimal configuration"}),"\n",(0,t.jsx)(n.p,{children:"Below is a minimal example that enables HTTPS-only access to the OM Web UI with server-side TLS."}),"\n",(0,t.jsxs)(n.p,{children:["In ",(0,t.jsx)(n.code,{children:"ozone-site.xml"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:"<configuration>\n  <property>\n    <name>ozone.http.policy</name>\n    <value>HTTPS_ONLY</value>\n  </property>\n\n  <property>\n    <name>ozone.om.https-address</name>\n    <value>0.0.0.0:9875</value>\n  </property>\n\n  <property>\n    <name>ozone.https.server.keystore.resource</name>\n    <value>ssl-server.xml</value>\n  </property>\n</configuration>\n"})}),"\n",(0,t.jsxs)(n.p,{children:["In the referenced ",(0,t.jsx)(n.code,{children:"ssl-server.xml"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:"<configuration>\n  <property>\n    <name>ssl.server.keystore.location</name>\n    <value>/etc/security/keystores/ozone-server.jks</value>\n  </property>\n  <property>\n    <name>ssl.server.keystore.password</name>\n    <value>changeit</value>\n  </property>\n  <property>\n    <name>ssl.server.keystore.keypassword</name>\n    <value>changeit</value>\n  </property>\n  <property>\n    <name>ssl.server.truststore.location</name>\n    <value>/etc/security/keystores/ozone-truststore.jks</value>\n  </property>\n  <property>\n    <name>ssl.server.truststore.password</name>\n    <value>changeit</value>\n  </property>\n</configuration>\n"})}),"\n",(0,t.jsx)(n.p,{children:"After configuring the server (and optionally client) keystores, restart Ozone services so the HTTPS and mTLS settings take effect."})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}}}]);