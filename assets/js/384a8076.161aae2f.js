"use strict";(self.webpackChunkdoc_site=self.webpackChunkdoc_site||[]).push([[1464],{62392:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>o});var s=t(30758);const a={},i=s.createContext(a);function r(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),s.createElement(i.Provider,{value:n},e.children)}},72988:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>r,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"administrator-guide/operations/s3-multi-tenancy/tenant-commands","title":"Tenant Commands","description":"For a higher level understanding of multi-tenancy architecture, see the Multi-Tenancy Overview.","source":"@site/docs/05-administrator-guide/03-operations/07-s3-multi-tenancy/03-tenant-commands.md","sourceDirName":"05-administrator-guide/03-operations/07-s3-multi-tenancy","slug":"/administrator-guide/operations/s3-multi-tenancy/tenant-commands","permalink":"/docs/administrator-guide/operations/s3-multi-tenancy/tenant-commands","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/ozone-site/tree/HDDS-9225-website-v2/docs/05-administrator-guide/03-operations/07-s3-multi-tenancy/03-tenant-commands.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_label":"Tenant Commands"},"sidebar":"defaultSidebar","previous":{"title":"Setup","permalink":"/docs/administrator-guide/operations/s3-multi-tenancy/setup"},"next":{"title":"Access Control","permalink":"/docs/administrator-guide/operations/s3-multi-tenancy/access-control"}}');var a=t(86070),i=t(62392);const r={sidebar_label:"Tenant Commands"},o="Tenant Commands",c={},l=[{value:"Create a tenant",id:"create-a-tenant",level:2},{value:"List tenants",id:"list-tenants",level:2},{value:"Assign a user to a tenant",id:"assign-a-user-to-a-tenant",level:2},{value:"Assign a user as a tenant admin",id:"assign-a-user-as-a-tenant-admin",level:2},{value:"List users in a tenant",id:"list-users-in-a-tenant",level:2},{value:"Get tenant user info",id:"get-tenant-user-info",level:2},{value:"Get tenant user secret key",id:"get-tenant-user-secret-key",level:2},{value:"Set tenant user secret key",id:"set-tenant-user-secret-key",level:2},{value:"Revoke a tenant admin",id:"revoke-a-tenant-admin",level:2},{value:"Revoke user access from a tenant",id:"revoke-user-access-from-a-tenant",level:2},{value:"Delete a tenant",id:"delete-a-tenant",level:2},{value:"Creating bucket links",id:"creating-bucket-links",level:2},{value:"Example: Accessing a bucket via S3 Gateway",id:"example-accessing-a-bucket-via-s3-gateway",level:2},{value:"Configure AWS CLI",id:"configure-aws-cli",level:2},{value:"List buckets, create a bucket",id:"list-buckets-create-a-bucket",level:2},{value:"Put object (key) to a bucket, list objects",id:"put-object-key-to-a-bucket-list-objects",level:2},{value:"Get object (key) from a bucket",id:"get-object-key-from-a-bucket",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"tenant-commands",children:"Tenant Commands"})}),"\n",(0,a.jsxs)(n.p,{children:["For a higher level understanding of multi-tenancy architecture, see the ",(0,a.jsx)(n.a,{href:"/docs/administrator-guide/operations/s3-multi-tenancy/overview",children:"Multi-Tenancy Overview"}),"."]}),"\n",(0,a.jsxs)(n.p,{children:["All Multi-Tenancy subcommands are located under CLI ",(0,a.jsx)(n.code,{children:"ozone tenant"}),"."]}),"\n",(0,a.jsx)(n.p,{children:"The commands below assume a Kerberized Ozone cluster with Ranger install. Enabling HTTPS on S3 Gateway is optional but recommended."}),"\n",(0,a.jsxs)(n.p,{children:["The exit code of a successful tenant command should be ",(0,a.jsx)(n.code,{children:"0"}),". A non-zero exit code indicates failure, which should be accompanied an error message."]}),"\n",(0,a.jsxs)(n.p,{children:["If the OzoneManagers are running in HA, append ",(0,a.jsx)(n.code,{children:"--om-service-id="})," accordingly to the commands."]}),"\n",(0,a.jsx)(n.h2,{id:"create-a-tenant",children:"Create a tenant"}),"\n",(0,a.jsx)(n.p,{children:"Create a new tenant in the current Ozone cluster. This operation requires Ozone cluster administrator privilege."}),"\n",(0,a.jsx)(n.p,{children:"Apart from adding new OM DB entries, creating a tenant also does the following in the background:"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:"Creates a volume of the exact same name. Therefore, volume name restrictions apply to the tenant name as well. Specifying a custom volume name during tenant creation is not supported yet. Tenant volume cannot be changed once the tenant is created."}),"\n",(0,a.jsxs)(n.li,{children:["Creates two new Ranger roles, ",(0,a.jsx)(n.code,{children:"tenantName-UserRole"})," and ",(0,a.jsx)(n.code,{children:"tenantName-AdminRole"}),"."]}),"\n",(0,a.jsx)(n.li,{children:"Creates new Ranger policies that allows all tenant users to list and create buckets by default under the tenant volume, but only bucket owners and tenant admins are allowed to access the bucket contents."}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"ozone tenant [--verbose] create <TENANT_NAME>\n"})}),"\n",(0,a.jsx)(n.p,{children:"Example:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"bash-4.2$ kinit -kt /etc/security/keytabs/om.keytab om/om@EXAMPLE.COM\nbash-4.2$ ozone tenant create tenantone\n2022-02-16 00:00:00,000 [main] INFO rpc.RpcClient: Creating Tenant: 'tenantone', with new volume: 'tenantone'\n"})}),"\n",(0,a.jsx)(n.p,{children:"Verbose output example:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"bash-4.2$ ozone tenant --verbose create tenantone\n2022-02-16 00:00:00,000 [main] INFO rpc.RpcClient: Creating Tenant: 'tenantone', with new volume: 'tenantone'\n{\n  \"tenantId\": \"tenantone\"\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"list-tenants",children:"List tenants"}),"\n",(0,a.jsxs)(n.p,{children:["List all tenants in an Ozone cluster. Optionally, use ",(0,a.jsx)(n.code,{children:"--json"})," to print the detailed result in JSON."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"ozone tenant list [--json]\n"})}),"\n",(0,a.jsx)(n.p,{children:"Example:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"bash-4.2$ ozone tenant list\ntenantone\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'bash-4.2$ ozone tenant list --json\n[\n  {\n    "tenantId": "tenantone",\n    "bucketNamespaceName": "tenantone",\n    "userRoleName": "tenantone-UserRole",\n    "adminRoleName": "tenantone-AdminRole",\n    "bucketNamespacePolicyName": "tenantone-VolumeAccess",\n    "bucketPolicyName": "tenantone-BucketAccess"\n  }\n]\n'})}),"\n",(0,a.jsx)(n.h2,{id:"assign-a-user-to-a-tenant",children:"Assign a user to a tenant"}),"\n",(0,a.jsx)(n.p,{children:"The first user in a tenant must be assigned by an Ozone cluster administrator."}),"\n",(0,a.jsxs)(n.p,{children:["By default when user ",(0,a.jsx)(n.code,{children:"testuser"})," is assigned to tenant ",(0,a.jsx)(n.code,{children:"tenantone"}),", the generated Access ID for the user in this tenant is ",(0,a.jsx)(n.code,{children:"tenantone$testuser"}),"."]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Be sure to enclose the Access ID in single quotes in Bash when using it so it doesn't get expanded as environment variables."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"It is possible to assign a user to multiple tenants."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"ozone tenant [--verbose] user assign <USER_NAME> --tenant=<TENANT_NAME>\n"})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"<USER_NAME>"})," should be a short user name for a Kerberos principal, e.g. ",(0,a.jsx)(n.code,{children:"testuser"})," when the Kerberos principal is ",(0,a.jsx)(n.code,{children:"testuser/scm@EXAMPLE.COM"})]}),"\n",(0,a.jsx)(n.p,{children:"Example:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"bash-4.2$ ozone tenant user assign testuser --tenant=tenantone\nexport AWS_ACCESS_KEY_ID='tenantone$testuser'\nexport AWS_SECRET_ACCESS_KEY='<GENERATED_SECRET>'\n\nbash-4.2$ ozone tenant user assign testuser --tenant=tenantone\nTENANT_USER_ACCESS_ID_ALREADY_EXISTS accessId 'tenantone$testuser' already exists!\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"bash-4.2$ ozone tenant --verbose user assign testuser2 --tenant=tenantone\nexport AWS_ACCESS_KEY_ID='tenantone$testuser2'\nexport AWS_SECRET_ACCESS_KEY='<GENERATED_SECRET>'\nAssigned 'testuser2' to 'tenantone' with accessId 'tenantone$testuser2'.\n"})}),"\n",(0,a.jsx)(n.h2,{id:"assign-a-user-as-a-tenant-admin",children:"Assign a user as a tenant admin"}),"\n",(0,a.jsx)(n.p,{children:"The first user in a tenant must be assigned by an Ozone cluster administrator."}),"\n",(0,a.jsxs)(n.p,{children:["Both delegated and non-delegated tenant admin can assign and revoke ",(0,a.jsx)(n.strong,{children:"regular"})," tenant users."]}),"\n",(0,a.jsxs)(n.p,{children:["The only difference between delegated tenant admin and non-delegated tenant admin is that delegated tenant admin can assign and revoke tenant ",(0,a.jsx)(n.strong,{children:"admins"})," in the tenant, while non-delegated tenant admin can't."]}),"\n",(0,a.jsxs)(n.p,{children:["By default, ",(0,a.jsx)(n.code,{children:"ozone tenant assignadmin"})," assigns a ",(0,a.jsx)(n.strong,{children:"non-delegated"})," tenant admin. To assign a ",(0,a.jsx)(n.strong,{children:"delegated"})," tenant admin, specify ",(0,a.jsx)(n.code,{children:"--delegated"})," or ",(0,a.jsx)(n.code,{children:"-d"}),"."]}),"\n",(0,a.jsx)(n.p,{children:"It is possible to assign a user to be tenant admins in multiple tenants. Just a reminder, the user would have a different access ID under each tenant."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"ozone tenant user assignadmin <ACCESS_ID> [-d|--delegated] --tenant=<TENANT_NAME>\n"})}),"\n",(0,a.jsx)(n.p,{children:"Example:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"bash-4.2$ ozone tenant user assignadmin 'tenantone$testuser' --tenant=tenantone\n"})}),"\n",(0,a.jsxs)(n.p,{children:["By default, if the command succeeds, it exits with ",(0,a.jsx)(n.code,{children:"0"})," and prints nothing. Use ",(0,a.jsx)(n.code,{children:"--verbose"})," to print the result in JSON."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'bash-4.2$ ozone tenant --verbose user assignadmin \'tenantone$testuser\' --tenant=tenantone\n{\n  "accessId": "tenantone$testuser",\n  "tenantId": "tenantone",\n  "isAdmin": true,\n  "isDelegatedAdmin": true\n}\n'})}),"\n",(0,a.jsxs)(n.p,{children:["Once ",(0,a.jsx)(n.code,{children:"testuser"})," becomes a tenant admin of ",(0,a.jsx)(n.code,{children:"tenantone"}),", one can kinit as ",(0,a.jsx)(n.code,{children:"testuser"})," and assign new users to the tenant, even new tenant admins (if delegated). Example commands for illustration:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"kinit -kt /etc/security/keytabs/testuser.keytab testuser/scm@EXAMPLE.COM\nozone tenant user assign testuser2 --tenant=tenantone\nozone tenant user assignadmin 'tenantone$testuser2' --tenant=tenantone\n"})}),"\n",(0,a.jsx)(n.h2,{id:"list-users-in-a-tenant",children:"List users in a tenant"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"ozone tenant user list [--json] <TENANT_NAME>\n"})}),"\n",(0,a.jsx)(n.p,{children:"Example:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"bash-4.2$ ozone tenant user list tenantone\n- User 'testuser' with accessId 'tenantone$testuser'\n- User 'testuser2' with accessId 'tenantone$testuser2'\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'bash-4.2$ ozone tenant user list --json tenantone\n[\n  {\n    "user": "testuser",\n    "accessId": "tenantone$testuser"\n  },\n  {\n    "user": "testuser2",\n    "accessId": "tenantone$testuser2"\n  }\n]\n'})}),"\n",(0,a.jsx)(n.h2,{id:"get-tenant-user-info",children:"Get tenant user info"}),"\n",(0,a.jsx)(n.p,{children:"This command lists all tenants a user is assigned to."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"ozone tenant user info [--json] <USER_NAME>\n"})}),"\n",(0,a.jsx)(n.p,{children:"Example:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"bash-4.2$ ozone tenant user info testuser\nUser 'testuser' is assigned to:\n- Tenant 'tenantone' delegated admin with accessId 'tenantone$testuser'\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'bash-4.2$ ozone tenant user info --json testuser\n{\n  "user": "testuser",\n  "tenants": [\n    {\n      "accessId": "tenantone$testuser",\n      "tenantId": "tenantone",\n      "isAdmin": true,\n      "isDelegatedAdmin": true\n    }\n  ]\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"get-tenant-user-secret-key",children:"Get tenant user secret key"}),"\n",(0,a.jsx)(n.p,{children:"Get secret key by tenant user access ID."}),"\n",(0,a.jsxs)(n.p,{children:["Unlike ",(0,a.jsx)(n.code,{children:"ozone s3 getsecret"}),", it doesn't generate a key if the access ID doesn't exist."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"ozone tenant user get-secret <ACCESS_ID>\n"})}),"\n",(0,a.jsx)(n.p,{children:"or"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"ozone tenant user getsecret <ACCESS_ID>\n"})}),"\n",(0,a.jsx)(n.p,{children:"Example:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"bash-4.2$ ozone tenant user get-secret 'tenantone$testuser'\nexport AWS_ACCESS_KEY_ID='tenantone$testuser'\nexport AWS_SECRET_ACCESS_KEY='<GENERATED_SECRET>'\n"})}),"\n",(0,a.jsx)(n.h2,{id:"set-tenant-user-secret-key",children:"Set tenant user secret key"}),"\n",(0,a.jsx)(n.p,{children:"Set secret key for a tenant user access ID."}),"\n",(0,a.jsx)(n.p,{children:"Secret key length should be at least 8 characters."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"ozone tenant user set-secret <ACCESS_ID> --secret <SECRET_KEY>\n"})}),"\n",(0,a.jsx)(n.p,{children:"or"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"ozone tenant user setsecret <ACCESS_ID> --secret <SECRET_KEY>\n"})}),"\n",(0,a.jsx)(n.p,{children:"Example:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"bash-4.2$ ozone tenant user set-secret 'tenantone$testuser' --secret 'NEW_SECRET'\nexport AWS_ACCESS_KEY_ID='tenantone$testuser'\nexport AWS_SECRET_ACCESS_KEY='NEW_SECRET'\n"})}),"\n",(0,a.jsx)(n.h2,{id:"revoke-a-tenant-admin",children:"Revoke a tenant admin"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"ozone tenant [--verbose] user revokeadmin <ACCESS_ID>\n"})}),"\n",(0,a.jsx)(n.p,{children:"Example:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"bash-4.2$ ozone tenant user revokeadmin 'tenantone$testuser'\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'bash-4.2$ ozone tenant --verbose user revokeadmin \'tenantone$testuser\'\n{\n  "accessId": "tenantone$testuser",\n  "isAdmin": false,\n  "isDelegatedAdmin": false\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"revoke-user-access-from-a-tenant",children:"Revoke user access from a tenant"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"ozone tenant [--verbose] user revoke <ACCESS_ID>\n"})}),"\n",(0,a.jsx)(n.p,{children:"Example:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"bash-4.2$ ozone tenant user revoke 'tenantone$testuser'\n"})}),"\n",(0,a.jsx)(n.p,{children:"With verbose output:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"bash-4.2$ ozone tenant --verbose user revoke 'tenantone$testuser'\nRevoked accessId 'tenantone$testuser'.\n"})}),"\n",(0,a.jsx)(n.h2,{id:"delete-a-tenant",children:"Delete a tenant"}),"\n",(0,a.jsxs)(n.p,{children:["In order to be able to delete a tenant, the tenant has to be empty. i.e. All users need to be revoked before a tenant can be deleted. Otherwise OM will throw ",(0,a.jsx)(n.code,{children:"TENANT_NOT_EMPTY"})," exception and refuse to delete the tenant."]}),"\n",(0,a.jsx)(n.p,{children:"Note that it is intentional by design that the volume created and associated with the tenant during tenant creation is not removed. An admin has to remove the volume manually as prompt in the CLI, if deemed necessary."}),"\n",(0,a.jsx)(n.p,{children:"Verbose option, in addition, will print the Ozone Manager RAW response in JSON."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"ozone tenant [--verbose] delete <TENANT_NAME>\n"})}),"\n",(0,a.jsx)(n.p,{children:"Example:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"bash-4.2$ ozone tenant delete tenantone\nDeleted tenant 'tenantone'.\nBut the associated volume 'tenantone' is not removed. To delete it, run\n    ozone sh volume delete tenantone\n"})}),"\n",(0,a.jsx)(n.p,{children:"With verbose output:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'bash-4.2$ ozone tenant --verbose delete tenantone\nDeleted tenant \'tenantone\'.\nBut the associated volume \'tenantone\' is not removed. To delete it, run\n    ozone sh volume delete tenantone\n\n{\n  "tenantId": "tenantone",\n  "volumeName": "tenantone",\n  "volumeRefCount": 0\n}\n'})}),"\n",(0,a.jsxs)(n.p,{children:["If an Ozone cluster admin (or whoever has the permission to delete the volume in Ranger) tries delete a volume before the tenant is deleted using the command above, the ",(0,a.jsx)(n.code,{children:"ozone sh volume delete"})," command would fail because the volume reference count is not zero:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"bash-4.2$ ozone sh volume delete tenantone\nVOLUME_IS_REFERENCED Volume reference count is not zero (1). Ozone features are enabled on this volume. Try `ozone tenant delete <tenantId>` first.\n"})}),"\n",(0,a.jsx)(n.h2,{id:"creating-bucket-links",children:"Creating bucket links"}),"\n",(0,a.jsx)(n.p,{children:"Bucket links can be used to allow access to buckets outside of the tenant volume."}),"\n",(0,a.jsx)(n.p,{children:"Bucket (sym)links are a special type of bucket that points to other buckets in the same Ozone cluster. It is similar to POSIX symbolic links."}),"\n",(0,a.jsx)(n.p,{children:"An example to create a bucket link:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"ozone tenant linkbucket /vol1/bucket1 /tenantone/linked-bucket1\n"})}),"\n",(0,a.jsxs)(n.p,{children:["The command above creates a bucket symlink ",(0,a.jsx)(n.code,{children:"linked-bucket1"})," in volume ",(0,a.jsx)(n.code,{children:"tenantone"}),", which points to ",(0,a.jsx)(n.code,{children:"bucket1"})," in ",(0,a.jsx)(n.code,{children:"vol1"}),"."]}),"\n",(0,a.jsxs)(n.p,{children:["As long as the user running this command has the permission to create a bucket in the target volume ",(0,a.jsx)(n.code,{children:"tenantone"}),", the command will succeed."]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"The link bucket command itself does not check for permission to access the source volume and bucket."}),"\n",(0,a.jsx)(n.li,{children:"The link bucket command will not even check if the source volume and bucket exists."}),"\n",(0,a.jsxs)(n.li,{children:["Permission check will be performed when the bucket symlink is actually accessed.","\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["In order to grant a user in tenant ",(0,a.jsx)(n.code,{children:"tenantone"})," access the bucket, a new policy should be added by a Ranger admin that allow that user intended permissions (",(0,a.jsx)(n.code,{children:"READ, WRITE, LIST, CREATE, DELETE, ..."}),") to the source bucket ",(0,a.jsx)(n.code,{children:"bucket1"})," in volume ",(0,a.jsx)(n.code,{children:"vol1"}),"."]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["At the moment, ",(0,a.jsx)(n.code,{children:"ozone tenant linkbucket"})," command is equivalent to ",(0,a.jsx)(n.code,{children:"ozone sh bucket link"})," command. See the ",(0,a.jsx)(n.a,{href:"/docs/core-concepts/namespace/buckets/links",children:"Bucket Links"})," documentation for more details."]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"example-accessing-a-bucket-via-s3-gateway",children:"Example: Accessing a bucket via S3 Gateway"}),"\n",(0,a.jsxs)(n.p,{children:["Here is an example of accessing the bucket using AWS CLI, with tenant ",(0,a.jsx)(n.code,{children:"tenantone"})," created and ",(0,a.jsx)(n.code,{children:"testuser"})," assigned to the tenant."]}),"\n",(0,a.jsx)(n.h2,{id:"configure-aws-cli",children:"Configure AWS CLI"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"bash-4.2$ aws configure\nAWS Access Key ID [****************fslf]: tenantone$testuser\nAWS Secret Access Key [****************fslf]: <GENERATED_SECRET>\nDefault region name [us-west-1]:\nDefault output format [None]:\n"})}),"\n",(0,a.jsx)(n.h2,{id:"list-buckets-create-a-bucket",children:"List buckets, create a bucket"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'bash-4.2$ aws s3api --endpoint-url http://s3g:9878 list-buckets\n{\n    "Buckets": []\n}\nbash-4.2$ aws s3api --endpoint-url http://s3g:9878 create-bucket --bucket bucket-test1\n{\n    "Location": "http://s3g:9878/bucket-test1"\n}\nbash-4.2$ aws s3api --endpoint-url http://s3g:9878 list-buckets\n{\n    "Buckets": [\n        {\n            "Name": "bucket-test1",\n            "CreationDate": "2022-02-16T00:05:00.000Z"\n        }\n    ]\n}\n'})}),"\n",(0,a.jsxs)(n.p,{children:["The bucket created with ",(0,a.jsx)(n.code,{children:"aws s3api"})," is also visible under Ozone CLI:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'bash-4.2$ ozone sh bucket list /tenantone\n[ {\n  "metadata" : { },\n  "volumeName" : "tenantone",\n  "name" : "bucket-test1",\n  "storageType" : "DISK",\n  "versioning" : false,\n  "usedBytes" : 0,\n  "usedNamespace" : 0,\n  "creationTime" : "2022-02-16T00:05:00.000Z",\n  "modificationTime" : "2022-02-16T00:05:00.000Z",\n  "quotaInBytes" : -1,\n  "quotaInNamespace" : -1,\n  "bucketLayout" : "OBJECT_STORE",\n  "owner" : "root",\n  "link" : false\n} ]\n'})}),"\n",(0,a.jsx)(n.h2,{id:"put-object-key-to-a-bucket-list-objects",children:"Put object (key) to a bucket, list objects"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'bash-4.2$ aws s3api --endpoint-url http://s3g:9878 put-object --bucket bucket-test1 --key file1 --body README.md\nbash-4.2$ aws s3api --endpoint-url http://s3g:9878 list-objects --bucket bucket-test1\n{\n    "Contents": [\n        {\n            "Key": "file1",\n            "LastModified": "2022-02-16T00:10:00.000Z",\n            "ETag": "e99f93dedfe22e9a133dc3c634f14634",\n            "Size": 3811,\n            "StorageClass": "STANDARD"\n        }\n    ]\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"get-object-key-from-a-bucket",children:"Get object (key) from a bucket"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'bash-4.2$ aws s3api --endpoint-url http://s3g:9878 get-object --bucket bucket-test1 --key file1 file1-get.txt\n{\n    "AcceptRanges": "bytes",\n    "LastModified": "Wed, 16 Feb 2022 00:10:00 GMT",\n    "ContentLength": 3811,\n    "CacheControl": "no-cache",\n    "ContentType": "application/octet-stream",\n    "Expires": "Wed, 16 Feb 2022 00:15:00 GMT",\n    "Metadata": {}\n}\nbash-4.2$ diff file1-get.txt README.md\n'})})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}}}]);