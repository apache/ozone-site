"use strict";(self.webpackChunkdoc_site=self.webpackChunkdoc_site||[]).push([[99018],{62392:(e,t,i)=>{i.d(t,{R:()=>r,x:()=>c});var n=i(30758);const s={},o=n.createContext(s);function r(e){const t=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),n.createElement(o.Provider,{value:t},e.children)}},66716:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>n,toc:()=>a});const n=JSON.parse('{"id":"core-concepts/namespace/buckets/layouts/file-system-optimized","title":"File System Optimized Buckets (FSO)","description":"Overview","source":"@site/docs/03-core-concepts/03-namespace/02-buckets/04-layouts/02-file-system-optimized.md","sourceDirName":"03-core-concepts/03-namespace/02-buckets/04-layouts","slug":"/core-concepts/namespace/buckets/layouts/file-system-optimized","permalink":"/docs/next/core-concepts/namespace/buckets/layouts/file-system-optimized","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/ozone-site/tree/master/docs/03-core-concepts/03-namespace/02-buckets/04-layouts/02-file-system-optimized.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_label":"File System Optimized (FSO)"},"sidebar":"defaultSidebar","previous":{"title":"Object Store (OBS)","permalink":"/docs/next/core-concepts/namespace/buckets/layouts/object-store"},"next":{"title":"Default Replication Type","permalink":"/docs/next/core-concepts/namespace/buckets/replication"}}');var s=i(86070),o=i(62392);const r={sidebar_label:"File System Optimized (FSO)"},c="File System Optimized Buckets (FSO)",l={},a=[{value:"Overview",id:"overview",level:2},{value:"Why FSO for Ozone?",id:"why-fso-for-ozone",level:2},{value:"1. Atomic Operations (The O(1) Factor)",id:"1-atomic-operations-the-o1-factor",level:3},{value:"2. Delete operations",id:"2-delete-operations",level:3},{value:"When to Use FSO vs Object Store (OBS)",id:"when-to-use-fso-vs-object-store-obs",level:2},{value:"Configuration",id:"configuration",level:2}];function d(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"file-system-optimized-buckets-fso",children:"File System Optimized Buckets (FSO)"})}),"\n",(0,s.jsx)(t.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"File System Optimized"})," (FSO) is a bucket layout optimized for Hadoop Compatible File System (HCFS) operations. Unlike the Object Store (OBS) layout, FSO maintains separate entries for intermediate directories, enabling efficient file system operations like directory listing, renaming, and deletion.\nFSO buckets support ",(0,s.jsx)(t.strong,{children:"atomic rename"})," and ",(0,s.jsx)(t.strong,{children:"delete operations"})," on directories at any level in constant time, regardless of directory depth or the number of files contained within."]}),"\n",(0,s.jsx)(t.p,{children:"For example, in an FSO bucket, keys are stored with their hierarchical structure preserved:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-text",children:"/mybucket/data/2025/nov/report\n/mybucket/data/2025/dec/summary\n/mybucket/archive/2024/logs/applog\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Each intermediate directories (",(0,s.jsx)(t.code,{children:"data"}),", ",(0,s.jsx)(t.code,{children:"2025"}),", ",(0,s.jsx)(t.code,{children:"nov"}),", etc.) are stored as a separate entry, allowing efficient directory-level operations."]}),"\n",(0,s.jsxs)(t.admonition,{type:"note",children:[(0,s.jsxs)(t.p,{children:["FSO is the default bucket layout in Ozone. To explicitly specify FSO layout when creating a bucket, use the ",(0,s.jsx)(t.code,{children:"--layout"})," flag:"]}),(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"ozone sh bucket create /<volume-name>/<bucket-name> --layout FILE_SYSTEM_OPTIMIZED\n"})})]}),"\n",(0,s.jsx)(t.h2,{id:"why-fso-for-ozone",children:"Why FSO for Ozone?"}),"\n",(0,s.jsx)(t.h3,{id:"1-atomic-operations-the-o1-factor",children:"1. Atomic Operations (The O(1) Factor)"}),"\n",(0,s.jsxs)(t.p,{children:["In a standard Object Store, if you rename a directory containing ",(0,s.jsx)(t.strong,{children:"1 million files"}),", the system has to:"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Find all 1 million keys"}),"\n",(0,s.jsx)(t.li,{children:"Copy them to a new path string"}),"\n",(0,s.jsx)(t.li,{children:"Delete the 1 million old keys"}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["This is ",(0,s.jsx)(t.strong,{children:"O(n)"})," operation \u2014 the more files you have, the longer it takes."]}),"\n",(0,s.jsxs)(t.p,{children:["In FSO, a ",(0,s.jsx)(t.strong,{children:"rename"})," is just a metadata pointer update. To rename ",(0,s.jsx)(t.code,{children:"/data"})," to ",(0,s.jsx)(t.code,{children:"/archive"}),", Ozone simply finds the entry for ",(0,s.jsx)(t.code,{children:"data"})," in the ",(0,s.jsx)(t.code,{children:"DirectoryTable"})," and updates its name to ",(0,s.jsx)(t.code,{children:"archive"}),". All the children (the millions of files) stay exactly where they are because they point to the ",(0,s.jsx)(t.code,{children:"unique ID"})," of that directory, not its name."]}),"\n",(0,s.jsx)(t.h3,{id:"2-delete-operations",children:"2. Delete operations"}),"\n",(0,s.jsx)(t.p,{children:"Deleting a directory with millions of files is efficient because all child entries share the same parent ID prefix, allowing Ozone to quickly locate and remove them using prefix-based queries, rather than scanning the entire namespace."}),"\n",(0,s.jsx)(t.h2,{id:"when-to-use-fso-vs-object-store-obs",children:"When to Use FSO vs Object Store (OBS)"}),"\n",(0,s.jsxs)(t.p,{children:["Choose ",(0,s.jsx)(t.strong,{children:"File System Optimized (FSO)"})," when:"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Using Hadoop Compatible File System interfaces"}),"\n",(0,s.jsx)(t.li,{children:"Storing data for analytics workloads (Hive, Spark ...)"}),"\n",(0,s.jsx)(t.li,{children:"Working with hierarchical directory structures"}),"\n",(0,s.jsx)(t.li,{children:"Requiring atomic directory operations (rename, delete)"}),"\n",(0,s.jsx)(t.li,{children:"Needing trash/recycle bin functionality"}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["Choose ",(0,s.jsx)(t.strong,{children:"Object Store (OBS)"})," when:"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Primarily using S3-compatible APIs"}),"\n",(0,s.jsx)(t.li,{children:"Working with flat object access patterns"}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"configuration",children:"Configuration"}),"\n",(0,s.jsxs)(t.p,{children:["To update the default layout when creating buckets, configure these properties in ",(0,s.jsx)(t.code,{children:"ozone-site.xml"}),":"]}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Property"}),(0,s.jsx)(t.th,{children:"Default Value"}),(0,s.jsx)(t.th,{children:"Description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"ozone.default.bucket.layout"})}),(0,s.jsx)(t.td,{children:"none"}),(0,s.jsx)(t.td,{children:"Sets the default layout for all buckets if no layout is specified during creation by the client"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"ozone.client.fs.default.bucket.layout"})}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"FILE_SYSTEM_OPTIMIZED"})}),(0,s.jsx)(t.td,{children:"Sets the default layout for buckets created using the OFS client"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"ozone.s3g.default.bucket.layout"})}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"OBJECT_STORE"})}),(0,s.jsx)(t.td,{children:"Defines the default layout for buckets created through the S3 API"})]})]})]}),"\n",(0,s.jsxs)(t.p,{children:["For detailed technical information about the internal metadata structure and implementation, see the ",(0,s.jsx)(t.a,{href:"../../../../system-internals/features/filesystem-optimization",children:"File System Optimization System Internals"})," documentation."]})]})}function h(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);