"use strict";(self.webpackChunkdoc_site=self.webpackChunkdoc_site||[]).push([[35206],{62392:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>a});var t=i(30758);const s={},r=t.createContext(s);function o(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(r.Provider,{value:n},e.children)}},76535:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"administrator-guide/installation/initializing-cluster","title":"Initializing Cluster","description":"After installing the binaries, the next step is to initialize the cluster. This section provides instructions on how to initialize a new Ozone cluster.","source":"@site/versioned_docs/version-2.1.0/05-administrator-guide/01-installation/05-initializing-cluster.md","sourceDirName":"05-administrator-guide/01-installation","slug":"/administrator-guide/installation/initializing-cluster","permalink":"/docs/administrator-guide/installation/initializing-cluster","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/ozone-site/tree/master/versioned_docs/version-2.1.0/05-administrator-guide/01-installation/05-initializing-cluster.md","tags":[],"version":"2.1.0","sidebarPosition":5,"frontMatter":{"title":"Initializing Cluster"},"sidebar":"defaultSidebar","previous":{"title":"Installing the Ozone Binaries","permalink":"/docs/administrator-guide/installation/installing-binaries"},"next":{"title":"Configuration","permalink":"/docs/administrator-guide/configuration/"}}');var s=i(86070),r=i(62392);const o={title:"Initializing Cluster"},a=void 0,d={},l=[{value:"Initialize configurations",id:"initialize-configurations",level:2},{value:"Ozone Settings Summary",id:"ozone-settings-summary",level:2},{value:"Initialize the cluster",id:"initialize-the-cluster",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"After installing the binaries, the next step is to initialize the cluster. This section provides instructions on how to initialize a new Ozone cluster."}),"\n",(0,s.jsx)(n.h2,{id:"initialize-configurations",children:"Initialize configurations"}),"\n",(0,s.jsxs)(n.p,{children:["Ozone relies on a configuration file called ",(0,s.jsx)(n.code,{children:"ozone-site.xml"}),". To generate a template that you can replace with proper values, please run the following command. This will generate a template called ",(0,s.jsx)(n.code,{children:"ozone-site.xml"})," at the specified path (directory)."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"export OZONE_HOME=/path/to/ozone\nexport PATH=$PATH:$OZONE_HOME/bin\nexport OZONE_CONF_DIR=$OZONE_HOME/etc/ozone\n\nozone genconf $OZONE_CONF_DIR\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Let us look at the settings inside the generated file (",(0,s.jsx)(n.code,{children:"ozone-site.xml"}),") and how they control Ozone. Once the right values are defined, this file is ready for use."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"ozone.metadata.dirs"})," Allows Administrators to specify where the metadata must reside. Usually you pick your fastest disk (SSD if you have them on your nodes). OzoneManager, SCM and Datanode will write the metadata to this path. This is a required setting, if this is missing Ozone will fail to come up."]}),"\n",(0,s.jsx)(n.p,{children:"Here is an example,"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"   <property>\n      <name>ozone.metadata.dirs</name>\n      <value>/data/disk1/meta</value>\n   </property>\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"ozone.scm.names"})}),"  Storage Container Manager (SCM) is a distributed block service which is used by Ozone. This property allows Datanodes to discover SCM's address. Datanodes send heartbeat to SCM. Until HA feature is complete, we configure ",(0,s.jsx)(n.code,{children:"ozone.scm.names"})," to be a single machine."]}),"\n",(0,s.jsx)(n.p,{children:"Here is an example,"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"    <property>\n      <name>ozone.scm.names</name>\n      <value>scm.ozone.apache.org</value>\n    </property>\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"ozone.scm.datanode.id.dir"})})," Datanodes generate a Unique ID called Datanode ID. This identity is written to the file ",(0,s.jsx)(n.code,{children:"datanode.id"})," in a directory specified by this path. ",(0,s.jsx)(n.em,{children:"Datanodes will create this path if it doesn't exist already."})]}),"\n",(0,s.jsx)(n.p,{children:"Here is an  example,"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"   <property>\n      <name>ozone.scm.datanode.id.dir</name>\n      <value>/data/disk1/meta/node</value>\n   </property>\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"ozone.om.address"})})," OM server address. This is used by OzoneClient and Ozone File System."]}),"\n",(0,s.jsx)(n.p,{children:"Here is an example,"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"    <property>\n       <name>ozone.om.address</name>\n       <value>ozonemanager.ozone.apache.org</value>\n    </property>\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"ozone-settings-summary",children:"Ozone Settings Summary"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Setting"}),(0,s.jsx)(n.th,{children:"Value"}),(0,s.jsx)(n.th,{children:"Comment"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ozone.metadata.dirs"})}),(0,s.jsx)(n.td,{children:"file path"}),(0,s.jsx)(n.td,{children:"The metadata will be stored here."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ozone.scm.names"})}),(0,s.jsx)(n.td,{children:"SCM server name"}),(0,s.jsxs)(n.td,{children:["Hostname",":port"," or IP",":port"," address of SCM."]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ozone.scm.block.client.address"})}),(0,s.jsx)(n.td,{children:"SCM server name and port"}),(0,s.jsx)(n.td,{children:"Used by services like OM"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ozone.scm.client.address"})}),(0,s.jsx)(n.td,{children:"SCM server name and port"}),(0,s.jsx)(n.td,{children:"Used by client-side"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ozone.scm.datanode.address"})}),(0,s.jsx)(n.td,{children:"SCM server name and port"}),(0,s.jsx)(n.td,{children:"Used by Datanode to talk to SCM"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ozone.om.address"})}),(0,s.jsx)(n.td,{children:"OM server name"}),(0,s.jsx)(n.td,{children:"Used by Ozone handler and Ozone file system."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"hdds.datanode.dir"})}),(0,s.jsx)(n.td,{children:"file path"}),(0,s.jsx)(n.td,{children:"HDDS Datanodes store data in this directory."})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"initialize-the-cluster",children:"Initialize the cluster"}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["For simplicity, here we show the steps for non-HA cluster (1 OM, 1 SCM). To configure OM HA or to convert from non-HA to HA, see the ",(0,s.jsx)(n.a,{href:"../../administrator-guide/configuration/high-availability/om-ha",children:"OM HA documentation"}),". To configure SCM HA or to convert from non-HA to HA, see the ",(0,s.jsx)(n.a,{href:"../../administrator-guide/configuration/high-availability/scm-ha",children:"SCM HA documentation"}),"."]})}),"\n",(0,s.jsx)(n.admonition,{title:"For Production Deployments",type:"tip",children:(0,s.jsx)(n.p,{children:"It is highly recommended to set up an HA-enabled cluster from the beginning for production environments. While it is possible to convert a non-HA cluster to an HA cluster, it is a complex procedure."})}),"\n",(0,s.jsx)(n.p,{children:"Before we boot up the Ozone cluster, we need to initialize both SCM and Ozone Manager."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ozone scm --init\n"})}),"\n",(0,s.jsxs)(n.p,{children:["This allows SCM to create the cluster Identity and initialize its state. The ",(0,s.jsx)(n.code,{children:"init"})," command initializes the metadata directory specified in ",(0,s.jsx)(n.code,{children:"$ozone.metadata.dirs"}),". Init command is executed only once, that allows SCM to create all the required on-disk structures to work correctly."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ozone --daemon start scm\n"})}),"\n",(0,s.jsx)(n.p,{children:"Once we know SCM is up and running, we can create an Object Store for our use. This is done by running the following command."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ozone om --init\n"})}),"\n",(0,s.jsx)(n.p,{children:"Once Ozone Manager is initialized, we are ready to run the name service."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ozone --daemon start om\n"})}),"\n",(0,s.jsx)(n.p,{children:"At this point Ozone's name services, the Ozone Manager, and the block service SCM are both running."}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["SCM start will fail if on-disk data structures are missing; If SCM is not running, ",(0,s.jsx)(n.code,{children:"om --init"})," command will fail. So please make sure you have done both ",(0,s.jsx)(n.code,{children:"scm --init"})," and ",(0,s.jsx)(n.code,{children:"om --init"})," commands."]})}),"\n",(0,s.jsx)(n.p,{children:"Now we need to start the Datanodes. Please run the following command on each Datanode."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ozone --daemon start datanode\n"})}),"\n",(0,s.jsx)(n.p,{children:"At this point SCM, Ozone Manager and Datanodes are up and running."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:(0,s.jsx)(n.strong,{children:"Congratulations!, You have set up a functional Ozone cluster."})})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}}}]);