"use strict";(self.webpackChunkdoc_site=self.webpackChunkdoc_site||[]).push([[3225],{62392:(e,t,r)=>{r.d(t,{R:()=>i,x:()=>o});var n=r(30758);const s={},a=n.createContext(s);function i(e){const t=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),n.createElement(a.Provider,{value:t},e.children)}},67571:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>h,contentTitle:()=>o,default:()=>c,frontMatter:()=>i,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"administrator-guide/operations/trash","title":"Trash","description":"The trash feature in Ozone provides a way to recover files that have been accidentally deleted. When enabled, deleted files are moved to a trash directory instead of being permanently removed.","source":"@site/docs/05-administrator-guide/03-operations/12-trash.md","sourceDirName":"05-administrator-guide/03-operations","slug":"/administrator-guide/operations/trash","permalink":"/docs/administrator-guide/operations/trash","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/ozone-site/tree/HDDS-9225-website-v2/docs/05-administrator-guide/03-operations/12-trash.md","tags":[],"version":"current","sidebarPosition":12,"frontMatter":{"sidebar_label":"Trash"},"sidebar":"defaultSidebar","previous":{"title":"S3 Gateway Load Balancing","permalink":"/docs/administrator-guide/operations/s3-gateway-load-balancing"},"next":{"title":"LDB Tool","permalink":"/docs/administrator-guide/operations/ldb"}}');var s=r(86070),a=r(62392);const i={sidebar_label:"Trash"},o="Trash",h={},l=[{value:"Enabling the Trash Feature",id:"enabling-the-trash-feature",level:2},{value:"Using the Trash",id:"using-the-trash",level:2},{value:"Trash Location",id:"trash-location",level:3},{value:"Skipping the Trash",id:"skipping-the-trash",level:3},{value:"Emptying the Trash",id:"emptying-the-trash",level:3}];function d(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"trash",children:"Trash"})}),"\n",(0,s.jsx)(t.p,{children:"The trash feature in Ozone provides a way to recover files that have been accidentally deleted. When enabled, deleted files are moved to a trash directory instead of being permanently removed."}),"\n",(0,s.jsx)(t.h2,{id:"enabling-the-trash-feature",children:"Enabling the Trash Feature"}),"\n",(0,s.jsxs)(t.p,{children:["To enable the trash feature, you need to add the following configuration properties to the Ozone Manager's ",(0,s.jsx)(t.code,{children:"core-site.xml"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-xml",children:"<property>\n  <name>fs.trash.interval</name>\n  <value>360</value> \x3c!-- Time in minutes --\x3e\n</property>\n\n<property>\n  <name>fs.trash.classname</name>\n  <value>org.apache.hadoop.fs.ozone.OzoneTrashPolicy</value>\n</property>\n"})}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"fs.trash.interval"})," property specifies the minimum time, in minutes, for which a deleted file will be kept in the trash. After this interval, the trash emptier will permanently delete the file. A value of 0 disables the trash feature."]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"fs.trash.classname"})," property should be set to ",(0,s.jsx)(t.code,{children:"org.apache.hadoop.fs.ozone.OzoneTrashPolicy"})," to use Ozone's trash implementation."]}),"\n",(0,s.jsx)(t.h2,{id:"using-the-trash",children:"Using the Trash"}),"\n",(0,s.jsxs)(t.p,{children:["When the trash feature is enabled, any file deleted using the ",(0,s.jsx)(t.code,{children:"ozone fs -rm"})," command will be moved to the trash."]}),"\n",(0,s.jsx)(t.h3,{id:"trash-location",children:"Trash Location"}),"\n",(0,s.jsxs)(t.p,{children:["The trash directory is located at ",(0,s.jsx)(t.code,{children:"/<volume>/<bucket>/.Trash/<username>"}),". For example, if the user ",(0,s.jsx)(t.code,{children:"testuser"})," deletes a file from ",(0,s.jsx)(t.code,{children:"/vol1/bucket1"}),", the file will be moved to ",(0,s.jsx)(t.code,{children:"/vol1/bucket1/.Trash/testuser/Current/"}),"."]}),"\n",(0,s.jsx)(t.h3,{id:"skipping-the-trash",children:"Skipping the Trash"}),"\n",(0,s.jsxs)(t.p,{children:["To permanently delete a file and bypass the trash, use the ",(0,s.jsx)(t.code,{children:"-skipTrash"})," option with the ",(0,s.jsx)(t.code,{children:"rm"})," command:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"ozone fs -rm -skipTrash /<volume>/<bucket>/<key>\n"})}),"\n",(0,s.jsx)(t.h3,{id:"emptying-the-trash",children:"Emptying the Trash"}),"\n",(0,s.jsxs)(t.p,{children:["The trash emptier is a background process that periodically deletes files from the trash directory after the configured ",(0,s.jsx)(t.code,{children:"fs.trash.interval"})," has passed. The interval at which the trash emptier runs can be configured with the ",(0,s.jsx)(t.code,{children:"ozone.fs.trash.checkpoint.interval"})," property in ",(0,s.jsx)(t.code,{children:"ozone-site.xml"}),"."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-xml",children:"<property>\n  <name>ozone.fs.trash.checkpoint.interval</name>\n  <value>60</value> \x3c!-- Time in minutes --\x3e\n</property>\n"})}),"\n",(0,s.jsxs)(t.p,{children:["If this property is not set, it defaults to the value of ",(0,s.jsx)(t.code,{children:"fs.trash.checkpoint.interval"}),"."]})]})}function c(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);