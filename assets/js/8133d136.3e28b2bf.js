"use strict";(self.webpackChunkdoc_site=self.webpackChunkdoc_site||[]).push([[3146],{44616:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"core-concepts/architecture/s3-gateway","title":"Ozone S3 Gateway","description":"Apache Ozone\u2019s S3 Gateway (often called S3G) is a component that provides an Amazon S3-compatible REST interface for Ozone\u2019s object store.","source":"@site/docs/03-core-concepts/01-architecture/03-s3-gateway.md","sourceDirName":"03-core-concepts/01-architecture","slug":"/core-concepts/architecture/s3-gateway","permalink":"/docs/core-concepts/architecture/s3-gateway","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/ozone-site/tree/HDDS-9225-website-v2/docs/03-core-concepts/01-architecture/03-s3-gateway.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_label":"Ozone S3 Gateway"},"sidebar":"defaultSidebar","previous":{"title":"Ozone Manager","permalink":"/docs/core-concepts/architecture/ozone-manager"},"next":{"title":"Replication","permalink":"/docs/core-concepts/replication/"}}');var a=t(86070),i=t(62392);const o={sidebar_label:"Ozone S3 Gateway"},r="Ozone S3 Gateway",l={},c=[{value:"High-Level Overview of the S3 Gateway",id:"high-level-overview-of-the-s3-gateway",level:2},{value:"Mapping S3 to Ozone Concepts",id:"mapping-s3-to-ozone-concepts",level:3},{value:"S3 Gateway in the Ozone Architecture",id:"s3-gateway-in-the-ozone-architecture",level:2},{value:"Internal Components and Design",id:"internal-components-and-design",level:2},{value:"HTTP Server and REST API Layer",id:"http-server-and-rest-api-layer",level:3},{value:"Request Handlers / Protocol Translation",id:"request-handlers--protocol-translation",level:3},{value:"Ozone Client Integration",id:"ozone-client-integration",level:3},{value:"Statelessness and Caching",id:"statelessness-and-caching",level:3},{value:"Authentication and Security",id:"authentication-and-security",level:3},{value:"Summary",id:"summary",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"ozone-s3-gateway",children:"Ozone S3 Gateway"})}),"\n",(0,a.jsxs)(n.p,{children:["Apache Ozone\u2019s S3 Gateway (often called ",(0,a.jsx)(n.strong,{children:"S3G"}),") is a component that provides an Amazon S3-compatible REST interface for Ozone\u2019s object store.\nIn essence, it allows any S3 client or tool to read and write data in Ozone as if it were talking to AWS S3.\nThe S3 Gateway runs as a ",(0,a.jsx)(n.strong,{children:"separate, stateless service"})," on top of Ozone, translating HTTP S3 API calls into Ozone\u2019s native storage operations."]}),"\n",(0,a.jsx)(n.p,{children:"This design lets users leverage the rich ecosystem of S3-compatible applications with Ozone, without modifying those applications."}),"\n",(0,a.jsx)(n.h2,{id:"high-level-overview-of-the-s3-gateway",children:"High-Level Overview of the S3 Gateway"}),"\n",(0,a.jsxs)(n.p,{children:["Ozone\u2019s S3 Gateway acts as a ",(0,a.jsx)(n.strong,{children:"REST front-end"})," that speaks the S3 protocol and bridges it to the Ozone backend.\nIt is ",(0,a.jsx)(n.strong,{children:"stateless"}),", meaning it does not persist data or metadata locally between requests \u2013 all state is stored in the Ozone cluster itself."]}),"\n",(0,a.jsx)(n.p,{children:"Being stateless allows multiple S3 Gateway instances to run in parallel behind a load balancer for scaling and high availability.\nThe idea of stateless also allows S3G to be deployed in Kubernetes quite easily.\nThe gateway supports a broad set of S3 operations \u2013 create/delete buckets, PUT/GET objects, list objects, perform multipart uploads \u2013 using standard S3 SDKs or CLI tools."}),"\n",(0,a.jsx)(n.p,{children:"Under the hood, each operation is translated into the appropriate Ozone calls:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["A PUT object request becomes a ",(0,a.jsx)(n.code,{children:"putKey"})," write operation."]}),"\n",(0,a.jsxs)(n.li,{children:["A GET object becomes a ",(0,a.jsx)(n.code,{children:"getKey"})," read operation."]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"mapping-s3-to-ozone-concepts",children:"Mapping S3 to Ozone Concepts"}),"\n",(0,a.jsxs)(n.p,{children:["In Ozone, data is organized into ",(0,a.jsx)(n.strong,{children:"volumes"}),", ",(0,a.jsx)(n.strong,{children:"buckets"}),", and ",(0,a.jsx)(n.strong,{children:"keys"}),". By default, the S3 Gateway uses a special\nvolume named ",(0,a.jsx)(n.code,{children:"/s3v"})," to store all S3 buckets (this is configurable via the ",(0,a.jsx)(n.code,{children:"ozone.s3g.volume.name"})," property)."]}),"\n",(0,a.jsxs)(n.p,{children:["Each S3 bucket created is represented as a bucket under the ",(0,a.jsx)(n.code,{children:"/s3v"})," volume in Ozone. Objects (keys) are stored within those buckets. This mapping is transparent to the end user."]}),"\n",(0,a.jsxs)(n.p,{children:["The default bucket layout for S3 buckets (",(0,a.jsx)(n.code,{children:"OBJECT_STORE"}),") can be configured using the ",(0,a.jsx)(n.code,{children:"ozone.s3g.default.bucket.layout"})," property. This property defines the storage layout for buckets created via the S3 Gateway."]}),"\n",(0,a.jsx)(n.h2,{id:"s3-gateway-in-the-ozone-architecture",children:"S3 Gateway in the Ozone Architecture"}),"\n",(0,a.jsx)(n.p,{children:"The S3 Gateway does the following:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"It receives S3 REST API calls from clients."}),"\n",(0,a.jsx)(n.li,{children:"It translates them and forwards metadata operations to OM."}),"\n",(0,a.jsx)(n.li,{children:"It streams data directly to and from Datanodes."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"This stateless gateway can be scaled horizontally."}),"\n",(0,a.jsx)(n.h2,{id:"internal-components-and-design",children:"Internal Components and Design"}),"\n",(0,a.jsx)(n.h3,{id:"http-server-and-rest-api-layer",children:"HTTP Server and REST API Layer"}),"\n",(0,a.jsx)(n.p,{children:"Runs an embedded HTTP server exposing REST endpoints like:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"PUT /<bucket>/<key>"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"GET /<bucket>/<key>"})}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Handles authentication headers, content length, and routing."}),"\n",(0,a.jsx)(n.h3,{id:"request-handlers--protocol-translation",children:"Request Handlers / Protocol Translation"}),"\n",(0,a.jsx)(n.p,{children:"Each S3 operation is mapped to Ozone APIs:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Create Bucket \u2192 create in ",(0,a.jsx)(n.code,{children:"/s3v"})," volume"]}),"\n",(0,a.jsxs)(n.li,{children:["List Buckets \u2192 query all user-owned buckets under ",(0,a.jsx)(n.code,{children:"/s3v"})]}),"\n",(0,a.jsxs)(n.li,{children:["Put/Get Object \u2192 ",(0,a.jsx)(n.code,{children:"putKey"})," / ",(0,a.jsx)(n.code,{children:"getKey"})]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"It also assembles proper S3-compliant response formats."}),"\n",(0,a.jsx)(n.h3,{id:"ozone-client-integration",children:"Ozone Client Integration"}),"\n",(0,a.jsx)(n.p,{children:"Uses Ozone client libraries to:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Call OM for metadata operations"}),"\n",(0,a.jsx)(n.li,{children:"Stream data to/from Datanodes"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Bulk data does not flow through OM \u2013 it goes directly between gateway and Datanodes."}),"\n",(0,a.jsx)(n.h3,{id:"statelessness-and-caching",children:"Statelessness and Caching"}),"\n",(0,a.jsx)(n.p,{children:"The gateway:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Does not persist state"}),"\n",(0,a.jsx)(n.li,{children:"Uses lightweight in-memory caches"}),"\n",(0,a.jsx)(n.li,{children:"Depends on OM for coordination and user/token validation"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"This simplifies scaling and failure recovery."}),"\n",(0,a.jsx)(n.h3,{id:"authentication-and-security",children:"Authentication and Security"}),"\n",(0,a.jsx)(n.p,{children:"Supports AWS Signature-style authentication (if enabled):"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Only AWS Signature V4 is supported (the older AWS Signature V2 is not)."}),"\n",(0,a.jsx)(n.li,{children:"Validates access/secret keys via OM"}),"\n",(0,a.jsx)(n.li,{children:"Uses OM\u2019s stored credentials"}),"\n",(0,a.jsx)(n.li,{children:"Relies on OM for final authorization"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Supports Kerberos authentication for secure clusters;  In unsecured mode, allows anonymous or dummy access."}),"\n",(0,a.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,a.jsxs)(n.p,{children:["The Ozone S3 Gateway is a ",(0,a.jsx)(n.strong,{children:"protocol adapter"}),":"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"It translates REST S3 operations into native Ozone calls."}),"\n",(0,a.jsx)(n.li,{children:"It doesn\u2019t store or manage data \u2013 it delegates to OM and Datanodes."}),"\n",(0,a.jsx)(n.li,{children:"Its stateless, scalable design enables multiple instances behind load balancers."}),"\n",(0,a.jsx)(n.li,{children:"It enables seamless use of existing S3-compatible clients and tools."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"For more details, refer to the other documentation:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"/docs/user-guide/client-interfaces/s3/s3-api",children:"Ozone S3 Gateway Interface"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"/docs/administrator-guide/operations/s3-multi-tenancy/overview",children:"S3 Multi-Tenancy"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"/docs/user-guide/client-interfaces/s3/securing-s3",children:"Securing S3"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"/docs/administrator-guide/configuration/basic/network/default-ports",children:"Network Ports"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},62392:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>r});var s=t(30758);const a={},i=s.createContext(a);function o(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);