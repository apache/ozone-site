"use strict";(self.webpackChunkdoc_site=self.webpackChunkdoc_site||[]).push([[56881],{62392:(e,n,r)=>{r.d(n,{R:()=>s,x:()=>a});var i=r(30758);const o={},t=i.createContext(o);function s(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),i.createElement(t.Provider,{value:n},e.children)}},67757:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>u,frontMatter:()=>s,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"administrator-guide/configuration/performance/placeholder","title":"Production Deployment","description":"This document provides guidance on the requirements and best practices for a production deployment of Apache Ozone.","source":"@site/versioned_docs/version-2.1.0/05-administrator-guide/02-configuration/04-performance/01-placeholder.md","sourceDirName":"05-administrator-guide/02-configuration/04-performance","slug":"/administrator-guide/configuration/performance/placeholder","permalink":"/docs/administrator-guide/configuration/performance/placeholder","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/ozone-site/tree/master/versioned_docs/version-2.1.0/05-administrator-guide/02-configuration/04-performance/01-placeholder.md","tags":[],"version":"2.1.0","sidebarPosition":1,"frontMatter":{"sidebar_label":"Production Deployment"},"sidebar":"defaultSidebar","previous":{"title":"Performance","permalink":"/docs/administrator-guide/configuration/performance/"},"next":{"title":"Topology","permalink":"/docs/administrator-guide/configuration/performance/topology"}}');var o=r(86070),t=r(62392);const s={sidebar_label:"Production Deployment"},a="Production Deployment",d={},l=[{value:"Ozone Components",id:"ozone-components",level:2},{value:"Requirements",id:"requirements",level:2},{value:"System Requirements",id:"system-requirements",level:3},{value:"Memory Requirements",id:"memory-requirements",level:3},{value:"Storage Requirements",id:"storage-requirements",level:3},{value:"Network Requirements",id:"network-requirements",level:3},{value:"Security Requirements (Optional but Recommended)",id:"security-requirements-optional-but-recommended",level:3},{value:"Recommended Configurations",id:"recommended-configurations",level:2},{value:"Linux Kernel",id:"linux-kernel",level:3},{value:"Local File System",id:"local-file-system",level:3},{value:"Ozone Configuration",id:"ozone-configuration",level:3}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"production-deployment",children:"Production Deployment"})}),"\n",(0,o.jsx)(n.p,{children:"This document provides guidance on the requirements and best practices for a production deployment of Apache Ozone."}),"\n",(0,o.jsx)(n.h2,{id:"ozone-components",children:"Ozone Components"}),"\n",(0,o.jsx)(n.p,{children:"A typical production Ozone cluster includes the following services:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Ozone Manager (OM)"}),": Manages the namespace and metadata of the Ozone cluster. A production cluster requires 3 OM instances for high availability."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Storage Container Manager (SCM)"}),": Manages the data nodes and pipelines. A production cluster requires 3 SCM instances for high availability."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Datanode"}),": Stores the actual data in containers. A production cluster requires at least 3 Datanodes."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Recon"}),": A web-based UI for monitoring and managing the Ozone cluster. A Recon server is strongly recommended, though not required."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"S3 Gateway (S3G)"}),": An S3-compatible gateway for accessing Ozone. Multiple S3 Gateway instances are strongly recommended to load balance S3 traffic."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"HttpFS"}),": An WebHDFS-compatible API for accessing Ozone. This is an optional component."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"requirements",children:"Requirements"}),"\n",(0,o.jsx)(n.h3,{id:"system-requirements",children:"System Requirements"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Hardware"}),": Bare metal machines are recommended for optimal performance. Virtual machines or containers are not recommended for production deployments."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Operating System"}),": Linux (recommended distributions: Red Hat 8/Rocky 8+, Ubuntu, SUSE; supported architectures: x86/ARM)."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Java Development Kit (JDK)"}),": Version 8 or higher."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Time Synchronization"}),": A time synchronization service such as Chrony or ntpd must be enabled to prevent time drift."]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"memory-requirements",children:"Memory Requirements"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Ozone Manager (OM), Storage Container Manager (SCM), and Recon"}),": Recommended heap size in large production clusters is 64GB."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Datanode, S3 Gateway, and HttpFS"}),": Recommended heap size is 31GB."]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"storage-requirements",children:"Storage Requirements"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Ozone Manager (OM), Storage Container Manager (SCM), and Recon Metadata Storage"}),": Use SAS SSD or NVMe SSD for metadata (RocksDB and Ratis) to ensure optimal performance. It is recommended to use RAID 1 (disk mirroring) for the metadata disks to protect against disk failures."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Datanode Storage"}),":","\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Ratis Log"}),": Use SAS SSD or NVMe SSD for the Ratis log directory for low latency writes."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Container Data"}),": Hard disks are acceptable for container data storage."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Disk Configuration"}),": It is recommended to use a JBOD (Just a Bunch Of Disks) configuration instead of RAID. Ozone is a replicated distributed storage system and handles data redundancy. Using RAID can decrease performance without providing additional data protection benefits."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Storage Type"}),": Use direct-attached storage. Do not use Network Attached Storage (NAS) or Storage Area Network (SAN)."]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"network-requirements",children:"Network Requirements"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Network Bandwidth"}),": A minimum of 25Gbps network card bandwidth is recommended."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Network Topology"}),": A leaf-spine network topology with an oversubscription ratio below 3:1 is recommended for predictable performance."]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"security-requirements-optional-but-recommended",children:"Security Requirements (Optional but Recommended)"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Kerberos"}),": A Kerberos environment, including a Key Distribution Center (KDC), is recommended for enhanced security."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"recommended-configurations",children:"Recommended Configurations"}),"\n",(0,o.jsx)(n.h3,{id:"linux-kernel",children:"Linux Kernel"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"CPU Governor"}),": Set the CPU scaling driver to ",(0,o.jsx)(n.code,{children:"performance"})," mode to maximize performance."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Transparent Hugepage"}),": Disable Transparent Hugepage to avoid performance issues."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"SELinux"}),": Disable SELinux."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Swappiness"}),": Set ",(0,o.jsx)(n.code,{children:"vm.swappiness=1"})," to minimize swapping."]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"local-file-system",children:"Local File System"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"LVM"}),": Disable Logical Volume Manager (LVM) for data drives."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"File System"}),": Use ",(0,o.jsx)(n.code,{children:"ext4"})," or ",(0,o.jsx)(n.code,{children:"xfs"})," file systems."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Mount Options"}),": Mount drives with the ",(0,o.jsx)(n.code,{children:"noatime"})," option to reduce unnecessary disk writes. For SSDs, also add the ",(0,o.jsx)(n.code,{children:"discard"})," option."]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"ozone-configuration",children:"Ozone Configuration"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Monitoring"}),": Install ",(0,o.jsx)(n.a,{href:"../../operations/observability/prometheus",children:"Prometheus"})," and ",(0,o.jsx)(n.a,{href:"../../operations/observability/grafana",children:"Grafana"})," for monitoring the Ozone cluster. For audit logs, consider using a log ingestion framework such as the ELK Stack (Elasticsearch, Logstash, and Kibana) with FileBeat, or other similar frameworks. Alternatively, you can use Apache Ranger to manage audit logs."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Pipeline Limits"}),": Increase the number of allowed write pipelines to better suit your workload by adjusting ",(0,o.jsx)(n.code,{children:"ozone.scm.datanode.pipeline.limit"}),". See the ",(0,o.jsx)(n.a,{href:"./multi-raft",children:"Multi-Raft"})," documentation for the formula to calculate appropriate pipeline limits based on your metadata disk configuration."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Heap Sizes"}),": Configure sufficient heap sizes for Ozone Manager (OM), Storage Container Manager (SCM), Recon, Datanode, S3 Gateway (S3G), and HttpFS services to ensure stability."]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}}}]);