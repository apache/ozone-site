"use strict";(self.webpackChunkdoc_site=self.webpackChunkdoc_site||[]).push([[378],{34901:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>r,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"user-guide/integrations/hive","title":"Hive","description":"Apache Hive has supported Apache Ozone since Hive 4.0. To enable Hive to work with Ozone paths, ensure that the ozone-filesystem-hadoop3 JAR is added to the Hive classpath.","source":"@site/docs/04-user-guide/03-integrations/01-hive.md","sourceDirName":"04-user-guide/03-integrations","slug":"/user-guide/integrations/hive","permalink":"/docs/user-guide/integrations/hive","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/ozone-site/tree/HDDS-9225-website-v2/docs/04-user-guide/03-integrations/01-hive.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_label":"Hive"},"sidebar":"defaultSidebar","previous":{"title":"Integrations","permalink":"/docs/user-guide/integrations/"},"next":{"title":"Hue","permalink":"/docs/user-guide/integrations/hue"}}');var t=a(86070),s=a(62392);const o={sidebar_label:"Hive"},l="Hive",r={},d=[{value:"Supported Access Protocols",id:"supported-access-protocols",level:2},{value:"Supported Replication Types",id:"supported-replication-types",level:2},{value:"Accessing Ozone Data in Hive",id:"accessing-ozone-data-in-hive",level:2},{value:"Managed Tables",id:"managed-tables",level:3},{value:"Configuring the Hive Warehouse Directory in Ozone",id:"configuring-the-hive-warehouse-directory-in-ozone",level:4},{value:"Creating a Managed Table",id:"creating-a-managed-table",level:4},{value:"Loading Data into a Managed Table",id:"loading-data-into-a-managed-table",level:4},{value:"Specifying a Custom Ozone Path",id:"specifying-a-custom-ozone-path",level:4},{value:"Verifying the Ozone Path",id:"verifying-the-ozone-path",level:4},{value:"External Tables",id:"external-tables",level:3},{value:"Creating an External Table",id:"creating-an-external-table",level:4},{value:"Verifying the External Table Path",id:"verifying-the-external-table-path",level:4},{value:"Using the S3A Protocol",id:"using-the-s3a-protocol",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"hive",children:"Hive"})}),"\n",(0,t.jsxs)(n.p,{children:["Apache Hive has supported Apache Ozone since Hive 4.0. To enable Hive to work with Ozone paths, ensure that the ",(0,t.jsx)(n.code,{children:"ozone-filesystem-hadoop3"})," JAR is added to the Hive classpath."]}),"\n",(0,t.jsx)(n.h2,{id:"supported-access-protocols",children:"Supported Access Protocols"}),"\n",(0,t.jsx)(n.p,{children:"Hive supports the following protocols for accessing Ozone data:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"ofs"}),"\n",(0,t.jsx)(n.li,{children:"o3fs"}),"\n",(0,t.jsx)(n.li,{children:"s3a"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"supported-replication-types",children:"Supported Replication Types"}),"\n",(0,t.jsx)(n.p,{children:"Hive is compatible with Ozone buckets configured with either:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"RATIS (Replication)"}),"\n",(0,t.jsx)(n.li,{children:"Erasure Coding"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"accessing-ozone-data-in-hive",children:"Accessing Ozone Data in Hive"}),"\n",(0,t.jsx)(n.p,{children:"Hive provides two methods to interact with data in Ozone:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Managed Tables"}),"\n",(0,t.jsx)(n.li,{children:"External Tables"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"managed-tables",children:"Managed Tables"}),"\n",(0,t.jsx)(n.h4,{id:"configuring-the-hive-warehouse-directory-in-ozone",children:"Configuring the Hive Warehouse Directory in Ozone"}),"\n",(0,t.jsxs)(n.p,{children:["To store managed tables in Ozone, update the following properties in the ",(0,t.jsx)(n.code,{children:"hive-site.xml"})," configuration file:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:"<property>\n  <name>hive.metastore.warehouse.dir</name>\n  <value>ofs://ozone1/vol1/bucket1/warehouse/</value>\n</property>\n"})}),"\n",(0,t.jsx)(n.h4,{id:"creating-a-managed-table",children:"Creating a Managed Table"}),"\n",(0,t.jsxs)(n.p,{children:["You can create a managed table with a standard ",(0,t.jsx)(n.code,{children:"CREATE TABLE"})," statement:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE myTable (\n    id INT,\n    name STRING\n);\n"})}),"\n",(0,t.jsx)(n.h4,{id:"loading-data-into-a-managed-table",children:"Loading Data into a Managed Table"}),"\n",(0,t.jsx)(n.p,{children:"Data can be loaded into a Hive table from an Ozone location:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"LOAD DATA INPATH 'ofs://ozone1/vol1/bucket1/table.csv' INTO TABLE myTable;\n"})}),"\n",(0,t.jsx)(n.h4,{id:"specifying-a-custom-ozone-path",children:"Specifying a Custom Ozone Path"}),"\n",(0,t.jsxs)(n.p,{children:["You can define a custom Ozone path for a database using the ",(0,t.jsx)(n.code,{children:"MANAGEDLOCATION"})," clause:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"CREATE DATABASE d1 MANAGEDLOCATION 'ofs://ozone1/vol1/bucket1/data';\n"})}),"\n",(0,t.jsx)(n.p,{children:"Tables created in the database d1 will be stored under the specified path:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"ofs://ozone1/vol1/bucket1/data"})}),"\n",(0,t.jsx)(n.h4,{id:"verifying-the-ozone-path",children:"Verifying the Ozone Path"}),"\n",(0,t.jsx)(n.p,{children:"You can confirm that Hive references the correct Ozone path using:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"SHOW CREATE DATABASE d1;\n"})}),"\n",(0,t.jsx)(n.p,{children:"Output Example:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:"+----------------------------------------------------+\n|                   createdb_stmt                    |\n+----------------------------------------------------+\n| CREATE DATABASE `d1`                               |\n| LOCATION                                           |\n|   'ofs://ozone1/vol1/bucket1/external/d1.db'       |\n| MANAGEDLOCATION                                    |\n|   'ofs://ozone1/vol1/bucket1/data'                 |\n+----------------------------------------------------+\n"})}),"\n",(0,t.jsx)(n.h3,{id:"external-tables",children:"External Tables"}),"\n",(0,t.jsx)(n.p,{children:"Hive allows the creation of external tables to query existing data stored in Ozone."}),"\n",(0,t.jsx)(n.h4,{id:"creating-an-external-table",children:"Creating an External Table"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"CREATE EXTERNAL TABLE external_table (\n    id INT,\n    name STRING\n)\nLOCATION 'ofs://ozone1/vol1/bucket1/table1';\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"With external tables, the data is expected to be created and managed by another tool."}),"\n",(0,t.jsx)(n.li,{children:"Hive queries the data as-is."}),"\n",(0,t.jsx)(n.li,{children:"Note: Dropping an external table in Hive does not delete the associated data."}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["To set a default path for external tables, configure the following property in the ",(0,t.jsx)(n.code,{children:"hive-site.xml"})," file:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:"<property>\n  <name>hive.metastore.warehouse.external.dir</name>\n  <value>ofs://ozone1/vol1/bucket1/external/</value>\n</property>\n"})}),"\n",(0,t.jsx)(n.p,{children:"This property specifies the base directory for external tables when no explicit LOCATION is provided."}),"\n",(0,t.jsx)(n.h4,{id:"verifying-the-external-table-path",children:"Verifying the External Table Path"}),"\n",(0,t.jsx)(n.p,{children:"To confirm the table's metadata and location, use:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"SHOW CREATE TABLE external_table;\n"})}),"\n",(0,t.jsx)(n.p,{children:"Output Example:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:"+----------------------------------------------------+\n|                   createtab_stmt                   |\n+----------------------------------------------------+\n| CREATE EXTERNAL TABLE `external_table`(            |\n|   `id` int,                                        |\n|   `name` string)                                   |\n| ROW FORMAT SERDE                                   |\n|   'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'  |\n| STORED AS INPUTFORMAT                              |\n|   'org.apache.hadoop.mapred.TextInputFormat'       |\n| OUTPUTFORMAT                                       |\n|   'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' |\n| LOCATION                                           |\n|   'ofs://ozone1/vol1/bucket1/table1'               |\n| TBLPROPERTIES (                                    |\n|   'bucketing_version'='2',                         |\n|   'transient_lastDdlTime'='1734725573')            |\n+----------------------------------------------------+\n"})}),"\n",(0,t.jsx)(n.h2,{id:"using-the-s3a-protocol",children:"Using the S3A Protocol"}),"\n",(0,t.jsx)(n.p,{children:"In addition to ofs, Hive can access Ozone using the S3 Gateway via the S3A file system."}),"\n",(0,t.jsx)(n.p,{children:"For more information, consult:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["The ",(0,t.jsx)(n.a,{href:"/docs/user-guide/client-interfaces/s3/s3-api",children:"S3 Protocol"})]}),"\n",(0,t.jsxs)(n.li,{children:["The ",(0,t.jsx)(n.a,{href:"https://hadoop.apache.org/docs/current/hadoop-aws/tools/hadoop-aws/index.html",children:"Hadoop S3A"})," documentation."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},62392:(e,n,a)=>{a.d(n,{R:()=>o,x:()=>l});var i=a(30758);const t={},s=i.createContext(t);function o(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);