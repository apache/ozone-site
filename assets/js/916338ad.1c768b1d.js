"use strict";(self.webpackChunkdoc_site=self.webpackChunkdoc_site||[]).push([[9546],{36009:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>r,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"core-concepts/security/acls/native-acls","title":"Native ACLs","description":"Ozone supports a set of native ACLs.","source":"@site/docs/03-core-concepts/04-security/02-acls/01-native-acls.md","sourceDirName":"03-core-concepts/04-security/02-acls","slug":"/core-concepts/security/acls/native-acls","permalink":"/docs/core-concepts/security/acls/native-acls","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/ozone-site/tree/HDDS-9225-website-v2/docs/03-core-concepts/04-security/02-acls/01-native-acls.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_label":"Native ACLs"},"sidebar":"defaultSidebar","previous":{"title":"ACLs","permalink":"/docs/core-concepts/security/acls/"},"next":{"title":"Ranger ACLs","permalink":"/docs/core-concepts/security/acls/ranger-acls"}}');var l=s(86070),i=s(62392);const o={sidebar_label:"Native ACLs"},c="Native ACLs",r={},a=[{value:"Ozone Native ACL APIs",id:"ozone-native-acl-apis",level:2},{value:"ACL Manipulation Using Ozone CLI",id:"acl-manipulation-using-ozone-cli",level:2},{value:"<code>setacl</code>",id:"setacl",level:3},{value:"<code>getacl</code>",id:"getacl",level:3},{value:"<code>addacl</code>",id:"addacl",level:3},{value:"<code>removeacl</code>",id:"removeacl",level:3},{value:"Differences Between Ozone ACL and S3 ACL",id:"differences-between-ozone-acl-and-s3-acl",level:2},{value:"Ozone File System ACL API",id:"ozone-file-system-acl-api",level:2}];function d(e){const n={admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"native-acls",children:"Native ACLs"})}),"\n",(0,l.jsxs)(n.p,{children:["Ozone supports a set of native ACLs.\nThese ACLs can be used independently of Ozone ACL plugin such as Ranger.\nAdd the following properties to the ",(0,l.jsx)(n.code,{children:"ozone-site.xml"})," to enable native ACLs."]}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Property"}),(0,l.jsx)(n.th,{children:"Value"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"ozone.acl.enabled"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"true"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"ozone.acl.authorizer.class"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"org.apache.hadoop.ozone.security.acl.OzoneNativeAuthorizer"})})]})]})]}),"\n",(0,l.jsx)(n.p,{children:"Ozone ACLs are a super set of Posix and S3 ACLs."}),"\n",(0,l.jsxs)(n.p,{children:["The general format of an ACL is ",(0,l.jsx)(n.em,{children:"object"}),":",(0,l.jsx)(n.em,{children:"who"}),":",(0,l.jsx)(n.em,{children:"rights"}),":",(0,l.jsx)(n.em,{children:"scope"}),"."]}),"\n",(0,l.jsxs)(n.p,{children:["Where an ",(0,l.jsx)(n.em,{children:"object"})," can be:"]}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Volume"})," - An Ozone volume.  e.g. ",(0,l.jsx)(n.em,{children:"/volume"})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Bucket"})," - An Ozone bucket. e.g. ",(0,l.jsx)(n.em,{children:"/volume/bucket"})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Key"})," - An object key or an object. e.g. ",(0,l.jsx)(n.em,{children:"/volume/bucket/key"})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Prefix"})," - A path prefix for a specific key. e.g. ",(0,l.jsx)(n.em,{children:"/volume/bucket/prefix1/prefix2"})]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["Where a ",(0,l.jsx)(n.em,{children:"who"})," can be:"]}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"User"})," - A user in the Kerberos domain. User like in Posix world can be\nnamed or unnamed."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Group"})," - A group in the Kerberos domain. Group also like in Posix world\ncan be named or unnamed."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"World"})," - All authenticated users in the Kerberos domain. This maps to\nothers in the Posix domain."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Anonymous"})," - Ignore the user field completely. This is an extension to\nthe Posix semantics, This is needed for S3 protocol, where we express that\nwe have no way of knowing who the user is or we don't care."]}),"\n"]}),"\n",(0,l.jsx)(n.admonition,{type:"tip",children:(0,l.jsx)(n.p,{children:"A S3 user accessing Ozone via AWS v4 signature protocol will be translated to the appropriate Kerberos user by Ozone Manager."})}),"\n",(0,l.jsxs)(n.p,{children:["Where a ",(0,l.jsx)(n.em,{children:"right"})," can be:"]}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Create"})," \u2013 This ACL provides a user the ability to create buckets in a\nvolume and keys in a bucket. Please note: Under Ozone, Only admins can create volumes."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"List"})," \u2013 This ACL allows listing of buckets and keys. This ACL is attached\nto the volume and buckets which allow listing of the child objects. Please note: The user and admins can list the volumes owned by the user."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Delete"})," \u2013 Allows the user to delete a volume, bucket or key."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Read"})," \u2013 Allows the user to read the metadata of a Volume and Bucket and\ndata stream and metadata of a key."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Write"})," - Allows the user to write the metadata of a Volume and Bucket and\nallows the user to overwrite an existing Ozone key."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Read_ACL"})," \u2013 Allows a user to read the ACL on a specific object."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Write_ACL"})," \u2013 Allows a user to write the ACL on a specific object."]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["Where an ",(0,l.jsx)(n.em,{children:"scope"})," can be:"]}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"ACCESS"})," \u2013 Access ACL is applied only to the specific object and not inheritable. It controls the access to the object itself."]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"DEFAULT"})," - Default ACL is applied to the specific object and will be inherited by object's descendants. Default ACLs cannot be set on keys (as there can be no objects under a key)."]}),"\n",(0,l.jsxs)(n.admonition,{type:"note",children:[(0,l.jsx)(n.p,{children:"ACLs inherited from parent's Default ACLs will follow the following rules based on different bucket layout:"}),(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Legacy with EnableFileSystem or FSO"}),": inherit the immediate parent's DEFAULT ACLs. If none, inherit the bucket DEFAULT ACLs."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Legacy with DisableFileSystem or OBS"}),": inherit the bucket DEFAULT ACLs."]}),"\n"]})]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"ozone-native-acl-apis",children:"Ozone Native ACL APIs"}),"\n",(0,l.jsx)(n.p,{children:"The ACLs can be manipulated by a set of APIs supported by Ozone. The APIs\nsupported are:"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"SetAcl"})," \u2013 This API will take user principal, the name, type\nof the Ozone object and a list of ACLs."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"GetAcl"})," \u2013 This API will take the name and type of the Ozone object\nand will return a list of ACLs."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"AddAcl"})," - This API will take the name, type of the Ozone object, the\nACL, and add it to existing ACL entries of the Ozone object."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"RemoveAcl"})," - This API will take the name, type of the\nozone object and the ACL that has to be removed."]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"acl-manipulation-using-ozone-cli",children:"ACL Manipulation Using Ozone CLI"}),"\n",(0,l.jsxs)(n.p,{children:["The ACLs can also be manipulated by using the ",(0,l.jsx)(n.code,{children:"ozone sh"})," commands."]}),"\n",(0,l.jsx)(n.p,{children:"Usage:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"ozone sh <object> <action> [-a=<value>[,<value>...]] <object-uri>\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"-a"})," is for the comma separated list of ACLs. It is required for all subcommands except ",(0,l.jsx)(n.code,{children:"getacl"}),"."]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"<value>"})," is of the form ",(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.code,{children:"type:name:rights[scope]"})}),"."]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"type"})," can be user, group, world or anonymous."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"name"})," is the name of the user/group. For world and anonymous type, name should either be left empty or be WORLD or ANONYMOUS respectively."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"rights"})," can be (read=r, write=w, delete=d, list=l, all=a, none=n, create=c, read_acl=x, write_acl=y)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"scope"})," can be ",(0,l.jsx)(n.strong,{children:"ACCESS"})," or ",(0,l.jsx)(n.strong,{children:"DEFAULT"}),". If not specified, default is ",(0,l.jsx)(n.strong,{children:"ACCESS"}),"."]}),"\n"]}),"\n",(0,l.jsxs)(n.admonition,{type:"warning",children:[(0,l.jsx)(n.p,{children:"When the object is a prefix, the path-to-object must contain the full path from volume till the directory or prefix of the key. i.e.,"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"   /volume/bucket/some/key/prefix/\n"})}),(0,l.jsx)(n.p,{children:'Note: the tail "/" is required.'})]}),"\n",(0,l.jsx)(n.p,{children:"Following are the supported ACL actions."}),"\n",(0,l.jsx)(n.h3,{id:"setacl",children:(0,l.jsx)(n.code,{children:"setacl"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"$ ozone sh bucket setacl -a user:testuser2:a /vol1/bucket1\n ACLs set successfully.\n$ ozone sh bucket setacl -a user:om:a,group:om:a /vol1/bucket2\n ACLs set successfully.\n$ ozone sh bucket setacl -a=anonymous::lr /vol1/bucket3\n ACLs set successfully.\n$ ozone sh bucket setacl -a world::a /vol1/bucket4\n ACLs set successfully.\n"})}),"\n",(0,l.jsx)(n.h3,{id:"getacl",children:(0,l.jsx)(n.code,{children:"getacl"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:'$ ozone sh bucket getacl /vol1/bucket2 \n[ {\n  "type" : "USER",\n  "name" : "om/om@EXAMPLE.COM",\n  "aclScope" : "ACCESS",\n  "aclList" : [ "ALL" ]\n}, {\n  "type" : "GROUP",\n  "name" : "om",\n  "aclScope" : "ACCESS",\n  "aclList" : [ "ALL" ]\n} ]\n'})}),"\n",(0,l.jsx)(n.h3,{id:"addacl",children:(0,l.jsx)(n.code,{children:"addacl"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"$ ozone sh bucket addacl -a user:testuser2:a  /vol1/bucket2\nACL user:testuser2:a[ACCESS] added successfully.\n\n$ ozone sh bucket addacl -a user:testuser:rxy[DEFAULT] /vol1/bucket2\nACL user:testuser:rxy[DEFAULT] added successfully.\n\n$ ozone sh prefix addacl -a user:testuser2:a[DEFAULT] /vol1/buck3/dir1/\nACL user:testuser2:a[DEFAULT] added successfully.\n"})}),"\n",(0,l.jsx)(n.h3,{id:"removeacl",children:(0,l.jsx)(n.code,{children:"removeacl"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"$ ozone sh bucket removeacl -a user:testuser:r[DEFAULT] /vol1/bucket2\nACL user:testuser:r[DEFAULT] removed successfully.\n"})}),"\n",(0,l.jsx)(n.h2,{id:"differences-between-ozone-acl-and-s3-acl",children:"Differences Between Ozone ACL and S3 ACL"}),"\n",(0,l.jsx)(n.p,{children:"Ozone ACLs and S3 ACLs differ primarily in their scope and support."}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"S3 ACLs"}),": Currently, only S3 Bucket ACL is implemented in Ozone (a beta feature). S3 Object ACL is not yet implemented. Any ",(0,l.jsx)(n.code,{children:"PutObjectAcl"})," request will result in a ",(0,l.jsx)(n.code,{children:"501: Not Implemented"})," response code."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Ozone ACLs"}),": Ozone ACLs provide a more comprehensive and flexible access control mechanism. They are designed to work seamlessly with Ozone's native architecture and support various rights and scopes as mentioned above."]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"ozone-file-system-acl-api",children:"Ozone File System ACL API"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["ACL-related APIs in Ozone file system implementation (",(0,l.jsx)(n.code,{children:"ofs"})," and ",(0,l.jsx)(n.code,{children:"o3fs"}),"), such as ",(0,l.jsx)(n.code,{children:"getAclStatus"}),", ",(0,l.jsx)(n.code,{children:"setAcl"}),", ",(0,l.jsx)(n.code,{children:"modifyAclEntries"}),", ",(0,l.jsx)(n.code,{children:"removeAclEntries"}),", ",(0,l.jsx)(n.code,{children:"removeDefaultAcl"}),", and ",(0,l.jsx)(n.code,{children:"removeAcl"})," are not supported. These operations will throw an UnsupportedOperationException."]}),"\n",(0,l.jsx)(n.li,{children:"Similarly, HttpFS ACL-related APIs."}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"These limitations should be taken into account when integrating Ozone with applications that rely on S3 or file system ACL operations."})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},62392:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>c});var t=s(30758);const l={},i=t.createContext(l);function o(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:o(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);