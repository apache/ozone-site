"use strict";(self.webpackChunkdoc_site=self.webpackChunkdoc_site||[]).push([[8103],{2338:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>h,default:()=>u,frontMatter:()=>l,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"developer-guide/project/release-guide","title":"Apache Release Manager Guide","description":"This document describes the process to release Apache Ozone. The process is not yet scripted, and the documentation is a work in progress.","source":"@site/docs/08-developer-guide/04-project/02-release-guide.md","sourceDirName":"08-developer-guide/04-project","slug":"/developer-guide/project/release-guide","permalink":"/docs/developer-guide/project/release-guide","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/ozone-site/tree/HDDS-9225-website-v2/docs/08-developer-guide/04-project/02-release-guide.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_label":"Release Manager Guide"},"sidebar":"defaultSidebar","previous":{"title":"Git Branches and Tags","permalink":"/docs/developer-guide/project/branches-and-tags"}}');var r=t(6070),a=t(2392),i=t(2871),o=t(7278);const l={sidebar_label:"Release Manager Guide"},h="Apache Release Manager Guide",c={},d=[{value:"Pre-Requisites",id:"pre-requisites",level:2},{value:"Install Required Packages",id:"install-required-packages",level:3},{value:"Publish Your GPG Key",id:"publish-your-gpg-key",level:3},{value:"Configure Maven Credentials",id:"configure-maven-credentials",level:3},{value:"Pre-Vote",id:"pre-vote",level:2},{value:"Create a Parent Jira for the Release",id:"create-a-parent-jira-for-the-release",level:3},{value:"Bulk Comment on Jiras Targeting This Release",id:"bulk-comment-on-jiras-targeting-this-release",level:3},{value:"Build and Commit <code>proto.lock</code> Files to the Master Branch",id:"build-and-commit-protolock-files-to-the-master-branch",level:3},{value:"Update the Ozone Version on the Master Branch",id:"update-the-ozone-version-on-the-master-branch",level:3},{value:"Create a Release Branch",id:"create-a-release-branch",level:3},{value:"Set Up Local Environment",id:"set-up-local-environment",level:3},{value:"Update the Ozone Version on the Release Branch",id:"update-the-ozone-version-on-the-release-branch",level:3},{value:"Tag the Commit for the Release Candidate",id:"tag-the-commit-for-the-release-candidate",level:3},{value:"Perform Sanity Checks",id:"perform-sanity-checks",level:3},{value:"Build the Project",id:"build-the-project",level:3},{value:"Create and Upload Maven Artifacts",id:"create-and-upload-maven-artifacts",level:3},{value:"Calculate the Checksum and Sign the Artifacts",id:"calculate-the-checksum-and-sign-the-artifacts",level:3},{value:"Check the Artifacts",id:"check-the-artifacts",level:3},{value:"Upload the Artifacts to Dev Staging",id:"upload-the-artifacts-to-dev-staging",level:3},{value:"Push the Release Candidate Tag to GitHub",id:"push-the-release-candidate-tag-to-github",level:3},{value:"Vote",id:"vote",level:2},{value:"If Release Candidate has Problems",id:"if-release-candidate-has-problems",level:3},{value:"After-Vote",id:"after-vote",level:2},{value:"Publish the Artifacts",id:"publish-the-artifacts",level:3},{value:"Write a Haiku",id:"write-a-haiku",level:3},{value:"Update the Ozone Website",id:"update-the-ozone-website",level:3},{value:"Add the Final Git Tag and Push It",id:"add-the-final-git-tag-and-push-it",level:3},{value:"Publish a Docker Image for the Release",id:"publish-a-docker-image-for-the-release",level:3},{value:"Update Acceptance Tests on the Master Branch",id:"update-acceptance-tests-on-the-master-branch",level:3},{value:"Update the Ozone Roadmap",id:"update-the-ozone-roadmap",level:3},{value:"Write an Announcement Mail to the Ozone Mailing Lists",id:"write-an-announcement-mail-to-the-ozone-mailing-lists",level:3},{value:"Patch Release",id:"patch-release",level:2},{value:"Update This Document",id:"update-this-document",level:2}];function p(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"apache-release-manager-guide",children:"Apache Release Manager Guide"})}),"\n",(0,r.jsxs)(n.p,{children:["This document describes the process to release Apache Ozone. The process is not yet scripted, and the documentation is ",(0,r.jsx)(n.strong,{children:"a work in progress"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"pre-requisites",children:"Pre-Requisites"}),"\n",(0,r.jsx)(n.h3,{id:"install-required-packages",children:"Install Required Packages"}),"\n",(0,r.jsx)(n.p,{children:"In addition to the usual development tools required to work on Ozone, the following packages are required during the release process:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://subversion.apache.org/",children:"Subversion"})," to publish release artifacts and GPG keys."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://www.gnupg.org/",children:"GnuPG"})," to manage your GPG keys."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://github.com/nilslice/protolock",children:"Protolock"})," to manage protocol buffer compatibility."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Make sure to use ",(0,r.jsx)(n.a,{href:"https://www.gnu.org/software/tar/",children:"GNU tar"}),".  On Mac, built-in tar includes additional metadata in the archive, which appears as extra files when extracted on other platforms.  GNU tar can be installed e.g. via Homebrew:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title="Install GNU tar on Mac"',children:'brew install gnu-tar\n# to use it as "tar", not "gtar", add the "gnubin" directory to your PATH\nexport PATH="$HOMEBREW_PREFIX/opt/gnu-tar/libexec/gnubin:$PATH"\n'})}),"\n",(0,r.jsx)(n.h3,{id:"publish-your-gpg-key",children:"Publish Your GPG Key"}),"\n",(0,r.jsxs)(n.p,{children:["Create a GPG key to sign the artifacts if you do not already have one. For help creating your key refer to the ",(0,r.jsx)(n.a,{href:"https://www.apache.org/dev/new-committers-guide.html#set-up-security-and-pgp-keys",children:"ASF new committer guide"}),". The release manager's GPG key is supposed to be published together with the release. Please append it to the end of the ",(0,r.jsx)(n.a,{href:"https://dist.apache.org/repos/dist/release/ozone/KEYS",children:"KEYS file"})," stored in Subversion, if it is not already present."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"PMC members can append their key directly to the release KEYS file:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title="Publish Key (PMC)"',children:'svn co https://dist.apache.org/repos/dist/release/ozone\ncd ozone\nexport CODESIGNINGKEY=<your_gpg_key_id>\ngpg --list-sigs $CODESIGNINGKEY >> KEYS\ngpg --armor --export $CODESIGNINGKEY >> KEYS\nsvn commit -m "ozone: adding key of <your_name> to the KEYS"\n'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"If you are a committer and not a PMC member, you can add your key to the dev KEYS file and a PMC member can move it to the final destination:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title="Publish Key (Committer)"',children:'# Use the latest KEYS as the base\nsvn rm https://dist.apache.org/repos/dist/dev/ozone/KEYS\nsvn cp https://dist.apache.org/repos/dist/release/ozone/KEYS https://dist.apache.org/repos/dist/dev/ozone/KEYS\n\nsvn co https://dist.apache.org/repos/dist/dev/ozone\ncd ozone\nexport CODESIGNINGKEY=<your_gpg_key_id>\ngpg --list-sigs $CODESIGNINGKEY >> KEYS\ngpg --armor --export $CODESIGNINGKEY >> KEYS\nsvn commit -m "ozone: adding key of <your_name> to the KEYS"\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title="Move Key (PMC)"',children:'svn mv -m "ozone: adding key of <name> to the KEYS" https://dist.apache.org/repos/dist/dev/ozone/KEYS https://dist.apache.org/repos/dist/release/ozone/KEYS\n'})}),"\n",(0,r.jsx)(n.h3,{id:"configure-maven-credentials",children:"Configure Maven Credentials"}),"\n",(0,r.jsxs)(n.p,{children:["Add your Apache credentials to the local Maven settings ",(0,r.jsx)(n.code,{children:"~/.m2/settings.xml"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",metastring:'title="settings.xml"',children:"<settings>\n  <servers>\n    <server>\n      <id>apache.staging.https</id>\n      <username>your_apache_id</username>\n      <password>your_apache_password</password>\n    </server>\n  </servers>\n</settings>\n"})}),"\n",(0,r.jsx)(n.h2,{id:"pre-vote",children:"Pre-Vote"}),"\n",(0,r.jsx)(n.h3,{id:"create-a-parent-jira-for-the-release",children:"Create a Parent Jira for the Release"}),"\n",(0,r.jsx)(n.p,{children:"This provides visibility into the progress of the release for the community. Tasks mentioned in this guide like cherry-picking fixes on to the release branch, updating the Ozone website, publishing the Docker image, etc can be added as subtasks."}),"\n",(0,r.jsx)(n.h3,{id:"bulk-comment-on-jiras-targeting-this-release",children:"Bulk Comment on Jiras Targeting This Release"}),"\n",(0,r.jsxs)(n.p,{children:["Issue a Jira query like ",(0,r.jsx)(n.a,{href:"https://issues.apache.org/jira/issues/?jql=project%20%3D%20HDDS%20AND%20resolution%20%3D%20Unresolved%20AND%20(cf%5B12310320%5D%20%3D%201.3.0%20OR%20fixVersion%20%3D%201.3.0)%20ORDER%20BY%20priority%20DESC%2C%20updated%20DESC",children:"this"}),", modified for the release number you are working with, to find all unresolved Jiras that have the target version field set to this release. Note that some people incorrectly use Fix Version as the Target Version, so Fix Version is included in this search. Use the following steps to issue a bulk update to these Jiras:"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["In the top right corner, click ",(0,r.jsx)(n.code,{children:"Tools"})," and under ",(0,r.jsx)(n.code,{children:"Bulk Change"})," , select ",(0,r.jsx)(n.code,{children:"all ... issues"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Click the top check box to select all the issues. Click ",(0,r.jsx)(n.code,{children:"Next"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Select ",(0,r.jsx)(n.code,{children:"Edit Issues"})," , then click ",(0,r.jsx)(n.code,{children:"Next"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Select ",(0,r.jsx)(n.code,{children:"Change Fix Version/s"})," , and in the drop down select ",(0,r.jsx)(n.code,{children:"Clear field"}),".","\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsx)(n.p,{children:"This corrects unresolved issues which incorrectly set a fix version for this release."})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Select ",(0,r.jsx)(n.code,{children:"Change Target Version/s"}),", and enter the version of the release after the one you are managing."]}),"\n",(0,r.jsxs)(n.li,{children:["Select ",(0,r.jsx)(n.code,{children:"Change Comment"}),", and add a comment saying that you have moved the release field out, but if the issue is being actively worked on, is close to completion, and would like to be included in this release, to contact you by a given date, probably a week in the future.","\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["Even though the action is called ",(0,r.jsx)(n.code,{children:"Change Comment"}),", it actually adds a comment to the Jira and does not affect existing comments."]})}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"Keep clicking through until the operation is started. It may take a while for Jira to finish the bulk update once it is started."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Wait for the date specified in the Jira comments to pass and blocking issues to be resolved before proceeding with the next steps to update the master branch and cut a release branch."}),"\n",(0,r.jsxs)(n.h3,{id:"build-and-commit-protolock-files-to-the-master-branch",children:["Build and Commit ",(0,r.jsx)(n.code,{children:"proto.lock"})," Files to the Master Branch"]}),"\n",(0,r.jsxs)(n.p,{children:["Protolock files are used to check backwards compatibility of protocol buffers between releases. The Ozone build checks protocol buffers against these lock files and fails if an incompatibility is detected. They should be updated for each release, and require ",(0,r.jsx)(n.a,{href:"https://github.com/nilslice/protolock",children:"protolock"})," to be installed."]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Save and run the following script from your Ozone repo root."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title="update_protolocks.sh"',children:'#!/usr/bin/env sh\n\nfor lock in $(find . -name proto.lock); do\n  lockdir="$(dirname "$lock")"\n  protoroot="$lockdir"/../proto\n  if protolock status --lockdir="$lockdir" --protoroot="$protoroot"; then\n    protolock commit --lockdir="$lockdir" --protoroot="$protoroot"\n  else\n    echo "protolock update failed for $protoroot"\n  fi\ndone\n'})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Commit changes to the ",(0,r.jsx)(n.code,{children:"proto.lock"})," files."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'git commit -m "Update proto.lock for Ozone $VERSION"\n'})}),"\n",(0,r.jsx)(n.admonition,{type:"warning",children:(0,r.jsxs)(n.p,{children:["Double check that only files called ",(0,r.jsx)(n.code,{children:"proto.lock"})," are being committed, and that the changes to the files makes sense based on new features added in this release."]})}),"\n",(0,r.jsxs)(n.admonition,{type:"tip",children:[(0,r.jsx)(n.p,{children:"Ozone currently uses the following protolock files:"}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"hadoop-hdds/interface-client/src/main/resources/proto.lock"}),": Controls the protocol for clients communicating with Datanodes."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"hadoop-hdds/interface-admin/src/main/resources/proto.lock"}),": Controls the protocol for clients communicating with SCM."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"hadoop-hdds/interface-server/src/main/resources/proto.lock"}),": Controls the protocol for SCMs communicating with each other."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"hadoop-ozone/interface-client/src/main/resources/proto.lock"}),": Controls all protocols involving the Ozone Manager."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"hadoop-ozone/csi/src/main/resources/proto.lock"}),": Controls the protocol for the Ozone CSI server."]}),"\n"]})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Submit a pull request to add the updated ",(0,r.jsx)(n.code,{children:"proto.lock"})," changes to Ozone's master branch. This commit will be the parent of your release branch."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"update-the-ozone-version-on-the-master-branch",children:"Update the Ozone Version on the Master Branch"}),"\n",(0,r.jsxs)(n.p,{children:["Update the Ozone SNAPSHOT version and national park tag on master with a pull request. The snapshot version should be set to one minor version after the current release. For example, if you are releasing 1.4.0, then the master branch's current version would be ",(0,r.jsx)(n.code,{children:"1.4.0-SNAPSHOT"}),". Here you would increase it to ",(0,r.jsx)(n.code,{children:"1.5.0-SNAPSHOT"}),". As part of this change, you will pick the ",(0,r.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/List_of_national_parks_of_the_United_States",children:"United States National Park"})," to use for the next release of Ozone and set it in the project's top level pom at ",(0,r.jsx)(n.code,{children:"<ozone.release>"}),". See ",(0,r.jsx)(n.a,{href:"https://github.com/apache/ozone/pull/2863",children:"this pull request"})," for an example."]}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["It is okay if there are commits that land between the ",(0,r.jsx)(n.code,{children:"proto.lock"})," file updates and the SNAPSHOT version increase on the master branch, but they will not be part of the release unless they are manually cherry-picked after the release branch is created."]})}),"\n",(0,r.jsx)(n.h3,{id:"create-a-release-branch",children:"Create a Release Branch"}),"\n",(0,r.jsxs)(n.p,{children:["Once the previous two pull requests to update protolock files and the Ozone SNAPSHOT version are merged, you can create a release branch in the ",(0,r.jsx)(n.a,{href:"https://github.com/apache/ozone",children:"apache/ozone"})," Github repo."]}),"\n",(0,r.jsx)(n.admonition,{type:"important",children:(0,r.jsxs)(n.p,{children:["The parent commit of the release branch should be the commit that was merged in the ",(0,r.jsx)(n.a,{href:"#build-and-commit-protolock-files-to-the-master-branch",children:"proto.lock file update"}),"."]})}),"\n",(0,r.jsxs)(n.p,{children:["Name the branch after the major and minor version of the release, so patch releases can also be done off this branch. For example, If releasing 1.2.0, create a branch called ",(0,r.jsx)(n.code,{children:"ozone-1.2"})," . All release related changes will go to this branch until the release is complete."]}),"\n",(0,r.jsx)(n.h3,{id:"set-up-local-environment",children:"Set Up Local Environment"}),"\n",(0,r.jsx)(n.p,{children:"The following variables will be referenced in commands:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"export VERSION=1.1.0 # Set to the version of ozone being released.\nexport RELEASE_DIR=~/ozone-release/ # ozone-release needs to be created\nexport CODESIGNINGKEY=<your_gpg_key_id>\nexport RC=0 # Set to the number of the current release candidate, starting at 0.\n"})}),"\n",(0,r.jsxs)(n.p,{children:["It is probably best to clone a fresh Ozone repository locally to work on the release, and leave your existing repository intact for dev tasks you may be working on simultaneously. After cloning, make sure the git remote for the ",(0,r.jsx)(n.a,{href:"https://github.com/apache/ozone",children:"apache/ozone"})," upstream repo is named ",(0,r.jsx)(n.code,{children:"origin"}),". This is required for release build metadata to be correctly populated."]}),"\n",(0,r.jsx)(n.p,{children:"Run the following commands to make sure your repo is clean:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"git reset --hard\ngit clean -dfx\n"})}),"\n",(0,r.jsx)(n.p,{children:"Assume all following commands are executed from within this repo with your release branch checked out."}),"\n",(0,r.jsx)(n.h3,{id:"update-the-ozone-version-on-the-release-branch",children:"Update the Ozone Version on the Release Branch"}),"\n",(0,r.jsxs)(n.p,{children:["Use the commands below or your IDE to replace ",(0,r.jsx)(n.code,{children:"$VERSION-SNAPSHOT"})," with ",(0,r.jsx)(n.code,{children:"$VERSION"}),"."]}),"\n","\n",(0,r.jsxs)(i.A,{children:[(0,r.jsx)(o.A,{value:"linux",label:"Linux",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title="Update the Versions"',children:'find . -name pom.xml -type f | xargs sed -i "s/$VERSION-SNAPSHOT/$VERSION/g"\n'})})}),(0,r.jsx)(o.A,{value:"mac",label:"Mac",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title="Update the Versions (Mac)"',children:"find . -name pom.xml -type f -print0 | xargs -0 sed -i '' \"s/$VERSION-SNAPSHOT/$VERSION/g\"\n"})})})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title="Commit the Version Changes "',children:'git commit -am "Update Ozone version to $VERSION"\n'})}),"\n",(0,r.jsx)(n.h3,{id:"tag-the-commit-for-the-release-candidate",children:"Tag the Commit for the Release Candidate"}),"\n",(0,r.jsxs)(n.p,{children:["This will sign the tag with the GPG key matching the git mailing address. Make sure that the email given by ",(0,r.jsx)(n.code,{children:"git config user.email"})," matches the email for the key you want to use shown by ",(0,r.jsx)(n.code,{children:"gpg --list-secret-keys"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'git tag -s "ozone-$VERSION-RC$RC"\n'})}),"\n",(0,r.jsxs)(n.admonition,{type:"tip",children:[(0,r.jsx)(n.p,{children:"If the command fails on MacOS, you may need to do the following additional steps:"}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Install a program to prompt you for your GPG key passphrase (example using homebrew):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"brew install pinentry-mac\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Tell git to use this program for signing:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'git config --global gpg.program "$(which gpg)"\n'})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Tell git which key to sign with:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"git config --global user.signingKey <gpg_key_id>\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Tell GPG to use this program to prompt for passphrase:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'echo "pinentry-program $(which pinentry-mac)" > ~/.gnupg/gpg-agent.conf\n'})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Reload ",(0,r.jsx)(n.code,{children:"gpg-agent"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"gpgconf --kill gpg-agent\n"})}),"\n"]}),"\n"]})]}),"\n",(0,r.jsx)(n.h3,{id:"perform-sanity-checks",children:"Perform Sanity Checks"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Run rat check and ensure there are no failures."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"./hadoop-ozone/dev-support/checks/rat.sh\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Clean the Repo of all Rat output"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"git reset --hard\ngit clean -dfx\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"build-the-project",children:"Build the Project"}),"\n",(0,r.jsx)(n.p,{children:"Build the project to fetch dependencies."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'mvn clean install -Dmaven.javadoc.skip=true -DskipTests -Psign,dist,src -Dtar -Dgpg.keyname="$CODESIGNINGKEY"\n'})}),"\n",(0,r.jsx)(n.h3,{id:"create-and-upload-maven-artifacts",children:"Create and Upload Maven Artifacts"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Perform the final build and upload the release artifacts."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'mvn deploy -DdeployAtEnd=true -Dmaven.javadoc.skip=true -DskipTests -Psign,dist,src -Dtar -Dgpg.keyname="$CODESIGNINGKEY"\n'})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Go to ",(0,r.jsx)(n.a,{href:"https://repository.apache.org/#stagingRepositories",children:"https://repository.apache.org/#stagingRepositories"})," and ",(0,r.jsx)(n.strong,{children:"close"})," the newly created ",(0,r.jsx)(n.code,{children:"orgapacheozone"})," repository."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"calculate-the-checksum-and-sign-the-artifacts",children:"Calculate the Checksum and Sign the Artifacts"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Now that we have built the release artifacts, we will copy them to the release directory."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'cp hadoop-ozone/dist/target/ozone-*.tar.gz "$RELEASE_DIR"/\n'})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Run the following commands to generate checksum files for all release artifacts:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'cd "$RELEASE_DIR"\nfor i in $(ls -1 *.tar.gz); do gpg -u "$CODESIGNINGKEY" --armor --output "$i.asc" --detach-sig "$i"; done\n\nfor i in $(ls -1 *.tar.gz); do sha512sum "$i" > "$i.sha512"; done\n\nfor i in $(ls -1 *.tar.gz); do gpg --print-mds "$i" > "$i.mds"; done\n'})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Now each .tar.gz file should have an associated .mds file, .asc file, and .sha512 file"}),"\n",(0,r.jsx)(n.h3,{id:"check-the-artifacts",children:"Check the Artifacts"}),"\n",(0,r.jsx)(n.p,{children:"Before uploading the artifacts, run some basic tests on them, similar to what other devs will run before voting in favor of the release."}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Extract the contents of the source tarball and build it with an empty Maven cache by renaming your ",(0,r.jsx)(n.code,{children:"~/.m2"})," directory before doing the build."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Check the size of the output binary tarball for significant size increase from the last release."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"A significant increase in size could indicate a dependency issue that needs to be fixed."}),"\n",(0,r.jsxs)(n.li,{children:["The Apache svn repo has a size limit for release artifacts. If uploading svn fails because the tarball is too big, we need to contact INFRA to increase our repo size. ",(0,r.jsx)(n.a,{href:"https://issues.apache.org/jira/browse/INFRA-23892",children:"See here for details."})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Verify signatures"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Download the KEYS file from ",(0,r.jsx)(n.a,{href:"https://dist.apache.org/repos/dist/release/ozone/KEYS",children:"https://dist.apache.org/repos/dist/release/ozone/KEYS"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Import its contents (which should include your public GPG key):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"gpg --import KEYS\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Verify each .tar.gz artifact:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"gpg --verify <artifact>.tar.gz.asc <artifact>.tar.gz\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Verify checksums"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["For each artifact, verify that the checksums given by the ",(0,r.jsx)(n.code,{children:"shasum"})," command match the contents of the .sha512 file and the SHA512 line in its .mds file."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"shasum -a 512 *.tar.gz\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Make sure docs are present in the release tarball"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Extract the release and open docs/index.html in your web browser, and check that the documentation website looks ok."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Run ",(0,r.jsx)(n.code,{children:"bin/ozone version"})," from the extracted release tarball. The output of this command should contain:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"The correct release"}),"\n",(0,r.jsx)(n.li,{children:"The correct national park tag"}),"\n",(0,r.jsx)(n.li,{children:"A non-snapshot version of Ratis."}),"\n",(0,r.jsxs)(n.li,{children:["A link to the ",(0,r.jsx)(n.a,{href:"https://github.com/apache/ozone",children:"apache/ozone"})," GitHub repository (not your fork)."]}),"\n",(0,r.jsx)(n.li,{children:"The git hash of the last commit the release was built on."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Run the upgrade compatibility acceptance tests by running ",(0,r.jsx)(n.code,{children:"test.sh"})," from the ",(0,r.jsx)(n.code,{children:"compose/upgrade"})," directory in the extracted release tarball."]}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"test.sh"})," file committed to the master branch only checks upgrade compatibility against the last released Ozone version to save build time. Compatibility with all past versions should be checked by uncommenting all ",(0,r.jsx)(n.code,{children:"run_test"})," lines in the ",(0,r.jsx)(n.code,{children:"test.sh"})," file before running it. This test matrix may take a long time to run, so it might be better to run it on GitHub Actions instead of locally."]})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"upload-the-artifacts-to-dev-staging",children:"Upload the Artifacts to Dev Staging"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Upload everything from the ",(0,r.jsx)(n.code,{children:"$RELEASE_DIR"})," to the dev staging area."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'svn checkout https://dist.apache.org/repos/dist/dev/ozone\ncd ozone\nmkdir "$VERSION-rc$RC"\ncp -v "$RELEASE_DIR"/* "$VERSION-rc$RC"/\nsvn add "$VERSION-rc$RC"\nsvn commit -m "Ozone $VERSION RC$RC"\n'})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Check the results by opening the ",(0,r.jsx)(n.a,{href:"https://dist.apache.org/repos/dist/dev/ozone/",children:"dev directory"})," in your browser."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"push-the-release-candidate-tag-to-github",children:"Push the Release Candidate Tag to GitHub"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'git push origin "ozone-$VERSION-RC$RC"\n'})}),"\n",(0,r.jsx)(n.h2,{id:"vote",children:"Vote"}),"\n",(0,r.jsxs)(n.p,{children:["Send a vote email to the ",(0,r.jsx)(n.a,{href:"mailto:dev@ozone.apache.org",children:"dev@ozone.apache.org"})," mailing list. Include the following items in the email:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Link to the release candidate tag on Github"}),"\n",(0,r.jsxs)(n.li,{children:["Link to a Jira query showing all resolved issues for this release. Something like ",(0,r.jsx)(n.a,{href:"https://issues.apache.org/jira/issues/?jql=project%20%3D%20HDDS%20AND%20status%20in%20(Resolved%2C%20Closed)%20AND%20fixVersion%20%3D%201.4.0",children:"this"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Location of the source and binary tarballs. This link will look something like ",(0,r.jsx)(n.a,{href:"https://dist.apache.org/repos/dist/dev/ozone/1.2.0-rc0",children:"https://dist.apache.org/repos/dist/dev/ozone/1.2.0-rc0"})]}),"\n",(0,r.jsxs)(n.li,{children:["Location where the Maven artifacts are staged. This link will look something like ",(0,r.jsx)(n.a,{href:"https://repository.apache.org/content/repositories/orgapacheozone-1001/",children:"https://repository.apache.org/content/repositories/orgapacheozone-1001/"})]}),"\n",(0,r.jsxs)(n.li,{children:["Link to the public key used to sign the artifacts. This should always be in the KEYS file and you can just link to that: ",(0,r.jsx)(n.a,{href:"https://dist.apache.org/repos/dist/release/ozone/KEYS",children:"https://dist.apache.org/repos/dist/release/ozone/KEYS"})]}),"\n",(0,r.jsx)(n.li,{children:"Fingerprint of the key used to sign the artifacts."}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["If no issues are found with the artifacts, let the vote run for 7 days. Review the ",(0,r.jsx)(n.a,{href:"https://www.apache.org/legal/release-policy.html#release-approval",children:"ASF wide release voting policy"}),", and note the requirements for binding votes which can only come from PMC members. Sometimes responders will not specify whether their vote is binding. If in doubt check the ",(0,r.jsx)(n.a,{href:"https://people.apache.org/committer-index.html",children:"ASF committer index"}),". Users whose group membership includes ",(0,r.jsx)(n.code,{children:"ozone-pmc"})," can cast binding votes."]}),"\n",(0,r.jsx)(n.p,{children:"Once voting is finished, send an email summarizing the results (binding +1s, non-binding +1s, -1s, 0s) and, if the vote passed, indicate that the release artifacts will be published."}),"\n",(0,r.jsx)(n.h3,{id:"if-release-candidate-has-problems",children:"If Release Candidate has Problems"}),"\n",(0,r.jsx)(n.p,{children:"If an issue is found with the artifacts:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Remove the abandoned release candidate from Subversion."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'svn delete -m "Abandon Ozone $VERSION RC$RC" https://dist.apache.org/repos/dist/dev/ozone/"$VERSION-rc$RC"\n'})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Discard the staging repository at ",(0,r.jsx)(n.a,{href:"https://repository.apache.org/#stagingRepositories",children:"https://repository.apache.org/#stagingRepositories"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Apply fixes to the release branch."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Repeat the steps starting from ",(0,r.jsx)(n.a,{href:"#tag-the-commit-for-the-release-candidate",children:"Tag the Commit for the Release Candidate"})," with the ",(0,r.jsx)(n.code,{children:"$RC"})," variable incremented by 1 for all steps."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"after-vote",children:"After-Vote"}),"\n",(0,r.jsx)(n.h3,{id:"publish-the-artifacts",children:"Publish the Artifacts"}),"\n",(0,r.jsx)(n.p,{children:"If you are a PMC member, move artifacts in Subversion to the final location, otherwise ask the PMC to do the same:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'svn mv -m "Release ozone-$VERSION-rc$RC as ozone-$VERSION" \\\n  https://dist.apache.org/repos/dist/dev/ozone/"$VERSION-rc$RC" \\\n  https://dist.apache.org/repos/dist/release/ozone/"$VERSION"\n'})}),"\n",(0,r.jsxs)(n.p,{children:["To publish the artifacts to ",(0,r.jsx)(n.a,{href:"https://central.sonatype.com",children:"Maven Central"}),", login to ",(0,r.jsx)(n.a,{href:"https://repository.apache.org/#stagingRepositories",children:"https://repository.apache.org/#stagingRepositories"}),", select your ",(0,r.jsx)(n.strong,{children:"staging"})," repository and ",(0,r.jsx)(n.strong,{children:"release"})," it."]}),"\n",(0,r.jsx)(n.h3,{id:"write-a-haiku",children:"Write a Haiku"}),"\n",(0,r.jsxs)(n.p,{children:["Check the tag from the ",(0,r.jsx)(n.a,{href:"https://cwiki.apache.org/confluence/display/OZONE/Ozone+Roadmap",children:"Ozone Roadmap"})," page (it's a national park).\nFind a photo which is under the CC license.\nWrite a haiku to the photo with Future font."]}),"\n",(0,r.jsx)(n.h3,{id:"update-the-ozone-website",children:"Update the Ozone Website"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Create release notes and add them to the Ozone website with your haiku image. An example pull request showing how to do this is ",(0,r.jsx)(n.a,{href:"https://github.com/apache/ozone-site/pull/17",children:"here"}),". Note that the target branch is ",(0,r.jsx)(n.code,{children:"master"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Extract the docs folder from the release tarball, and add its contents to the website. An example pull request for this is ",(0,r.jsx)(n.a,{href:"https://github.com/apache/ozone-site/pull/18",children:"here"}),". Note that the target branch is ",(0,r.jsx)(n.code,{children:"asf-site"})," , and that the ",(0,r.jsx)(n.code,{children:"docs/current"})," symlink has been updated to point to the latest release's directory."]}),"\n",(0,r.jsxs)(n.li,{children:["Test the website locally by running ",(0,r.jsx)(n.code,{children:"hugo serve"})," from the repository root with the master branch checked out. Check that links for the new release are working. Links to the documentation will not work until the PR to the ",(0,r.jsx)(n.code,{children:"asf-site"})," branch is merged."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"add-the-final-git-tag-and-push-it",children:"Add the Final Git Tag and Push It"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'git checkout "ozone-$VERSION-RC$RC"\ngit tag -s "ozone-$VERSION" -m "Ozone $VERSION release"\ngit push origin "ozone-$VERSION"\n'})}),"\n",(0,r.jsx)(n.h3,{id:"publish-a-docker-image-for-the-release",children:"Publish a Docker Image for the Release"}),"\n",(0,r.jsxs)(n.p,{children:["The Ozone Docker image is intended for testing purposes only, not production use. An example pull request to update the Docker image is ",(0,r.jsx)(n.a,{href:"https://github.com/apache/ozone-docker/pull/22/files",children:"here"}),". The target branch for your pull request should be ",(0,r.jsx)(n.code,{children:"latest"}),". After the pull request is merged, it can be published to ",(0,r.jsx)(n.a,{href:"https://hub.docker.com/r/apache/ozone",children:"Docker Hub"})," by updating the branches that correspond to ",(0,r.jsx)(n.a,{href:"https://hub.docker.com/r/apache/ozone/tags",children:"Docker image tags"}),"."]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Publish the image with the ",(0,r.jsx)(n.code,{children:"latest"})," tag by fast-forwarding the ",(0,r.jsx)(n.code,{children:"ozone-latest"})," branch to match the ",(0,r.jsx)(n.code,{children:"latest"})," branch."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"git checkout ozone-latest\ngit pull\ngit merge --ff-only origin/latest\ngit push origin ozone-latest\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Publish the image with a version specific tag by creating a new branch with a name like ",(0,r.jsx)(n.code,{children:"ozone-1.5.0"})," (replace this with the current version) from the ",(0,r.jsx)(n.code,{children:"latest"})," branch and push it to ",(0,r.jsx)(n.a,{href:"https://github.com/apache/ozone-docker",children:"GitHub"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'git checkout ozone-latest\ngit checkout -b "ozone-$VERSION"\ngit push origin "ozone-$VERSION"\n'})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"update-acceptance-tests-on-the-master-branch",children:"Update Acceptance Tests on the Master Branch"}),"\n",(0,r.jsxs)(n.p,{children:["Update the upgrade and client cross compatibility acceptance tests to check against the new release. See ",(0,r.jsx)(n.a,{href:"https://github.com/apache/ozone/pull/6040/files",children:"this pull request"})," for an example."]}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["This step requires the release's ",(0,r.jsx)(n.a,{href:"#publish-a-docker-image-for-the-release",children:"Docker image"})," to be published."]})}),"\n",(0,r.jsx)(n.h3,{id:"update-the-ozone-roadmap",children:"Update the Ozone Roadmap"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Update the ",(0,r.jsx)(n.a,{href:"https://cwiki.apache.org/confluence/display/OZONE/Ozone+Roadmap",children:"Ozone Roadmap"})," so that the release notes for the just completed release are correct."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Move its row to the ",(0,r.jsx)(n.code,{children:"Past Releases"})," section."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Create a row for the next release in the ",(0,r.jsx)(n.code,{children:"Upcoming Releases"})," section, and add planned features that you are aware of."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"write-an-announcement-mail-to-the-ozone-mailing-lists",children:"Write an Announcement Mail to the Ozone Mailing Lists"}),"\n",(0,r.jsx)(n.p,{children:"Include the following links:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Release notes: ",(0,r.jsx)(n.a,{href:"https://ozone.apache.org/release/1.2.0/",children:"https://ozone.apache.org/release/1.2.0/"}),". Replace the version in the URL with the version being released."]}),"\n",(0,r.jsxs)(n.li,{children:["Download link: ",(0,r.jsx)(n.a,{href:"https://ozone.apache.org/downloads/",children:"https://ozone.apache.org/downloads/"})]}),"\n",(0,r.jsxs)(n.li,{children:["Link to versioned documentation: ",(0,r.jsx)(n.a,{href:"https://ozone.apache.org/docs/",children:"https://ozone.apache.org/docs/"})]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"patch-release",children:"Patch Release"}),"\n",(0,r.jsx)(n.p,{children:"If there is a security vulnerability or critical bug uncovered in a major or minor Ozone release, a patch release may be necessary to fix this. The process is a bit simpler than a major or minor release, since there is already a solid foundation on the release's maintenance branch."}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Cherry pick the fix(es) on to the maintenance branch. For example, for Ozone's 1.2.0 release, this is the branch called ",(0,r.jsx)(n.code,{children:"ozone-1.2"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Run all steps from the sections ",(0,r.jsx)(n.a,{href:"#update-the-ozone-version-on-the-release-branch",children:"Update the Versions"})," through ",(0,r.jsx)(n.a,{href:"#publish-a-docker-image-for-the-release",children:"Publish a Docker Image for the Release"}),", with the following modifications:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Do not update the protolock files unless protocol buffers were changed as part of the fix."}),"\n",(0,r.jsxs)(n.li,{children:["When updating the website, all instances of the original major/minor release should be replaced with this patch version, since we do not want users downloading the original release anymore.","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"For example, any website text referring to 1.2.0 should be changed to refer to 1.2.1."}),"\n",(0,r.jsx)(n.li,{children:"Continuing the 1.2.0 to 1.2.1 example, the release/1.2.0 page should redirect to release/1.2.1."}),"\n",(0,r.jsxs)(n.li,{children:["An example pull request to do this is ",(0,r.jsx)(n.a,{href:"https://github.com/apache/ozone-site/pull/23",children:"here"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["The docs can be added to the website normally as described above in ",(0,r.jsx)(n.a,{href:"#update-the-ozone-website",children:"Update the Ozone Website"}),". The docs link for the original major/minor release can remain alongside the docs link for the patch release."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"In the event of a critical security vulnerability or seriously harmful bug with a small set of changes in the patch, PMC members may vote to forgo the usual 72 hour minimum time for a release vote and publish once there are enough binding +1s."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Remove the previous release that this patch release supersedes from the Apache distribution site:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"svn rm -m 'Ozone: delete old version 1.2.0' https://dist.apache.org/repos/dist/release/ozone/1.2.0\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"update-this-document",children:"Update This Document"}),"\n",(0,r.jsx)(n.p,{children:"After finishing the release process, update this page to fix any mistakes, unclear steps, or outdated information."})]})}function u(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(p,{...e})}):p(e)}},2392:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>o});var s=t(758);const r={},a=s.createContext(r);function i(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),s.createElement(a.Provider,{value:n},e.children)}},2871:(e,n,t)=>{t.d(n,{A:()=>k});var s=t(758),r=t(3526),a=t(7130),i=t(5557),o=t(593),l=t(1295),h=t(9924),c=t(6096);function d(e){return s.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,s.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:n,children:t}=e;return(0,s.useMemo)((()=>{const e=n??function(e){return d(e).map((e=>{let{props:{value:n,label:t,attributes:s,default:r}}=e;return{value:n,label:t,attributes:s,default:r}}))}(t);return function(e){const n=(0,h.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function u(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function g(e){let{queryString:n=!1,groupId:t}=e;const r=(0,i.W6)(),a=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,l.aZ)(a),(0,s.useCallback)((e=>{if(!a)return;const n=new URLSearchParams(r.location.search);n.set(a,e),r.replace({...r.location,search:n.toString()})}),[a,r])]}function m(e){const{defaultValue:n,queryString:t=!1,groupId:r}=e,a=p(e),[i,l]=(0,s.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!u({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const s=t.find((e=>e.default))??t[0];if(!s)throw new Error("Unexpected error: 0 tabValues");return s.value}({defaultValue:n,tabValues:a}))),[h,d]=g({queryString:t,groupId:r}),[m,x]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[r,a]=(0,c.Dv)(t);return[r,(0,s.useCallback)((e=>{t&&a.set(e)}),[t,a])]}({groupId:r}),j=(()=>{const e=h??m;return u({value:e,tabValues:a})?e:null})();(0,o.A)((()=>{j&&l(j)}),[j]);return{selectedValue:i,selectValue:(0,s.useCallback)((e=>{if(!u({value:e,tabValues:a}))throw new Error(`Can't select invalid tab value=${e}`);l(e),d(e),x(e)}),[d,x,a]),tabValues:a}}var x=t(7299);const j={tabList:"tabList_wIy4",tabItem:"tabItem_MH3v"};var f=t(6070);function b(e){let{className:n,block:t,selectedValue:s,selectValue:i,tabValues:o}=e;const l=[],{blockElementScrollPositionUntilNextRender:h}=(0,a.a_)(),c=e=>{const n=e.currentTarget,t=l.indexOf(n),r=o[t].value;r!==s&&(h(n),i(r))},d=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const t=l.indexOf(e.currentTarget)+1;n=l[t]??l[0];break}case"ArrowLeft":{const t=l.indexOf(e.currentTarget)-1;n=l[t]??l[l.length-1];break}}n?.focus()};return(0,f.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":t},n),children:o.map((e=>{let{value:n,label:t,attributes:a}=e;return(0,f.jsx)("li",{role:"tab",tabIndex:s===n?0:-1,"aria-selected":s===n,ref:e=>{l.push(e)},onKeyDown:d,onClick:c,...a,className:(0,r.A)("tabs__item",j.tabItem,a?.className,{"tabs__item--active":s===n}),children:t??n},n)}))})}function v(e){let{lazy:n,children:t,selectedValue:a}=e;const i=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=i.find((e=>e.props.value===a));return e?(0,s.cloneElement)(e,{className:(0,r.A)("margin-top--md",e.props.className)}):null}return(0,f.jsx)("div",{className:"margin-top--md",children:i.map(((e,n)=>(0,s.cloneElement)(e,{key:n,hidden:e.props.value!==a})))})}function y(e){const n=m(e);return(0,f.jsxs)("div",{className:(0,r.A)("tabs-container",j.tabList),children:[(0,f.jsx)(b,{...n,...e}),(0,f.jsx)(v,{...n,...e})]})}function k(e){const n=(0,x.A)();return(0,f.jsx)(y,{...e,children:d(e.children)},String(n))}},7278:(e,n,t)=>{t.d(n,{A:()=>i});t(758);var s=t(3526);const r={tabItem:"tabItem_TftU"};var a=t(6070);function i(e){let{children:n,hidden:t,className:i}=e;return(0,a.jsx)("div",{role:"tabpanel",className:(0,s.A)(r.tabItem,i),hidden:t,children:n})}}}]);