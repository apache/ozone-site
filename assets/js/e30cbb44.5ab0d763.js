"use strict";(self.webpackChunkdoc_site=self.webpackChunkdoc_site||[]).push([[4052],{53557:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>o,contentTitle:()=>a,default:()=>u,frontMatter:()=>t,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"developer-guide/test/static-analysis","title":"Static Code Analysis","description":"Apache Ozone uses static code analysis tools to identify potential bugs, code smells, security vulnerabilities, and other issues before they make it into production. SonarQube is the primary tool used for comprehensive code quality analysis.","source":"@site/docs/08-developer-guide/03-test/05-static-analysis.md","sourceDirName":"08-developer-guide/03-test","slug":"/developer-guide/test/static-analysis","permalink":"/docs/developer-guide/test/static-analysis","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/ozone-site/tree/master/docs/08-developer-guide/03-test/05-static-analysis.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_label":"Static Analysis"},"sidebar":"defaultSidebar","previous":{"title":"Continuous Integration","permalink":"/docs/developer-guide/test/continuous-integration"},"next":{"title":"Project","permalink":"/docs/developer-guide/project/"}}');var l=n(86070),r=n(62392);const t={sidebar_label:"Static Analysis"},a="Static Code Analysis",o={},c=[{value:"SonarQube Overview",id:"sonarqube-overview",level:2},{value:"SonarCloud for Apache Ozone",id:"sonarcloud-for-apache-ozone",level:2},{value:"Accessing SonarCloud",id:"accessing-sonarcloud",level:3},{value:"When Analysis Runs",id:"when-analysis-runs",level:3},{value:"Understanding SonarQube Results",id:"understanding-sonarqube-results",level:2},{value:"Dashboard Overview",id:"dashboard-overview",level:3},{value:"Issue Severity Levels",id:"issue-severity-levels",level:3},{value:"Addressing SonarQube Issues",id:"addressing-sonarqube-issues",level:2},{value:"Fixing Common Issues",id:"fixing-common-issues",level:3},{value:"1. Code Smells",id:"1-code-smells",level:4},{value:"2. Bugs",id:"2-bugs",level:4},{value:"3. Security Vulnerabilities",id:"3-security-vulnerabilities",level:4},{value:"Other Static Analysis Tools",id:"other-static-analysis-tools",level:2},{value:"1. SpotBugs (Formerly FindBugs)",id:"1-spotbugs-formerly-findbugs",level:3},{value:"2. PMD",id:"2-pmd",level:3},{value:"3. Checkstyle",id:"3-checkstyle",level:3},{value:"4. RAT",id:"4-rat",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Resources",id:"resources",level:2}];function d(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.header,{children:(0,l.jsx)(s.h1,{id:"static-code-analysis",children:"Static Code Analysis"})}),"\n",(0,l.jsx)(s.p,{children:"Apache Ozone uses static code analysis tools to identify potential bugs, code smells, security vulnerabilities, and other issues before they make it into production. SonarQube is the primary tool used for comprehensive code quality analysis."}),"\n",(0,l.jsx)(s.h2,{id:"sonarqube-overview",children:"SonarQube Overview"}),"\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.a,{href:"https://www.sonarqube.org/",children:"SonarQube"})," is an open-source platform for continuous inspection of code quality. It performs automatic reviews with static analysis to detect:"]}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:"Bugs and logic errors"}),"\n",(0,l.jsx)(s.li,{children:"Code smells (maintainability issues)"}),"\n",(0,l.jsx)(s.li,{children:"Security vulnerabilities"}),"\n",(0,l.jsx)(s.li,{children:"Duplicated code"}),"\n",(0,l.jsx)(s.li,{children:"Test coverage gaps"}),"\n",(0,l.jsx)(s.li,{children:"Coding standard violations"}),"\n"]}),"\n",(0,l.jsx)(s.h2,{id:"sonarcloud-for-apache-ozone",children:"SonarCloud for Apache Ozone"}),"\n",(0,l.jsx)(s.p,{children:"Apache Ozone uses SonarCloud, a cloud-based version of SonarQube, for continuous code quality analysis."}),"\n",(0,l.jsx)(s.h3,{id:"accessing-sonarcloud",children:"Accessing SonarCloud"}),"\n",(0,l.jsxs)(s.p,{children:["The Ozone project's SonarCloud dashboard is publicly available at: ",(0,l.jsx)(s.a,{href:"https://sonarcloud.io/project/overview?id=hadoop-ozone",children:"https://sonarcloud.io/project/overview?id=hadoop-ozone"})]}),"\n",(0,l.jsx)(s.h3,{id:"when-analysis-runs",children:"When Analysis Runs"}),"\n",(0,l.jsx)(s.p,{children:"SonarCloud analysis is triggered automatically on:"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:"Merges to the main branch"}),"\n",(0,l.jsx)(s.li,{children:"Release tag creation"}),"\n"]}),"\n",(0,l.jsx)(s.p,{children:"The analysis is integrated into the GitHub Actions CI workflow in .github/workflows/ci.yml."}),"\n",(0,l.jsx)(s.h2,{id:"understanding-sonarqube-results",children:"Understanding SonarQube Results"}),"\n",(0,l.jsx)(s.h3,{id:"dashboard-overview",children:"Dashboard Overview"}),"\n",(0,l.jsx)(s.p,{children:"The SonarCloud dashboard provides high-level metrics including:"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Quality Gate Status"}),": Overall pass/fail status based on quality thresholds"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Bugs"}),": Logic errors and potential runtime issues"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Vulnerabilities"}),": Security issues"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Code Smells"}),": Maintainability issues"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Coverage"}),": Percentage of code covered by tests"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Duplications"}),": Percentage of duplicated code"]}),"\n"]}),"\n",(0,l.jsx)(s.h3,{id:"issue-severity-levels",children:"Issue Severity Levels"}),"\n",(0,l.jsx)(s.p,{children:"SonarQube categorizes issues by severity:"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Blocker"}),": Issues that must be fixed immediately (risk of system failure)"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Critical"}),": High-impact issues requiring urgent attention"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Major"}),": Default severity for most issues"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Minor"}),": Low-impact issues with minimal risk"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Info"}),": Non-critical issues that represent best practice violations"]}),"\n"]}),"\n",(0,l.jsx)(s.h2,{id:"addressing-sonarqube-issues",children:"Addressing SonarQube Issues"}),"\n",(0,l.jsx)(s.h3,{id:"fixing-common-issues",children:"Fixing Common Issues"}),"\n",(0,l.jsx)(s.h4,{id:"1-code-smells",children:"1. Code Smells"}),"\n",(0,l.jsx)(s.p,{children:"Typically maintenance-related issues like:"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-java",children:"// Before: Magic number\nif (retryCount > 5) {\n// Retry logic\n}\n\n// After: Named constant\nprivate static final int MAX_RETRY_COUNT = 5;\n\nif (retryCount > MAX_RETRY_COUNT) {\n// Retry logic\n}\n"})}),"\n",(0,l.jsx)(s.h4,{id:"2-bugs",children:"2. Bugs"}),"\n",(0,l.jsx)(s.p,{children:"Logic errors that could cause runtime issues:"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-java",children:'// Before: Potential NullPointerException\nString value = map.get("key").toString();\n\n// After: Null check\nString rawValue = map.get("key");\nString value = rawValue != null ? rawValue.toString() : "";\n'})}),"\n",(0,l.jsx)(s.h4,{id:"3-security-vulnerabilities",children:"3. Security Vulnerabilities"}),"\n",(0,l.jsx)(s.p,{children:"Issues that could expose security weaknesses:"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-java",children:'// Before: Hardcoded credentials\nprivate static final String PASSWORD = "p@ssw0rd";\n\n// After: Configuration-based approach\nprivate String password = configuration.get("security.password");\n'})}),"\n",(0,l.jsx)(s.h2,{id:"other-static-analysis-tools",children:"Other Static Analysis Tools"}),"\n",(0,l.jsx)(s.p,{children:"In addition to SonarQube, Ozone uses several other static analysis tools:"}),"\n",(0,l.jsx)(s.h3,{id:"1-spotbugs-formerly-findbugs",children:"1. SpotBugs (Formerly FindBugs)"}),"\n",(0,l.jsx)(s.p,{children:"Detects potential bugs in Java code through bytecode analysis."}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"# Run SpotBugs\ncd hadoop-ozone/dev-support/checks\n./findbugs.sh\n"})}),"\n",(0,l.jsxs)(s.p,{children:["Configuration is ",(0,l.jsx)(s.code,{children:"in hadoop-ozone/dev-support/checks/findbugs.sh"})]}),"\n",(0,l.jsx)(s.h3,{id:"2-pmd",children:"2. PMD"}),"\n",(0,l.jsx)(s.p,{children:"Source code analyzer that finds common programming flaws."}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"# Run PMD\ncd hadoop-ozone/dev-support/checks\n./pmd.sh\n"})}),"\n",(0,l.jsxs)(s.p,{children:["Rules are defined in ",(0,l.jsx)(s.code,{children:"dev-support/pmd/pmd-ruleset.xml"})]}),"\n",(0,l.jsx)(s.h3,{id:"3-checkstyle",children:"3. Checkstyle"}),"\n",(0,l.jsx)(s.p,{children:"Enforces coding standards and conventions."}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"# Run Checkstyle\ncd hadoop-ozone/dev-support/checks\n./checkstyle.sh\n"})}),"\n",(0,l.jsx)(s.h3,{id:"4-rat",children:"4. RAT"}),"\n",(0,l.jsx)(s.p,{children:"Enforces Apache license header in all files"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"# Run rat\ncd hadoop-ozone/dev-support/checks\n./rat.sh\n"})}),"\n",(0,l.jsxs)(s.p,{children:["Exclusions are defined in ",(0,l.jsx)(s.code,{children:"dev-support/rat/rat-exclusions.txt"})]}),"\n",(0,l.jsx)(s.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,l.jsxs)(s.ol,{children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Fix issues early"}),": Address static analysis findings as you develop"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Prioritize by severity"}),": Focus on Blocker and Critical issues first"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Maintain test coverage"}),": Keep coverage high to catch regressions"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Understand false positives"}),": Some issues may be false alarms; use ",(0,l.jsx)(s.code,{children:"@SuppressWarnings"})," with care"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Run locally before pushing"}),": Run static analysis checks locally to catch issues early"]}),"\n"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-shell",children:"# Run all static analysis checks\ncd hadoop-ozone/dev-support/checks\n./findbugs.sh\n./pmd.sh\n./checkstyle.sh\n./rat.sh\n"})}),"\n",(0,l.jsx)(s.h2,{id:"resources",children:"Resources"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.a,{href:"https://rules.sonarsource.com/java/",children:"SonarSource Rules"})," - Detailed explanations of Java rules"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.a,{href:"https://spotbugs.readthedocs.io/en/latest/bugDescriptions.html",children:"SpotBugs Bug Patterns"})," - Explanations of bug patterns"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.a,{href:"https://pmd.github.io/latest/pmd_rules_java.html",children:"PMD Rules"})," - Complete list of PMD rules"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.a,{href:"https://checkstyle.sourceforge.io/checks.html",children:"Checkstyle Checks"})," - Available Checkstyle checks\ncspell.yaml"]}),"\n"]})]})}function u(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,l.jsx)(s,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},62392:(e,s,n)=>{n.d(s,{R:()=>t,x:()=>a});var i=n(30758);const l={},r=i.createContext(l);function t(e){const s=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),i.createElement(r.Provider,{value:s},e.children)}}}]);