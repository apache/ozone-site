"use strict";(self.webpackChunkdoc_site=self.webpackChunkdoc_site||[]).push([[6842],{14351:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>r,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"administrator-guide/operations/s3-multi-tenancy/overview","title":"S3 Multi-Tenancy Overview","description":"Before Ozone multi-tenancy, all S3 access to Ozone (via S3 Gateway) were confined to a single designated S3 volume (that is volume s3v, by default).","source":"@site/docs/05-administrator-guide/03-operations/07-s3-multi-tenancy/01-overview.md","sourceDirName":"05-administrator-guide/03-operations/07-s3-multi-tenancy","slug":"/administrator-guide/operations/s3-multi-tenancy/overview","permalink":"/docs/administrator-guide/operations/s3-multi-tenancy/overview","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/ozone-site/tree/HDDS-9225-website-v2/docs/05-administrator-guide/03-operations/07-s3-multi-tenancy/01-overview.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_label":"Overview"},"sidebar":"defaultSidebar","previous":{"title":"S3 Multi-Tenancy","permalink":"/docs/administrator-guide/operations/s3-multi-tenancy/"},"next":{"title":"Setup","permalink":"/docs/administrator-guide/operations/s3-multi-tenancy/setup"}}');var i=t(86070),a=t(62392);const r={sidebar_label:"Overview"},o="S3 Multi-Tenancy Overview",c={},l=[{value:"Basics",id:"basics",level:2},{value:"Next Steps",id:"next-steps",level:2},{value:"References",id:"references",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"s3-multi-tenancy-overview",children:"S3 Multi-Tenancy Overview"})}),"\n",(0,i.jsxs)(n.p,{children:["Before Ozone multi-tenancy, all S3 access to Ozone (via ",(0,i.jsx)(n.a,{href:"/docs/user-guide/client-interfaces/s3",children:"S3 Gateway"}),") were confined to a ",(0,i.jsx)(n.strong,{children:"single"})," designated S3 volume (that is volume ",(0,i.jsx)(n.code,{children:"s3v"}),", by default)."]}),"\n",(0,i.jsxs)(n.p,{children:["Ozone multi-tenancy allows ",(0,i.jsx)(n.strong,{children:"multiple"})," S3-accessible volumes to be created. Each volume can be managed separately by their own tenant admins via CLI for user operations, and via Apache Ranger for access control."]}),"\n",(0,i.jsxs)(n.p,{children:["The concept ",(0,i.jsx)(n.strong,{children:"tenant"})," is introduced to Ozone by multi-tenancy. Each tenant has its own designated volume. Each user assigned to a tenant will be able to access the associated volume with an ",(0,i.jsx)(n.em,{children:"Access ID & Secret Key"})," pair generated when an Ozone cluster admin or tenant admin assigns the user to the tenant using CLI."]}),"\n",(0,i.jsxs)(n.admonition,{type:"note",children:[(0,i.jsx)(n.p,{children:"This multi-tenant feature allows Ozone resources to be compartmentalized in different isolation zones (tenants)."}),(0,i.jsx)(n.p,{children:"This multi-tenant support will also allow users to access Ozone volumes over AWS S3 APIs (without any modifications to the APIs)."})]}),"\n",(0,i.jsx)(n.h2,{id:"basics",children:"Basics"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Initial tenant creation has to be done by an Ozone cluster admin under the CLI."}),"\n",(0,i.jsxs)(n.li,{children:["The Ozone cluster admin will have to assign the first user of a tenant. Once assigned, an ",(0,i.jsx)(n.em,{children:"Access ID & Secret Key pair"})," (key pair) will be generated for that user for access via S3 Gateway.","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"The key pair serves to authenticate the end user to the Ozone Manager (via client requests from S3 Gateway). Tenant volume is selected based on the Access ID."}),"\n",(0,i.jsx)(n.li,{children:"After successful authentication, Ozone Manager uses the underlying user name (not the Access ID) to identify the user. The user name is used to perform authorization checks in Apache Ranger."}),"\n",(0,i.jsx)(n.li,{children:"A key pair is tied to the user name it is assigned to. If a user is assigned key pairs in multiple tenants, all key pairs point to the same user name internally in Ozone Manager."}),"\n",(0,i.jsx)(n.li,{children:"A user can be only assigned one key pair in a same tenant. Ozone Manager rejects the tenant user assign request if a user is already assigned to the same tenant (i.e. when the user has already been assigned an Access ID in this tenant)."}),"\n",(0,i.jsxs)(n.li,{children:["One user can be assigned to multiple tenants. The user will have a different key pair to access each tenant. For instance, ",(0,i.jsx)(n.code,{children:"testuser"})," could use ",(0,i.jsx)(n.code,{children:"tenantone$testuser"})," to access ",(0,i.jsx)(n.code,{children:"tenantone"})," buckets, and use ",(0,i.jsx)(n.code,{children:"tenanttwo$testuser"})," to access ",(0,i.jsx)(n.code,{children:"tenanttwo"})," buckets via S3 Gateway.","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["A bucket link can be set up if cross-tenant (cross-volume) access is desired. See the ",(0,i.jsx)(n.a,{href:"/docs/administrator-guide/operations/s3-multi-tenancy/tenant-commands#creating-bucket-links",children:"Creating bucket links"})," section."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"The Ozone cluster admin can then assign tenant admin roles to that user."}),"\n",(0,i.jsxs)(n.li,{children:["Tenant admin are able to assign new users to the tenant.","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"They can even assign new tenant admins in their tenant, if they are delegated tenant admins, which is the default."}),"\n",(0,i.jsxs)(n.li,{children:["Note that tenant admins still need to use Ozone tenant CLI to assign new users to the tenant.","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Once tenant admins get the Kerberos TGT (via ",(0,i.jsx)(n.code,{children:"kinit"}),"), they can run ",(0,i.jsx)(n.code,{children:"user assign"})," command to assign new users. Ozone Manager will recognize that they are the tenant admins and allow the user to do so in their tenants."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"After that, users can use any S3-compatible client (awscli, Python boto3 library, etc.) to access the buckets in the tenant volume via S3 Gateway using the generated key pairs."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/docs/administrator-guide/operations/s3-multi-tenancy/setup",children:"Multi-Tenancy Setup"})," - Configure multi-tenancy in your cluster"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/docs/administrator-guide/operations/s3-multi-tenancy/tenant-commands",children:"Tenant Commands"})," - Learn tenant CLI commands"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/docs/administrator-guide/operations/s3-multi-tenancy/access-control",children:"Access Control"})," - Understand access control with Ranger"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,i.jsxs)(n.p,{children:["For developers: check out the upstream Jira ",(0,i.jsx)(n.a,{href:"https://issues.apache.org/jira/browse/HDDS-4944",children:"HDDS-4944"})," and the attached design docs."]})]})}function u(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},62392:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>o});var s=t(30758);const i={},a=s.createContext(i);function r(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);